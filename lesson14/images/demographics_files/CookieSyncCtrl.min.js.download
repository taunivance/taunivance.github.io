var sas_csync_DEBUG=!1,sasCookieSyncCtrl=sasCookieSyncCtrl||function(f,h){var e=function(){sas_csync_DEBUG&&console.log.apply(null,["CookieSyncCtrl"].concat([].slice.apply(arguments)))};e("created");return{protocol:(f.location.protocol||"").replace(":",""),qs:[],optoutNw:[],optoutDc:[],smartCookieName:"pid",csyncFreqCookieName:"csfq",csyncCnameFreqCookieName:"cnfq",cookieTtlHrs:6,cookieGraceHrs:6,contains:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},parseQueryString:function(a){a=
a.split("&");if(""!=a){for(var b={},c=0;c<a.length;++c){var d=a[c].split("=");2==d.length&&(b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," ")))}this.qs=b}},getIntFromParsedQueryString:function(a,b){var c=parseInt(a[b],10);return isNaN(c)||0>c?0:c},getBoolFromParsedQueryString:function(a,b){return"true"===a[b]},parseValues:function(a,b,c){var d={};a=a.split(b);for(b=0;b<a.length;b++){var g=a[b],e=g.indexOf(c),f=g.substring(0,e),g=g.substring(e+1);d[f]=decodeURIComponent(g)}return d},getNwId:function(){return this.getIntFromParsedQueryString(this.qs,
"nwid")},getDcId:function(){return this.getIntFromParsedQueryString(this.qs,"dcid")},hasRtb:function(){return this.getBoolFromParsedQueryString(this.qs,"hasrtb")},isCname:function(){return this.getBoolFromParsedQueryString(this.qs,"iscname")},getFullDoaminName:function(){return this.qs.cname},tryGetPidDateComponent:function(a){a=a%549755813888/8192;var b=new Date(2E3,0,1);b.setMinutes(b.getMinutes()+a);return b},shouldRenderCsync:function(a){if(this.contains(this.optoutNw,this.getNwId())||this.contains(this.optoutDc,
this.getDcId())||!a||!this.hasRtb())return!1;a=this.parseValues(a,"; ","=");if(!a||!a[this.smartCookieName]||null==a[this.smartCookieName])return!1;e("sasCookieSyncCtrl started",this.getNwId(),this.getDcId(),this.hasRtb(),this.isCname());var b=a[this.smartCookieName],c=this.tryGetPidDateComponent(b),d=new Date,g=d.getTime()-36E5*this.cookieGraceHrs,f=(new Date(d.getFullYear()+1,d.getMonth(),d.getDate())).getTime(),d=(new Date(d.getFullYear()-1,d.getMonth(),d.getDate())).getTime();e("pid",b,c,g,c.getTime());
if(d<c.getTime()&&c.getTime()>f&&g<c.getTime())return!1;e("cookiez",a);return null!=a[this.csyncFreqCookieName]||null!=a[this.csyncCnameFreqCookieName]?!1:!0},isIosWebView:function(){var a=!1;if("iP"===navigator.platform.substr(0,2)){var b=/constructor/i.test(f.HTMLElement),c=f.navigator,d=c.userAgent,e=!!f.indexedDB;if(-1!==d.indexOf("Safari")&&-1!==d.indexOf("Version")&&!c.standalone)a=!1;else if(!e&&b||!f.statusbar.visible)a=!0;else if(f.webkit&&f.webkit.messageHandlers||!b||e)a=!0}return a},tryRenderCsync:function(a){this.isIosWebView()?
e("tryRenderCsync: UiWebView detected won't execute."):(e("tryRenderCsync: ioswebview not detected, firing csync"),sasCookieSync.fireCSync(a))},onLoad:function(){e("onLoad executed");this.setCookie(this.csyncFreqCookieName,1,this.cookieTtlHrs);if(this.isCname()&&!this.isIosWebView()){var a=this.getCnameUrl();null!=a&&(a=a.replace("CNAME_URL",this.getFullDoaminName())+"&ts="+(new Date).getTime(),e("cnameUrl",a),(new Image).src=a,this.setCookie(this.csyncCnameFreqCookieName,1,this.cookieTtlHrs))}},
createScript:function(a){var b=h.createElement("SCRIPT");b.src=a;b.type="text/javascript";b.async=!0;null!=h.body&&(h.body.appendChild(b),e("in script"));return b},setCookie:function(a,b,c){var d=new Date;d.setTime(d.getTime()+36E5*c);c="expires="+d.toUTCString();h.cookie=a+"="+b+";"+c+";path=/"},getCnameUrl:function(){var a=h.querySelector("script[data-sas-cname-url]");e("script",a);return null!=a?a.getAttribute("data-sas-cname-url"):null}}}(window,document);
