/*
Copyright (c) 2016 Tremor Video, Inc. All Rights Reserved.

This software is the confidential and proprietary information of
Tremor Video. ("Confidential Information"). You shall not disclose
such Confidential Information and shall use it only inaccordance
with the terms of the license agreement you entered into with
Tremor Video.

Additional credits:

Project: vast-client-js <https://github.com/dailymotion/vast-client-js>
Copyright (c) 2013 Olivier Poitrey <rs@dailymotion.com>
License: <https://github.com/dailymotion/vast-client-js/blob/master/LICENSE>

Project: vpaid-ad <https://github.com/kahwee/vpaid-ad>
Copyright (c) 2015 KahWee Teng
License: <https://github.com/kahwee/vpaid-ad/blob/master/LICENSE>
*/
!function o(a,s,l){function u(t,e){if(!s[t]){if(!a[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var n=s[t]={exports:{}};a[t][0].call(n.exports,function(e){return u(a[t][1][e]||e)},n,n.exports,o,a,s,l)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,i){"use strict";i.byteLength=function(e){var t=d(e),i=t[0],r=t[1];return 3*(i+r)/4-r},i.toByteArray=function(e){for(var t,i=d(e),r=i[0],n=i[1],o=new c(function(e,t){return 3*(e+t)/4-t}(r,n)),a=0,s=0<n?r-4:r,l=0;l<s;l+=4)t=u[e.charCodeAt(l)]<<18|u[e.charCodeAt(l+1)]<<12|u[e.charCodeAt(l+2)]<<6|u[e.charCodeAt(l+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;2===n&&(t=u[e.charCodeAt(l)]<<2|u[e.charCodeAt(l+1)]>>4,o[a++]=255&t);1===n&&(t=u[e.charCodeAt(l)]<<10|u[e.charCodeAt(l+1)]<<4|u[e.charCodeAt(l+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t);return o},i.fromByteArray=function(e){for(var t,i=e.length,r=i%3,n=[],o=0,a=i-r;o<a;o+=16383)n.push(l(e,o,a<o+16383?a:o+16383));1==r?(t=e[i-1],n.push(s[t>>2]+s[t<<4&63]+"==")):2==r&&(t=(e[i-2]<<8)+e[i-1],n.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return n.join("")};for(var s=[],u=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=r.length;n<o;++n)s[n]=r[n],u[r.charCodeAt(n)]=n;function d(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function l(e,t,i){for(var r,n,o=[],a=t;a<i;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(s[(n=r)>>18&63]+s[n>>12&63]+s[n>>6&63]+s[63&n]);return o.join("")}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],2:[function(e,t,i){},{}],3:[function(e,t,i){arguments[4][2][0].apply(i,arguments)},{dup:2}],4:[function(e,t,i){var l=Object.create||function(e){function t(){}return t.prototype=e,new t},a=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return i},o=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=l(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0;var n,s=10;try{var u={};Object.defineProperty&&Object.defineProperty(u,"x",{value:0}),n=0===u.x}catch(e){n=!1}function c(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function d(e,t,i,r){var n,o,a;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),a=o[t]):(o=e._events=l(null),e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[i,a]:[a,i]:r?a.unshift(i):a.push(i),!a.warned&&(n=c(e))&&0<n&&a.length>n){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}}else a=o[t]=i,++e._eventsCount;return e}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function f(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=o.call(h,r);return n.listener=i,r.wrapFn=n}function p(e,t,i){var r=e._events;if(!r)return[];var n=r[t];return n?"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):m(n,n.length):[]}function v(e){var t=this._events;if(t){var i=t[e];if("function"==typeof i)return 1;if(i)return i.length}return 0}function m(e,t){for(var i=new Array(t),r=0;r<t;++r)i[r]=e[r];return i}n?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');s=e}}):r.defaultMaxListeners=s,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return c(this)},r.prototype.emit=function(e,t,i,r){var n,o,a,s,l,u,c="error"===e;if(u=this._events)c=c&&null==u.error;else if(!c)return!1;if(c){if(1<arguments.length&&(n=t),n instanceof Error)throw n;var d=new Error('Unhandled "error" event. ('+n+")");throw d.context=n,d}if(!(o=u[e]))return!1;var h="function"==typeof o;switch(a=arguments.length){case 1:!function(e,t,i){if(t)e.call(i);else for(var r=e.length,n=m(e,r),o=0;o<r;++o)n[o].call(i)}(o,h,this);break;case 2:!function(e,t,i,r){if(t)e.call(i,r);else for(var n=e.length,o=m(e,n),a=0;a<n;++a)o[a].call(i,r)}(o,h,this,t);break;case 3:!function(e,t,i,r,n){if(t)e.call(i,r,n);else for(var o=e.length,a=m(e,o),s=0;s<o;++s)a[s].call(i,r,n)}(o,h,this,t,i);break;case 4:!function(e,t,i,r,n,o){if(t)e.call(i,r,n,o);else for(var a=e.length,s=m(e,a),l=0;l<a;++l)s[l].call(i,r,n,o)}(o,h,this,t,i,r);break;default:for(s=new Array(a-1),l=1;l<a;l++)s[l-1]=arguments[l];!function(e,t,i,r){if(t)e.apply(i,r);else for(var n=e.length,o=m(e,n),a=0;a<n;++a)o[a].apply(i,r)}(o,h,this,s)}return!0},r.prototype.on=r.prototype.addListener=function(e,t){return d(this,e,t,!1)},r.prototype.prependListener=function(e,t){return d(this,e,t,!0)},r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},r.prototype.removeListener=function(e,t){var i,r,n,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=l(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,o=i.length-1;0<=o;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,n=o;break}if(n<0)return this;0===n?i.shift():function(e,t){for(var i=t,r=i+1,n=e.length;r<n;i+=1,r+=1)e[i]=e[r];e.pop()}(i,n),1===i.length&&(r[e]=i[0]),r.removeListener&&this.emit("removeListener",e,a||t)}return this},r.prototype.removeAllListeners=function(e){var t,i,r;if(!(i=this._events))return this;if(!i.removeListener)return 0===arguments.length?(this._events=l(null),this._eventsCount=0):i[e]&&(0==--this._eventsCount?this._events=l(null):delete i[e]),this;if(0===arguments.length){var n,o=a(i);for(r=0;r<o.length;++r)"removeListener"!==(n=o[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=l(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},r.prototype.listeners=function(e){return p(this,e,!0)},r.prototype.rawListeners=function(e){return p(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},r.prototype.listenerCount=v,r.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],5:[function(e,t,i){var r=e("buffer"),n=r.Buffer;function o(e,t){for(var i in e)t[i]=e[i]}function a(e,t,i){return n(e,t,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(o(r,i),i.Buffer=a),a.prototype=Object.create(n.prototype),o(n,a),a.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,i)},a.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=n(e);return void 0!==t?"string"==typeof i?r.fill(t,i):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:26}],6:[function(i,e,n){(function(l){var u=i("./lib/request"),e=i("./lib/response"),c=i("xtend"),t=i("builtin-status-codes"),d=i("url"),r=n;r.request=function(e,t){e="string"==typeof e?d.parse(e):c(e);var i=-1===l.location.protocol.search(/^https?:$/)?"http:":"",r=e.protocol||i,n=e.hostname||e.host,o=e.port,a=e.path||"/";n&&-1!==n.indexOf(":")&&(n="["+n+"]"),e.url=(n?r+"//"+n:"")+(o?":"+o:"")+a,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var s=new u(e);return t&&s.on("response",t),s},r.get=function(e,t){var i=r.request(e,t);return i.end(),i},r.ClientRequest=u,r.IncomingMessage=e.IncomingMessage,r.Agent=function(){},r.Agent.defaultMaxSockets=4,r.globalAgent=new r.Agent,r.STATUS_CODES=t,r.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":8,"./lib/response":9,"builtin-status-codes":27,url:37,xtend:49}],7:[function(e,t,o){(function(e){var t;function i(){if(void 0!==t)return t;if(e.XMLHttpRequest){t=new e.XMLHttpRequest;try{t.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){t=null}}else t=null;return t}function r(e){var t=i();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}function n(e){return"function"==typeof e}o.fetch=n(e.fetch)&&n(e.ReadableStream),o.writableStream=n(e.WritableStream),o.abortController=n(e.AbortController),o.arraybuffer=o.fetch||r("arraybuffer"),o.msstream=!o.fetch&&r("ms-stream"),o.mozchunkedarraybuffer=!o.fetch&&r("moz-chunked-arraybuffer"),o.overrideMimeType=o.fetch||!!i()&&n(i().overrideMimeType),t=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(o,h,e){(function(l,u,a){var c=o("./capability"),e=o("inherits"),t=o("./response"),s=o("readable-stream"),i=t.IncomingMessage,d=t.readyStates;var r=h.exports=function(t){var e,i=this;s.Writable.call(i),i._opts=t,i._body=[],i._headers={},t.auth&&i.setHeader("Authorization","Basic "+a.from(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){i.setHeader(e,t.headers[e])});var r,n,o=!0;if("disable-fetch"===t.mode||"requestTimeout"in t&&!c.abortController)e=!(o=!1);else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!c.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}i._mode=(r=e,n=o,c.fetch&&n?"fetch":c.mozchunkedarraybuffer?"moz-chunked-arraybuffer":c.msstream?"ms-stream":c.arraybuffer&&r?"arraybuffer":"text"),i._fetchTimer=null,i.on("finish",function(){i._onFinish()})};e(r,s.Writable),r.prototype.setHeader=function(e,t){var i=e.toLowerCase();-1===n.indexOf(i)&&(this._headers[i]={name:e,value:t})},r.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},r.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},r.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts,r=t._headers,i=null;"GET"!==e.method&&"HEAD"!==e.method&&(i=new Blob(t._body,{type:(r["content-type"]||{}).value||""}));var n=[];if(Object.keys(r).forEach(function(e){var t=r[e].name,i=r[e].value;Array.isArray(i)?i.forEach(function(e){n.push([t,e])}):n.push([t,i])}),"fetch"===t._mode){var o=null;if(c.abortController){var a=new AbortController;o=a.signal,t._fetchAbortController=a,"requestTimeout"in e&&0!==e.requestTimeout&&(t._fetchTimer=u.setTimeout(function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()},e.requestTimeout))}u.fetch(t._opts.url,{method:t._opts.method,headers:n,body:i||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin",signal:o}).then(function(e){t._fetchResponse=e,t._connect()},function(e){u.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",e)})}else{var s=t._xhr=new u.XMLHttpRequest;try{s.open(t._opts.method,t._opts.url,!0)}catch(e){return void l.nextTick(function(){t.emit("error",e)})}"responseType"in s&&(s.responseType=t._mode),"withCredentials"in s&&(s.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in e&&(s.timeout=e.requestTimeout,s.ontimeout=function(){t.emit("requestTimeout")}),n.forEach(function(e){s.setRequestHeader(e[0],e[1])}),t._response=null,s.onreadystatechange=function(){switch(s.readyState){case d.LOADING:case d.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(s.onprogress=function(){t._onXHRProgress()}),s.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{s.send(i)}catch(e){return void l.nextTick(function(){t.emit("error",e)})}}}},r.prototype._onXHRProgress=function(){var e=this;!function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return}}(e._xhr)||e._destroyed||(e._response||e._connect(),e._response._onXHRProgress())},r.prototype._connect=function(){var t=this;t._destroyed||(t._response=new i(t._xhr,t._fetchResponse,t._mode,t._fetchTimer),t._response.on("error",function(e){t.emit("error",e)}),t.emit("response",t._response))},r.prototype._write=function(e,t,i){this._body.push(e),i()},r.prototype.abort=r.prototype.destroy=function(){var e=this;e._destroyed=!0,u.clearTimeout(e._fetchTimer),e._response&&(e._response._destroyed=!0),e._xhr?e._xhr.abort():e._fetchAbortController&&e._fetchAbortController.abort()},r.prototype.end=function(e,t,i){"function"==typeof e&&(i=e,e=void 0),s.Writable.prototype.end.call(this,e,t,i)},r.prototype.flushHeaders=function(){},r.prototype.setTimeout=function(){},r.prototype.setNoDelay=function(){},r.prototype.setSocketKeepAlive=function(){};var n=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,o("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},o("buffer").Buffer)},{"./capability":7,"./response":9,_process:31,buffer:26,inherits:30,"readable-stream":24}],9:[function(i,e,r){(function(u,c,d){var h=i("./capability"),e=i("inherits"),f=i("readable-stream"),s=r.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},t=r.IncomingMessage=function(e,t,i,r){var n=this;if(f.Readable.call(n),n._mode=i,n.headers={},n.rawHeaders=[],n.trailers={},n.rawTrailers=[],n.on("end",function(){u.nextTick(function(){n.emit("close")})}),"fetch"===i){if(n._fetchResponse=t,n.url=t.url,n.statusCode=t.status,n.statusMessage=t.statusText,t.headers.forEach(function(e,t){n.headers[t.toLowerCase()]=e,n.rawHeaders.push(t,e)}),h.writableStream){var o=new WritableStream({write:function(i){return new Promise(function(e,t){n._destroyed?t():n.push(d.from(i))?e():n._resumeFetch=e})},close:function(){c.clearTimeout(r),n._destroyed||n.push(null)},abort:function(e){n._destroyed||n.emit("error",e)}});try{return void t.body.pipeTo(o).catch(function(e){c.clearTimeout(r),n._destroyed||n.emit("error",e)})}catch(e){}}var a=t.body.getReader();!function t(){a.read().then(function(e){if(!n._destroyed){if(e.done)return c.clearTimeout(r),void n.push(null);n.push(d.from(e.value)),t()}}).catch(function(e){c.clearTimeout(r),n._destroyed||n.emit("error",e)})}()}else{if(n._xhr=e,n._pos=0,n.url=e.responseURL,n.statusCode=e.status,n.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var i=t[1].toLowerCase();"set-cookie"===i?(void 0===n.headers[i]&&(n.headers[i]=[]),n.headers[i].push(t[2])):void 0!==n.headers[i]?n.headers[i]+=", "+t[2]:n.headers[i]=t[2],n.rawHeaders.push(t[1],t[2])}}),n._charset="x-user-defined",!h.overrideMimeType){var s=n.rawHeaders["mime-type"];if(s){var l=s.match(/;\s*charset=([^;])(;|$)/);l&&(n._charset=l[1].toLowerCase())}n._charset||(n._charset="utf-8")}}};e(t,f.Readable),t.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},t.prototype._onXHRProgress=function(){var e=this,t=e._xhr,i=null;switch(e._mode){case"text":if((i=t.responseText).length>e._pos){var r=i.substr(e._pos);if("x-user-defined"===e._charset){for(var n=d.alloc(r.length),o=0;o<r.length;o++)n[o]=255&r.charCodeAt(o);e.push(n)}else e.push(r,e._charset);e._pos=i.length}break;case"arraybuffer":if(t.readyState!==s.DONE||!t.response)break;i=t.response,e.push(d.from(new Uint8Array(i)));break;case"moz-chunked-arraybuffer":if(i=t.response,t.readyState!==s.LOADING||!i)break;e.push(d.from(new Uint8Array(i)));break;case"ms-stream":if(i=t.response,t.readyState!==s.LOADING)break;var a=new c.MSStreamReader;a.onprogress=function(){a.result.byteLength>e._pos&&(e.push(d.from(new Uint8Array(a.result.slice(e._pos)))),e._pos=a.result.byteLength)},a.onload=function(){e.push(null)},a.readAsArrayBuffer(i)}e._xhr.readyState===s.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,i("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i("buffer").Buffer)},{"./capability":7,_process:31,buffer:26,inherits:30,"readable-stream":24}],10:[function(e,t,i){"use strict";var r={};function n(e,s,t){var i=function(a){var e,t;function i(e,t,i){return a.call(this,(r=e,n=t,o=i,"string"==typeof s?s:s(r,n,o)))||this;var r,n,o}return t=a,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,i}(t=t||Error);i.prototype.name=t.name,i.prototype.code=e,r[e]=i}function p(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map(function(e){return String(e)}),2<i?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),n("ERR_INVALID_ARG_TYPE",function(e,t,i){var r,n,o,a,s,l,u,c,d,h;if("string"==typeof t&&(n="not ",t.substr(!o||o<0?0:+o,n.length)===n)?(r="must not be",t=t.replace(/^not /,"")):r="must be",c=e,d=" argument",(void 0===h||h>c.length)&&(h=c.length),c.substring(h-d.length,h)===d)a="The ".concat(e," ").concat(r," ").concat(p(t,"type"));else{var f=("number"!=typeof u&&(u=0),u+(l=".").length>(s=e).length||-1===s.indexOf(l,u)?"argument":"property");a='The "'.concat(e,'" ').concat(f," ").concat(r," ").concat(p(t,"type"))}return a+=". Received type ".concat(typeof i)},TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r},{}],11:[function(c,d,e){(function(e){"use strict";var t=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};d.exports=s;var i=c("./_stream_readable"),r=c("./_stream_writable");c("inherits")(s,i);for(var n=t(r.prototype),o=0;o<n.length;o++){var a=n[o];s.prototype[a]||(s.prototype[a]=r.prototype[a])}function s(e){if(!(this instanceof s))return new s(e);i.call(this,e),r.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||e.nextTick(u,this)}function u(e){e.end()}Object.defineProperty(s.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(s.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(s.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,c("_process"))},{"./_stream_readable":13,"./_stream_writable":15,_process:31,inherits:30}],12:[function(e,t,i){"use strict";t.exports=n;var r=e("./_stream_transform");function n(e){if(!(this instanceof n))return new n(e);r.call(this,e)}e("inherits")(n,r),n.prototype._transform=function(e,t,i){i(null,e)}},{"./_stream_transform":14,inherits:30}],13:[function(B,F,e){(function(v,e){"use strict";var r;(F.exports=A).ReadableState=E;function m(e,t){return e.listeners(t).length}B("events").EventEmitter;var n=B("./internal/streams/stream"),l=B("buffer").Buffer,u=e.Uint8Array||function(){};var y,t=B("util");y=t&&t.debuglog?t.debuglog("stream"):function(){};var o,i,a,s=B("./internal/streams/buffer_list"),c=B("./internal/streams/destroy"),d=B("./internal/streams/state").getHighWaterMark,h=B("../errors").codes,f=h.ERR_INVALID_ARG_TYPE,p=h.ERR_STREAM_PUSH_AFTER_EOF,g=h.ERR_METHOD_NOT_IMPLEMENTED,_=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;B("inherits")(A,n);var b=c.errorOrDestroy,w=["error","close","destroy","pause","resume"];function E(e,t,i){r=r||B("./_stream_duplex"),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=d(this,e,"readableHighWaterMark",i),this.buffer=new s,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o=o||B("string_decoder/").StringDecoder,this.decoder=new o(e.encoding),this.encoding=e.encoding)}function A(e){if(r=r||B("./_stream_duplex"),!(this instanceof A))return new A(e);var t=this instanceof r;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),n.call(this)}function T(e,t,i,r,n){y("readableAddChunk",t);var o,a,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(y("onEofChunk"),t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?I(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,D(e)))}(e,s);else if(n||(o=function(e,t){var i;(function(e){return l.isBuffer(e)||e instanceof u})(t)||"string"==typeof t||void 0===t||e.objectMode||(i=new f("chunk",["string","Buffer","Uint8Array"],t));return i}(s,t)),o)b(e,o);else if(s.objectMode||t&&0<t.length)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===l.prototype||(a=t,t=l.from(a)),r)s.endEmitted?b(e,new _):k(e,s,t,!0);else if(s.ended)b(e,new p);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||0!==t.length?k(e,s,t,!1):R(e,s)):k(e,s,t,!1)}else r||(s.reading=!1,R(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function k(e,t,i,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&I(e)),R(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=c.destroy,A.prototype._undestroy=c.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),i=!0),T(this,e,t,!1,i)},A.prototype.unshift=function(e){return T(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){var t=new(o=o||B("string_decoder/").StringDecoder)(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,r="";null!==i;)r+=t.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var S=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=(S<=(i=e)?i=S:(i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++),i)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var i}function I(e){var t=e._readableState;y("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(y("emitReadable",t.flowing),t.emittedReadable=!0,v.nextTick(D,e))}function D(e){var t=e._readableState;y("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function R(e,t){t.readingMore||(t.readingMore=!0,v.nextTick(x,e,t))}function x(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(y("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function P(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function O(e){y("readable nexttick read 0"),e.read(0)}function N(e,t){y("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function U(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function M(e){var t=e._readableState;y("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,v.nextTick(V,t,e))}function V(e,t){if(y("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function j(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}A.prototype.read=function(e){y("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:0<t.length)||t.ended))return y("read: emitReadable",t.length,t.ended),(0===t.length&&t.ended?M:I)(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&M(this),null;var r,n=t.needReadable;return y("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&y("length less than watermark",n=!0),t.ended||t.reading?y("reading or ended",n=!1):n&&(y("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(i,t))),null===(r=0<e?U(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&M(this)),null!==r&&this.emit("data",r),r},A.prototype._read=function(e){b(this,new g("_read()"))},A.prototype.pipe=function(i,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=i;break;case 1:n.pipes=[n.pipes,i];break;default:n.pipes.push(i)}n.pipesCount+=1,y("pipe count=%d opts=%j",n.pipesCount,e);var t=(!e||!1!==e.end)&&i!==v.stdout&&i!==v.stderr?a:p;function o(e,t){y("onunpipe"),e===r&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,y("cleanup"),i.removeListener("close",h),i.removeListener("finish",f),i.removeListener("drain",l),i.removeListener("error",d),i.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",p),r.removeListener("data",c),u=!0,!n.awaitDrain||i._writableState&&!i._writableState.needDrain||l())}function a(){y("onend"),i.end()}n.endEmitted?v.nextTick(t):r.once("end",t),i.on("unpipe",o);var s,l=(s=r,function(){var e=s._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&m(s,"data")&&(e.flowing=!0,L(s))});i.on("drain",l);var u=!1;function c(e){y("ondata");var t=i.write(e);y("dest.write",t),!1===t&&((1===n.pipesCount&&n.pipes===i||1<n.pipesCount&&-1!==j(n.pipes,i))&&!u&&(y("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function d(e){y("onerror",e),p(),i.removeListener("error",d),0===m(i,"error")&&b(i,e)}function h(){i.removeListener("finish",f),p()}function f(){y("onfinish"),i.removeListener("close",h),p()}function p(){y("unpipe"),r.unpipe(i)}return r.on("data",c),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(i,"error",d),i.once("close",h),i.once("finish",f),i.emit("pipe",r),n.flowing||(y("pipe resume"),r.resume()),i},A.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=j(t.pipes,e);return-1===a||(t.pipes.splice(a,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},A.prototype.addListener=A.prototype.on=function(e,t){var i=n.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=0<this.listenerCount("readable"),!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,y("on readable",r.length,r.reading),r.length?I(this):r.reading||v.nextTick(O,this))),i},A.prototype.removeListener=function(e,t){var i=n.prototype.removeListener.call(this,e,t);return"readable"===e&&v.nextTick(P,this),i},A.prototype.removeAllListeners=function(e){var t=n.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||v.nextTick(P,this),t},A.prototype.resume=function(){var e,t,i=this._readableState;return i.flowing||(y("resume"),i.flowing=!i.readableListening,e=this,(t=i).resumeScheduled||(t.resumeScheduled=!0,v.nextTick(N,e,t))),i.paused=!1,this},A.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(t){var i=this,r=this._readableState,n=!1;for(var e in t.on("end",function(){if(y("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&i.push(e)}i.push(null)}),t.on("data",function(e){y("wrapped data"),r.decoder&&(e=r.decoder.write(e)),r.objectMode&&null==e||(r.objectMode||e&&e.length)&&(i.push(e)||(n=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var o=0;o<w.length;o++)t.on(w[o],this.emit.bind(this,w[o]));return this._read=function(e){y("wrapped _read",e),n&&(n=!1,t.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===i&&(i=B("./internal/streams/async_iterator")),i(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=U,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===a&&(a=B("./internal/streams/from")),a(A,e,t)})}).call(this,B("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":10,"./_stream_duplex":11,"./internal/streams/async_iterator":16,"./internal/streams/buffer_list":17,"./internal/streams/destroy":18,"./internal/streams/from":20,"./internal/streams/state":22,"./internal/streams/stream":23,_process:31,buffer:26,events:4,inherits:30,"string_decoder/":25,util:2}],14:[function(e,t,i){"use strict";t.exports=u;var r=e("../errors").codes,n=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:function(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(null===r)return this.emit("error",new o);i.writechunk=null,(i.writecb=null)!=t&&this.push(t),r(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function c(){var i=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(e,t){d(i,e,t)})}function d(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}e("inherits")(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,i){i(new n("_transform()"))},u.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":10,"./_stream_duplex":11,inherits:30}],15:[function(R,x,e){(function(m,e){"use strict";function d(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var r=e.entry;e.entry=null;for(;r;){var n=r.callback;t.pendingcb--,n(i),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var n;(x.exports=v).WritableState=p;var t={deprecate:R("util-deprecate")},i=R("./internal/streams/stream"),y=R("buffer").Buffer,g=e.Uint8Array||function(){};var r,o=R("./internal/streams/destroy"),a=R("./internal/streams/state").getHighWaterMark,s=R("../errors").codes,_=s.ERR_INVALID_ARG_TYPE,l=s.ERR_METHOD_NOT_IMPLEMENTED,u=s.ERR_MULTIPLE_CALLBACK,c=s.ERR_STREAM_CANNOT_PIPE,h=s.ERR_STREAM_DESTROYED,b=s.ERR_STREAM_NULL_VALUES,w=s.ERR_STREAM_WRITE_AFTER_END,f=s.ERR_UNKNOWN_ENCODING,E=o.errorOrDestroy;function A(){}function p(e,t,i){n=n||R("./_stream_duplex"),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=a(this,e,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if("function"!=typeof n)throw new u;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,r,n){--t.pendingcb,i?(m.nextTick(n,r),m.nextTick(D,e,t),e._writableState.errorEmitted=!0,E(e,r)):(n(r),e._writableState.errorEmitted=!0,E(e,r),D(e,t))}(e,i,r,t,n);else{var o=C(i)||e.destroyed;o||i.corked||i.bufferProcessing||!i.bufferedRequest||S(e,i),r?m.nextTick(k,e,i,o,n):k(e,i,o,n)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new d(this)}function v(e){var t=this instanceof(n=n||R("./_stream_duplex"));if(!t&&!r.call(v,this))return new v(e);this._writableState=new p(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),i.call(this)}function T(e,t,i,r,n,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new h("write")):i?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function k(e,t,i,r){var n,o;i||(n=e,0===(o=t).length&&o.needDrain&&(o.needDrain=!1,n.emit("drain"))),t.pendingcb--,r(),D(e,t)}function S(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,n=new Array(r),o=t.corkedRequestsFree;o.entry=i;for(var a=0,s=!0;i;)(n[a]=i).isBuf||(s=!1),i=i.next,a+=1;n.allBuffers=s,T(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new d(t),t.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,u=i.encoding,c=i.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,u,c),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function I(t,i){t._final(function(e){i.pendingcb--,e&&E(t,e),i.prefinished=!0,t.emit("prefinish"),D(t,i)})}function D(e,t){var i,r,n=C(t);if(n&&(i=e,(r=t).prefinished||r.finalCalled||("function"!=typeof i._final||r.destroyed?(r.prefinished=!0,i.emit("prefinish")):(r.pendingcb++,r.finalCalled=!0,m.nextTick(I,i,r))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var o=e._readableState;(!o||o.autoDestroy&&o.endEmitted)&&e.destroy()}return n}R("inherits")(v,i),p.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(p.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(r=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!r.call(this,e)||this===v&&(e&&e._writableState instanceof p)}})):r=function(e){return e instanceof this},v.prototype.pipe=function(){E(this,new c)},v.prototype.write=function(e,t,i){var r,n,o,a,s,l,u,c,d,h,f=this._writableState,p=!1,v=!f.objectMode&&(r=e,y.isBuffer(r)||r instanceof g);return v&&!y.isBuffer(e)&&(n=e,e=y.from(n)),"function"==typeof t&&(i=t,t=null),t=v?"buffer":t||f.defaultEncoding,"function"!=typeof i&&(i=A),f.ending?(c=this,d=i,h=new w,E(c,h),m.nextTick(d,h)):!v&&(o=this,a=f,l=i,null===(s=e)?u=new b:"string"==typeof s||a.objectMode||(u=new _("chunk",["string","Buffer"],s)),u&&(E(o,u),!void m.nextTick(l,u)))||(f.pendingcb++,p=function(e,t,i,r,n,o){if(!i){var a=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=y.from(t,i));return t}(t,r,n);r!==a&&(i=!0,n="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,r,n,o);return l}(this,f,v,e,t,i)),p},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||S(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new f(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,i){i(new l("_write()"))},v.prototype._writev=null,v.prototype.end=function(e,t,i){var r=this._writableState;return"function"==typeof e?(i=e,t=e=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,i){t.ending=!0,D(e,t),i&&(t.finished?m.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,r,i),this},Object.defineProperty(v.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(v.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=o.destroy,v.prototype._undestroy=o.undestroy,v.prototype._destroy=function(e,t){t(e)}}).call(this,R("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":10,"./_stream_duplex":11,"./internal/streams/destroy":18,"./internal/streams/state":22,"./internal/streams/stream":23,_process:31,buffer:26,inherits:30,"util-deprecate":39}],16:[function(r,m,e){(function(s){"use strict";var e;function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var n=r("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),u=Symbol("ended"),c=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var i=e[h].read();null!==i&&(e[c]=null,e[o]=null,e[a]=null,t(f(i,!1)))}}var t=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((i(e={get stream(){return this[h]},next:function(){var i=this,e=this[l];if(null!==e)return Promise.reject(e);if(this[u])return Promise.resolve(f(void 0,!0));if(this[h].destroyed)return new Promise(function(e,t){s.nextTick(function(){i[l]?t(i[l]):e(f(void 0,!0))})});var t,r,n,o=this[c];if(o)t=new Promise((r=o,n=this,function(e,t){r.then(function(){n[u]?e(f(void 0,!0)):n[d](e,t)},t)}));else{var a=this[h].read();if(null!==a)return Promise.resolve(f(a,!1));t=new Promise(this[d])}return this[c]=t}},Symbol.asyncIterator,function(){return this}),i(e,"return",function(){var e=this;return new Promise(function(t,i){e[h].destroy(null,function(e){e?i(e):t(f(void 0,!0))})})}),e),t);m.exports=function(e){var t,r=Object.create(v,(i(t={},h,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var i=r[h].read();i?(r[c]=null,r[o]=null,r[a]=null,e(f(i,!1))):(r[o]=e,r[a]=t)},writable:!0}),t));return r[c]=null,n(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[c]=null,r[o]=null,r[a]=null,t(e)),void(r[l]=e)}var i=r[o];null!==i&&(r[c]=null,r[o]=null,i(f(void 0,!(r[a]=null)))),r[u]=!0}),e.on("readable",function(e){s.nextTick(p,e)}.bind(null,r)),r}}).call(this,r("_process"))},{"./end-of-stream":19,_process:31}],17:[function(e,t,i){"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=e("buffer").Buffer,l=e("util").inspect,u=l&&l.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,i,r;return t=e,(i=[{key:"push",value:function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,i,r,n=s.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,i=n,r=a,s.prototype.copy.call(t,i,r),a+=o.data.length,o=o.next;return n}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,r=t.data;for(e-=r.length;t=t.next;){var n=t.data,o=e>n.length?n.length:e;if(o===n.length?r+=n:r+=n.slice(0,e),0===(e-=o)){o===n.length?(++i,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t).data=n.slice(o);break}++i}return this.length-=i,r}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),i=this.head,r=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var n=i.data,o=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,o),0===(e-=o)){o===n.length?(++r,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i).data=n.slice(o);break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return l(this,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach(function(e){o(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,i),r&&a(t,r),e}()},{buffer:26,util:2}],18:[function(e,t,i){(function(o){"use strict";function a(e,t){l(e,t),s(e)}function s(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function l(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(l,this,e)):o.nextTick(l,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?i._writableState?i._writableState.errorEmitted?o.nextTick(s,i):(i._writableState.errorEmitted=!0,o.nextTick(a,i,e)):o.nextTick(a,i,e):t?(o.nextTick(s,i),t(e)):o.nextTick(s,i)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,r=e._writableState;i&&i.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,e("_process"))},{_process:31}],19:[function(e,t,i){"use strict";var y=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function g(){}t.exports=function e(t,i,r){if("function"==typeof i)return e(t,null,i);var n,o;n=r||g,o=!1,r=function(){if(!o){o=!0;for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.apply(this,t)}};function a(){t.writable||v()}function s(){m=!(h=!1),f||r.call(t)}function l(e){r.call(t,e)}function u(){var e;return h&&!m?(t._readableState&&t._readableState.ended||(e=new y),r.call(t,e)):f&&!p?(t._writableState&&t._writableState.ended||(e=new y),r.call(t,e)):void 0}function c(){t.req.on("finish",v)}var d,h=(i=i||{}).readable||!1!==i.readable&&t.readable,f=i.writable||!1!==i.writable&&t.writable,p=t._writableState&&t._writableState.finished,v=function(){p=!(f=!1),h||r.call(t)},m=t._readableState&&t._readableState.endEmitted;return(d=t).setHeader&&"function"==typeof d.abort?(t.on("complete",v),t.on("abort",u),t.req?c():t.on("request",c)):f&&!t._writableState&&(t.on("end",a),t.on("close",a)),t.on("end",s),t.on("finish",v),!1!==i.error&&t.on("error",l),t.on("close",u),function(){t.removeListener("complete",v),t.removeListener("abort",u),t.removeListener("request",c),t.req&&t.req.removeListener("finish",v),t.removeListener("end",a),t.removeListener("close",a),t.removeListener("finish",v),t.removeListener("end",s),t.removeListener("error",l),t.removeListener("close",u)}}},{"../../../errors":10}],20:[function(e,t,i){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],21:[function(l,e,t){"use strict";var u;var i=l("../../../errors").codes,s=i.ERR_MISSING_ARGS,c=i.ERR_STREAM_DESTROYED;function d(e){if(e)throw e}function h(i,e,t,r){var n,o;n=r,o=!1;var a=!(r=function(){o||(o=!0,n.apply(void 0,arguments))});i.on("close",function(){a=!0}),void 0===u&&(u=l("./end-of-stream")),u(i,{readable:e,writable:t},function(e){if(e)return r(e);a=!0,r()});var s=!1;return function(e){var t;if(!a&&!s)return s=!0,(t=i).setHeader&&"function"==typeof t.abort?i.abort():"function"==typeof i.destroy?i.destroy():void r(e||new c("pipe"))}}function f(e){e()}function p(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var i,n,o=(i=r).length&&"function"==typeof i[i.length-1]?i.pop():d;if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new s("streams");var a=r.map(function(e,t){var i=t<r.length-1;return h(e,i,0<t,function(e){n=n||e,e&&a.forEach(f),i||(a.forEach(f),o(n))})});return r.reduce(p)}},{"../../../errors":10,"./end-of-stream":19}],22:[function(e,t,i){"use strict";var l=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,i,r){var n,o,a,s=(o=r,a=i,null!=(n=t).highWaterMark?n.highWaterMark:o?n[a]:null);if(null==s)return e.objectMode?16:16384;if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new l(r?i:"highWaterMark",s);return Math.floor(s)}}},{"../../../errors":10}],23:[function(e,t,i){t.exports=e("events").EventEmitter},{events:4}],24:[function(e,t,i){(((i=t.exports=e("./lib/_stream_readable.js")).Stream=i).Readable=i).Writable=e("./lib/_stream_writable.js"),i.Duplex=e("./lib/_stream_duplex.js"),i.Transform=e("./lib/_stream_transform.js"),i.PassThrough=e("./lib/_stream_passthrough.js"),i.finished=e("./lib/internal/streams/end-of-stream.js"),i.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":11,"./lib/_stream_passthrough.js":12,"./lib/_stream_readable.js":13,"./lib/_stream_transform.js":14,"./lib/_stream_writable.js":15,"./lib/internal/streams/end-of-stream.js":19,"./lib/internal/streams/pipeline.js":21}],25:[function(e,t,i){"use strict";var r=e("safe-buffer").Buffer,n=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}function a(e){var t;switch(this.encoding=o(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=l,t=4;break;case"base64":this.text=d,this.end=h,t=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function l(e){var t=this.lastTotal-this.lastNeed,i=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var i=e.toString("utf16le",t);if(i){var r=i.charCodeAt(i.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function d(e,t){var i=(e.length-t)%3;return 0==i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1==i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}(i.StringDecoder=a).prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var i=function(e,t,i){var r=t.length-1;if(r<i)return 0;var n=s(t[r]);if(0<=n)return 0<n&&(e.lastNeed=n-1),n;if(--r<i||-2===n)return 0;if(0<=(n=s(t[r])))return 0<n&&(e.lastNeed=n-2),n;if(--r<i||-2===n)return 0;if(0<=(n=s(t[r])))return 0<n&&(2===n?n=0:e.lastNeed=n-3),n;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var r=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":5}],26:[function(e,t,i){"use strict";var r=e("base64-js"),o=e("ieee754");i.Buffer=d,i.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},i.INSPECT_MAX_BYTES=50;var n=2147483647;function a(e){if(n<e)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=d.prototype,t}function d(e,t,i){if("number"!=typeof e)return s(e,t,i);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(e)}function s(e,t,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return M(e)||e&&M(e.buffer)?function(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');var r;r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i);return r.__proto__=d.prototype,r}(e,t,i):"string"==typeof e?function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!d.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var i=0|f(e,t),r=a(i),n=r.write(e,t);n!==i&&(r=r.slice(0,n));return r}(e,t):function(e){if(d.isBuffer(e)){var t=0|h(e.length),i=a(t);return 0===i.length?i:(e.copy(i,0,0,t),i)}if(e){if(ArrayBuffer.isView(e)||"length"in e)return"number"!=typeof e.length||V(e.length)?a(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e){return l(e),a(e<0?0:0|h(e))}function c(e){for(var t=e.length<0?0:0|h(e.length),i=a(t),r=0;r<t;r+=1)i[r]=255&e[r];return i}function h(e){if(n<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function f(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||M(e))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return L(e).length;default:if(r)return N(e).length;t=(""+t).toLowerCase(),r=!0}}function p(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function v(e,t,i,r,n){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),V(i=+i)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return-1;i=e.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:m(e,t,i,r,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):m(e,[t],i,r,n);throw new TypeError("val must be string, number or Buffer")}function m(e,t,i,r,n){var o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s/=a=2,l/=2,i/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){var c=-1;for(o=i;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(s<i+l&&(i=s-l),o=i;0<=o;o--){for(var d=!0,h=0;h<l;h++)if(u(e,o+h)!==u(t,h)){d=!1;break}if(d)return o}return-1}function y(e,t,i,r){i=Number(i)||0;var n=e.length-i;(!r||n<(r=Number(r)))&&(r=n);var o=t.length;o/2<r&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(V(s))return a;e[i+a]=s}return a}function g(e,t,i,r){return U(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,r)}function _(e,t,i,r){return U(function(e,t){for(var i,r,n,o=[],a=0;a<e.length&&!((t-=2)<0);++a)i=e.charCodeAt(a),r=i>>8,n=i%256,o.push(n),o.push(r);return o}(t,e.length-i),e,i,r)}function b(e,t,i){return 0===t&&i===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,i))}function w(e,t,i){i=Math.min(e.length,i);for(var r=[],n=t;n<i;){var o,a,s,l,u=e[n],c=null,d=239<u?4:223<u?3:191<u?2:1;if(n+d<=i)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[n+1]))&&127<(l=(31&u)<<6|63&o)&&(c=l);break;case 3:o=e[n+1],a=e[n+2],128==(192&o)&&128==(192&a)&&2047<(l=(15&u)<<12|(63&o)<<6|63&a)&&(l<55296||57343<l)&&(c=l);break;case 4:o=e[n+1],a=e[n+2],s=e[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,d=1):65535<c&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),n+=d}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);var i="",r=0;for(;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=E));return i}(r)}i.kMaxLength=n,(d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{get:function(){if(this instanceof d)return this.buffer}}),Object.defineProperty(d.prototype,"offset",{get:function(){if(this instanceof d)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=function(e,t,i){return s(e,t,i)},d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,d.alloc=function(e,t,i){return n=t,o=i,l(r=e),r<=0||void 0===n?a(r):"string"==typeof o?a(r).fill(n,o):a(r).fill(n);var r,n,o},d.allocUnsafe=function(e){return u(e)},d.allocUnsafeSlow=function(e){return u(e)},d.isBuffer=function(e){return null!=e&&!0===e._isBuffer},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,r=t.length,n=0,o=Math.min(i,r);n<o;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var i;if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;var r=d.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){var o=e[i];if(ArrayBuffer.isView(o)&&(o=d.from(o)),!d.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,n),n+=o.length}return r},d.byteLength=f,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},d.prototype.toLocaleString=d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?w(this,0,e):function(e,t,i){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return k(this,t,i);case"utf8":case"utf-8":return w(this,t,i);case"ascii":return A(this,t,i);case"latin1":case"binary":return T(this,t,i);case"base64":return b(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,i,r,n){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(n<=r&&i<=t)return 0;if(n<=r)return-1;if(i<=t)return 1;if(this===e)return 0;for(var o=(n>>>=0)-(r>>>=0),a=(i>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(r,n),u=e.slice(t,i),c=0;c<s;++c)if(l[c]!==u[c]){o=l[c],a=u[c];break}return o<a?-1:a<o?1:0},d.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},d.prototype.indexOf=function(e,t,i){return v(this,e,t,i,!0)},d.prototype.lastIndexOf=function(e,t,i){return v(this,e,t,i,!1)},d.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-t;if((void 0===i||n<i)&&(i=n),0<e.length&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,a,s,l,u,c,d=!1;;)switch(r){case"hex":return y(this,e,t,i);case"utf8":case"utf-8":return u=t,c=i,U(N(e,(l=this).length-u),l,u,c);case"ascii":return g(this,e,t,i);case"latin1":case"binary":return g(this,e,t,i);case"base64":return o=this,a=t,s=i,U(L(e),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,i);default:if(d)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),d=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function A(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}function T(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}function k(e,t,i){var r=e.length;(!t||t<0)&&(t=0),(!i||i<0||r<i)&&(i=r);for(var n="",o=t;o<i;++o)n+=O(e[o]);return n}function S(e,t,i){for(var r=e.slice(t,i),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}function C(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(i<e+t)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,i,r,n,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<t||t<o)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function D(e,t,i,r){if(i+r>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function R(e,t,i,r,n){return t=+t,i>>>=0,n||D(e,0,i,4),o.write(e,t,i,r,23,4),i+4}function x(e,t,i,r,n){return t=+t,i>>>=0,n||D(e,0,i,8),o.write(e,t,i,r,52,8),i+8}d.prototype.slice=function(e,t){var i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=d.prototype,r},d.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||C(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r},d.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||C(e,t,this.length);for(var r=this[e+--t],n=1;0<t&&(n*=256);)r+=this[e+--t]*n;return r},d.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||C(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return(n*=128)<=r&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||C(e,t,this.length);for(var r=t,n=1,o=this[e+--r];0<r&&(n*=256);)o+=this[e+--r]*n;return(n*=128)<=o&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},d.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),o.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),o.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),o.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),o.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||I(this,e,t,i,Math.pow(2,8*i)-1,0);var n=1,o=0;for(this[t]=255&e;++o<i&&(n*=256);)this[t+o]=e/n&255;return t+i},d.prototype.writeUIntBE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||I(this,e,t,i,Math.pow(2,8*i)-1,0);var n=i-1,o=1;for(this[t+n]=255&e;0<=--n&&(o*=256);)this[t+n]=e/o&255;return t+i},d.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var n=Math.pow(2,8*i-1);I(this,e,t,i,n-1,-n)}var o=0,a=1,s=0;for(this[t]=255&e;++o<i&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+i},d.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var n=Math.pow(2,8*i-1);I(this,e,t,i,n-1,-n)}var o=i-1,a=1,s=0;for(this[t+o]=255&e;0<=--o&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+i},d.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeFloatLE=function(e,t,i){return R(this,e,t,!0,i)},d.prototype.writeFloatBE=function(e,t,i){return R(this,e,t,!1,i)},d.prototype.writeDoubleLE=function(e,t,i){return x(this,e,t,!0,i)},d.prototype.writeDoubleBE=function(e,t,i){return x(this,e,t,!1,i)},d.prototype.copy=function(e,t,i,r){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i=i||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<i&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var n=r-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,i,r);else if(this===e&&i<t&&t<r)for(var o=n-1;0<=o;--o)e[o+t]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,r),t);return n},d.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var n=e.charCodeAt(0);("utf8"===r&&n<128||"latin1"===r)&&(e=n)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var o;if(t>>>=0,i=void 0===i?this.length:i>>>0,"number"==typeof(e=e||0))for(o=t;o<i;++o)this[o]=e;else{var a=d.isBuffer(e)?e:new d(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<i-t;++o)this[o+t]=a[o%s]}return this};var P=/[^+/0-9A-Za-z-_]/g;function O(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){var i;t=t||1/0;for(var r=e.length,n=null,o=[],a=0;a<r;++a){if(55295<(i=e.charCodeAt(a))&&i<57344){if(!n){if(56319<i){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&o.push(239,191,189);continue}n=i;continue}if(i<56320){-1<(t-=3)&&o.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&-1<(t-=3)&&o.push(239,191,189);if(n=null,i<128){if(--t<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function L(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function M(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function V(e){return e!=e}},{"base64-js":1,ieee754:29}],27:[function(e,t,i){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],28:[function(e,t,i){var r=e("http"),n=e("url"),o=t.exports;for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);function s(e){if("string"==typeof e&&(e=n.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}o.request=function(e,t){return e=s(e),r.request.call(this,e,t)},o.get=function(e,t){return e=s(e),r.get.call(this,e,t)}},{http:6,url:37}],29:[function(e,t,i){i.read=function(e,t,i,r,n){var o,a,s=8*n-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=i?n-1:0,h=i?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-c)-1,f>>=-c,c+=s;0<c;o=256*o+e[t+d],d+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+e[t+d],d+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},i.write=function(e,t,i,r,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,d=c>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(t+=1<=a+d?h/l:h*Math.pow(2,1-d))*l&&(a++,l/=2),c<=a+d?(s=0,a=c):1<=a+d?(s=(t*l-1)*Math.pow(2,n),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,n),a=0));8<=n;e[i+f]=255&s,f+=p,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;e[i+f]=255&a,f+=p,a/=256,u-=8);e[i+f-p]|=128*v}},{}],30:[function(e,t,i){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;function i(){}i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],31:[function(e,t,i){var r,n,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var u,c=[],d=!1,h=-1;function f(){d&&u&&(d=!1,u.length?c=u.concat(c):h=-1,c.length&&p())}function p(){if(!d){var e=l(f);d=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,d=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new v(e,t)),1!==c.length||d||l(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],32:[function(e,P,O){(function(x){!function(e){var t="object"==typeof O&&O&&!O.nodeType&&O,i="object"==typeof P&&P&&!P.nodeType&&P,r="object"==typeof x&&x;r.global!==r&&r.window!==r&&r.self!==r||(e=r);var n,o,y=2147483647,g=36,_=1,b=26,a=38,s=700,w=72,E=128,A="-",l=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=g-_,T=Math.floor,k=String.fromCharCode;function S(e){throw new RangeError(d[e])}function f(e,t){for(var i=e.length,r=[];i--;)r[i]=t(e[i]);return r}function p(e,t){var i=e.split("@"),r="";return 1<i.length&&(r=i[0]+"@",e=i[1]),r+f((e=e.replace(c,".")).split("."),t).join(".")}function C(e){for(var t,i,r=[],n=0,o=e.length;n<o;)55296<=(t=e.charCodeAt(n++))&&t<=56319&&n<o?56320==(64512&(i=e.charCodeAt(n++)))?r.push(((1023&t)<<10)+(1023&i)+65536):(r.push(t),n--):r.push(t);return r}function I(e){return f(e,function(e){var t="";return 65535<e&&(t+=k((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=k(e)}).join("")}function D(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,i){var r=0;for(e=i?T(e/s):e>>1,e+=T(e/t);h*b>>1<e;r+=g)e=T(e/h);return T(r+(h+1)*e/(e+a))}function v(e){var t,i,r,n,o,a,s,l,u,c,d,h=[],f=e.length,p=0,v=E,m=w;for((i=e.lastIndexOf(A))<0&&(i=0),r=0;r<i;++r)128<=e.charCodeAt(r)&&S("not-basic"),h.push(e.charCodeAt(r));for(n=0<i?i+1:0;n<f;){for(o=p,a=1,s=g;f<=n&&S("invalid-input"),d=e.charCodeAt(n++),(g<=(l=d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:g)||l>T((y-p)/a))&&S("overflow"),p+=l*a,!(l<(u=s<=m?_:m+b<=s?b:s-m));s+=g)a>T(y/(c=g-u))&&S("overflow"),a*=c;m=R(p-o,t=h.length+1,0==o),T(p/t)>y-v&&S("overflow"),v+=T(p/t),p%=t,h.splice(p++,0,v)}return I(h)}function m(e){var t,i,r,n,o,a,s,l,u,c,d,h,f,p,v,m=[];for(h=(e=C(e)).length,t=E,o=w,a=i=0;a<h;++a)(d=e[a])<128&&m.push(k(d));for(r=n=m.length,n&&m.push(A);r<h;){for(s=y,a=0;a<h;++a)t<=(d=e[a])&&d<s&&(s=d);for(s-t>T((y-i)/(f=r+1))&&S("overflow"),i+=(s-t)*f,t=s,a=0;a<h;++a)if((d=e[a])<t&&++i>y&&S("overflow"),d==t){for(l=i,u=g;!(l<(c=u<=o?_:o+b<=u?b:u-o));u+=g)v=l-c,p=g-c,m.push(k(D(c+v%p,0))),l=T(v/p);m.push(k(D(l,0))),o=R(i,f,r==n),i=0,++r}++i,++t}return m.join("")}if(n={version:"1.4.1",ucs2:{decode:C,encode:I},decode:v,encode:m,toASCII:function(e){return p(e,function(e){return u.test(e)?"xn--"+m(e):e})},toUnicode:function(e){return p(e,function(e){return l.test(e)?v(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return n});else if(t&&i)if(P.exports==t)i.exports=n;else for(o in n)n.hasOwnProperty(o)&&(t[o]=n[o]);else e.punycode=n}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t,i){"use strict";t.exports=function(e,t,i,r){t=t||"&",i=i||"=";var n={};if("string"!=typeof e||0===e.length)return n;var o=/\+/g;e=e.split(t);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var s,l,u=e.length;0<a&&a<u&&(u=a);for(var c=0;c<u;++c){var d,h,f,p,v=e[c].replace(o,"%20"),m=v.indexOf(i);h=0<=m?(d=v.substr(0,m),v.substr(m+1)):(d=v,""),f=decodeURIComponent(d),p=decodeURIComponent(h),s=n,l=f,Object.prototype.hasOwnProperty.call(s,l)?y(n[f])?n[f].push(p):n[f]=[n[f],p]:n[f]=p}return n};var y=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],34:[function(e,t,i){"use strict";function o(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}t.exports=function(i,r,n,e){return r=r||"&",n=n||"=",null===i&&(i=void 0),"object"==typeof i?s(l(i),function(e){var t=encodeURIComponent(o(e))+n;return a(i[e])?s(i[e],function(e){return t+encodeURIComponent(o(e))}).join(r):t+encodeURIComponent(o(i[e]))}).join(r):e?encodeURIComponent(o(e))+n+encodeURIComponent(o(i)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e,t){if(e.map)return e.map(t);for(var i=[],r=0;r<e.length;r++)i.push(t(e[r],r));return i}var l=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},{}],35:[function(e,t,i){"use strict";i.decode=i.parse=e("./decode"),i.encode=i.stringify=e("./encode")},{"./decode":33,"./encode":34}],36:[function(e,t,i){function r(){}r.prototype={on:function(e,t,i){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var r=this;function n(){r.off(e,n),t.apply(i,arguments)}return n._=t,this.on(e,n,i)},emit:function(e){for(var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),r=0,n=i.length;r<n;r++)i[r].fn.apply(i[r].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),r=i[e],n=[];if(r&&t)for(var o=0,a=r.length;o<a;o++)r[o].fn!==t&&r[o].fn._!==t&&n.push(r[o]);return n.length?i[e]=n:delete i[e],this}},t.exports=r},{}],37:[function(e,t,i){"use strict";var O=e("punycode"),N=e("./util");function C(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=o,i.resolve=function(e,t){return o(e,!1,!0).resolve(t)},i.resolveObject=function(e,t){return e?o(e,!1,!0).resolveObject(t):t},i.format=function(e){N.isString(e)&&(e=o(e));return e instanceof C?e.format():C.prototype.format.call(e)},i.Url=C;var L=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,U=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),M=["'"].concat(n),V=["%","/","?",";","#"].concat(M),j=["/","?","#"],B=/^[+a-z0-9A-Z_-]{0,63}$/,F=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,W={javascript:!0,"javascript:":!0},q={javascript:!0,"javascript:":!0},H={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},z=e("querystring");function o(e,t,i){if(e&&N.isObject(e)&&e instanceof C)return e;var r=new C;return r.parse(e,t,i),r}C.prototype.parse=function(e,t,i){if(!N.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),n=-1!==r&&r<e.indexOf("#")?"?":"#",o=e.split(n);o[0]=o[0].replace(/\\/g,"/");var a=e=o.join(n);if(a=a.trim(),!i&&1===e.split("#").length){var s=U.exec(a);if(s)return this.path=a,this.href=a,this.pathname=s[1],s[2]?(this.search=s[2],this.query=t?z.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=L.exec(a);if(l){var u=(l=l[0]).toLowerCase();this.protocol=u,a=a.substr(l.length)}if(i||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var c="//"===a.substr(0,2);!c||l&&q[l]||(a=a.substr(2),this.slashes=!0)}if(!q[l]&&(c||l&&!H[l])){for(var d,h,f=-1,p=0;p<j.length;p++){-1!==(v=a.indexOf(j[p]))&&(-1===f||v<f)&&(f=v)}-1!==(h=-1===f?a.lastIndexOf("@"):a.lastIndexOf("@",f))&&(d=a.slice(0,h),a=a.slice(h+1),this.auth=decodeURIComponent(d)),f=-1;for(p=0;p<V.length;p++){var v;-1!==(v=a.indexOf(V[p]))&&(-1===f||v<f)&&(f=v)}-1===f&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var y=this.hostname.split(/\./),g=(p=0,y.length);p<g;p++){var _=y[p];if(_&&!_.match(B)){for(var b="",w=0,E=_.length;w<E;w++)127<_.charCodeAt(w)?b+="x":b+=_[w];if(!b.match(B)){var A=y.slice(0,p),T=y.slice(p+1),k=_.match(F);k&&(A.push(k[1]),T.unshift(k[2])),T.length&&(a="/"+T.join(".")+a),this.hostname=A.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),m||(this.hostname=O.toASCII(this.hostname));var S=this.port?":"+this.port:"",C=this.hostname||"";this.host=C+S,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!W[u])for(p=0,g=M.length;p<g;p++){var I=M[p];if(-1!==a.indexOf(I)){var D=encodeURIComponent(I);D===I&&(D=escape(I)),a=a.split(I).join(D)}}var R=a.indexOf("#");-1!==R&&(this.hash=a.substr(R),a=a.slice(0,R));var x=a.indexOf("?");if(-1!==x?(this.search=a.substr(x),this.query=a.substr(x+1),t&&(this.query=z.parse(this.query)),a=a.slice(0,x)):t&&(this.search="",this.query={}),a&&(this.pathname=a),H[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){S=this.pathname||"";var P=this.search||"";this.path=S+P}return this.href=this.format(),this},C.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",r=this.hash||"",n=!1,o="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&N.isObject(this.query)&&Object.keys(this.query).length&&(o=z.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||H[t])&&!1!==n?(n="//"+(n||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):n=n||"",r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+n+(i=i.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(a=a.replace("#","%23"))+r},C.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},C.prototype.resolveObject=function(e){if(N.isString(e)){var t=new C;t.parse(e,!1,!0),e=t}for(var i=new C,r=Object.keys(this),n=0;n<r.length;n++){var o=r[n];i[o]=this[o]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),s=0;s<a.length;s++){var l=a[s];"protocol"!==l&&(i[l]=e[l])}return H[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!H[e.protocol]){for(var u=Object.keys(e),c=0;c<u.length;c++){var d=u[c];i[d]=e[d]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||q[e.protocol])i.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),i.pathname=h.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var f=i.pathname||"",p=i.search||"";i.path=f+p}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=m||v||i.host&&e.pathname,g=y,_=i.pathname&&i.pathname.split("/")||[],b=(h=e.pathname&&e.pathname.split("/")||[],i.protocol&&!H[i.protocol]);if(b&&(i.hostname="",i.port=null,i.host&&(""===_[0]?_[0]=i.host:_.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),y=y&&(""===h[0]||""===_[0])),m)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,_=h;else if(h.length)(_=_||[]).pop(),_=_.concat(h),i.search=e.search,i.query=e.query;else if(!N.isNullOrUndefined(e.search)){if(b)i.hostname=i.host=_.shift(),(k=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=k.shift(),i.host=i.hostname=k.shift());return i.search=e.search,i.query=e.query,N.isNull(i.pathname)&&N.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!_.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var w=_.slice(-1)[0],E=(i.host||e.host||1<_.length)&&("."===w||".."===w)||""===w,A=0,T=_.length;0<=T;T--)"."===(w=_[T])?_.splice(T,1):".."===w?(_.splice(T,1),A++):A&&(_.splice(T,1),A--);if(!y&&!g)for(;A--;)_.unshift("..");!y||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),E&&"/"!==_.join("/").substr(-1)&&_.push("");var k,S=""===_[0]||_[0]&&"/"===_[0].charAt(0);b&&(i.hostname=i.host=!S&&_.length?_.shift():"",(k=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=k.shift(),i.host=i.hostname=k.shift()));return(y=y||i.host&&_.length)&&!S&&_.unshift(""),_.length?i.pathname=_.join("/"):(i.pathname=null,i.path=null),N.isNull(i.pathname)&&N.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},C.prototype.parseHost=function(){var e=this.host,t=r.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":38,punycode:32,querystring:35}],38:[function(e,t,i){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],39:[function(e,t,i){(function(i){function r(e){try{if(!i.localStorage)return}catch(e){return}var t=i.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var i=!1;return function(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],40:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(){s(this,n),this.id=null,this.sequence=null,this.system=null,this.title=null,this.description=null,this.advertiser=null,this.pricing=null,this.survey=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[],this.extensions=[]}function v(){s(this,v),this.attributes={},this.children=[]}function m(){s(this,m),this.name=null,this.value=null,this.attributes={}}function u(){s(this,u),this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.altText=null,this.companionClickThroughURLTemplate=null,this.companionClickTrackingURLTemplates=[],this.trackingEvents={}}function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};s(this,o),this.id=e.id||null,this.adId=e.adId||null,this.sequence=e.sequence||null,this.apiFramework=e.apiFramework||null,this.trackingEvents={}}function c(){s(this,c),this.program=null,this.height=0,this.width=0,this.xPosition=0,this.yPosition=0,this.apiFramework=null,this.offset=null,this.duration=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.iconClickThroughURLTemplate=null,this.iconClickTrackingURLTemplates=[],this.iconViewTrackingURLTemplate=null}function d(){s(this,d),this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null}function h(){s(this,h),this.id=null,this.width=0,this.height=0,this.expandedWidth=0,this.expandedHeight=0,this.scalable=!0,this.maintainAspectRatio=!0,this.minSuggestedDuration=0,this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null,this.nonlinearClickTrackingURLTemplates=[],this.adParameters=null}function a(){s(this,a),this.ads=[],this.errorURLTemplates=[]}var f,p,y=e("events"),g=function(e,t,i){return t&&se(e.prototype,t),i&&se(e,i),e},_=(r(ae,o),ae),b=(g(oe,[{key:"track",value:function(e,t){this.resolveURLTemplates(e,t).forEach(function(e){"undefined"!=typeof window&&null!==window&&((new Image).src=e)})}},{key:"resolveURLTemplates",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=[];for(var r in t.ASSETURI&&(t.ASSETURI=this.encodeURIComponentRFC3986(t.ASSETURI)),t.CONTENTPLAYHEAD&&(t.CONTENTPLAYHEAD=this.encodeURIComponentRFC3986(t.CONTENTPLAYHEAD)),t.ERRORCODE&&!/^[0-9]{3}$/.test(t.ERRORCODE)&&(t.ERRORCODE=900),t.CACHEBUSTING=this.leftpad(Math.round(1e8*Math.random()).toString()),t.TIMESTAMP=this.encodeURIComponentRFC3986((new Date).toISOString()),t.RANDOM=t.random=t.CACHEBUSTING,e){var n=e[r];if(n){for(var o in t){var a=t[o],s="["+o+"]",l="%%"+o+"%%";n=(n=n.replace(s,a)).replace(l,a)}i.push(n)}}return i}},{key:"encodeURIComponentRFC3986",value:function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}},{key:"leftpad",value:function(e){return e.length<8?this.range(0,8-e.length,!1).map(function(e){return"0"}).join("")+e:e}},{key:"range",value:function(e,t,i){for(var r=[],n=e<t,o=i?n?t+1:t-1:t,a=e;n?a<o:o<a;n?a++:a--)r.push(a);return r}},{key:"isNumeric",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},{key:"flatten",value:function(e){var i=this;return e.reduce(function(e,t){return e.concat(Array.isArray(t)?i.flatten(t):t)},[])}}]),oe),w=(g(ne,[{key:"childByName",value:function(e,t){var i=e.childNodes;for(var r in i){var n=i[r];if(n.nodeName===t)return n}}},{key:"childrenByName",value:function(e,t){var i=[],r=e.childNodes;for(var n in r){var o=r[n];o.nodeName===t&&i.push(o)}return i}},{key:"resolveVastAdTagURI",value:function(e,t){return t?0===e.indexOf("//")?""+location.protocol+e:-1===e.indexOf("://")?t.slice(0,t.lastIndexOf("/"))+"/"+e:e:e}},{key:"parseBoolean",value:function(e){return-1!==["true","TRUE","1"].indexOf(e)}},{key:"parseNodeText",value:function(e){return e&&(e.textContent||e.text||"").trim()}},{key:"copyNodeAttribute",value:function(e,t,i){var r=t.getAttribute(e);r&&i.setAttribute(e,r)}},{key:"parseDuration",value:function(e){if(null==e)return-1;if(this.util.isNumeric(e))return parseInt(e);var t=e.split(":");if(3!==t.length)return-1;var i=t[2].split("."),r=parseInt(i[0]);2===i.length&&(r+=parseFloat("0."+i[1]));var n=parseInt(60*t[1]),o=parseInt(60*t[0]*60);return isNaN(o)||isNaN(n)||isNaN(r)||3600<n||60<r?-1:o+n+r}},{key:"splitVAST",value:function(r){var n=[],o=null;return r.forEach(function(e,t){if(e.sequence&&(e.sequence=parseInt(e.sequence,10)),1<e.sequence){var i=r[t-1];if(i&&i.sequence===e.sequence-1)return void(o&&o.push(e));delete e.sequence}o=[e],n.push(o)}),n}}]),ne),E=(g(re,[{key:"parse",value:function(e,t){var n=this,i=new _(t);return this.parserUtils.childrenByName(e,"Companion").forEach(function(t){var r=new u;r.id=t.getAttribute("id")||null,r.width=t.getAttribute("width"),r.height=t.getAttribute("height"),r.companionClickTrackingURLTemplates=[],n.parserUtils.childrenByName(t,"HTMLResource").forEach(function(e){r.type=e.getAttribute("creativeType")||"text/html",r.htmlResource=n.parserUtils.parseNodeText(e)}),n.parserUtils.childrenByName(t,"IFrameResource").forEach(function(e){r.type=e.getAttribute("creativeType")||0,r.iframeResource=n.parserUtils.parseNodeText(e)}),n.parserUtils.childrenByName(t,"StaticResource").forEach(function(e){r.type=e.getAttribute("creativeType")||0,n.parserUtils.childrenByName(t,"AltText").forEach(function(e){r.altText=n.parserUtils.parseNodeText(e)}),r.staticResource=n.parserUtils.parseNodeText(e)}),n.parserUtils.childrenByName(t,"TrackingEvents").forEach(function(e){n.parserUtils.childrenByName(e,"Tracking").forEach(function(e){var t=e.getAttribute("event"),i=n.parserUtils.parseNodeText(e);t&&i&&(null==r.trackingEvents[t]&&(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))})}),n.parserUtils.childrenByName(t,"CompanionClickTracking").forEach(function(e){r.companionClickTrackingURLTemplates.push(n.parserUtils.parseNodeText(e))}),r.companionClickThroughURLTemplate=n.parserUtils.parseNodeText(n.parserUtils.childByName(t,"CompanionClickThrough")),r.companionClickTrackingURLTemplate=n.parserUtils.parseNodeText(n.parserUtils.childByName(t,"CompanionClickTracking")),i.variations.push(r)}),i}}]),re),A=(r(ie,o),ie),T=(g(te,[{key:"parse",value:function(e,t){var n=this,r=void 0,o=new A(t);o.duration=this.parserUtils.parseDuration(this.parserUtils.parseNodeText(this.parserUtils.childByName(e,"Duration")));var i=e.getAttribute("skipoffset");if(null==i)o.skipDelay=null;else if("%"===i.charAt(i.length-1)&&-1!==o.duration){var a=parseInt(i,10);o.skipDelay=o.duration*(a/100)}else o.skipDelay=this.parserUtils.parseDuration(i);var s=this.parserUtils.childByName(e,"VideoClicks");s&&(o.videoClickThroughURLTemplate=this.parserUtils.parseNodeText(this.parserUtils.childByName(s,"ClickThrough")),this.parserUtils.childrenByName(s,"ClickTracking").forEach(function(e){o.videoClickTrackingURLTemplates.push(n.parserUtils.parseNodeText(e))}),this.parserUtils.childrenByName(s,"CustomClick").forEach(function(e){o.videoCustomClickURLTemplates.push(n.parserUtils.parseNodeText(e))}));var l=this.parserUtils.childByName(e,"AdParameters");l&&(o.adParameters=this.parserUtils.parseNodeText(l)),this.parserUtils.childrenByName(e,"TrackingEvents").forEach(function(e){n.parserUtils.childrenByName(e,"Tracking").forEach(function(e){var t=e.getAttribute("event"),i=n.parserUtils.parseNodeText(e);if(t&&i){if("progress"===t){if(!(r=e.getAttribute("offset")))return;t="%"===r.charAt(r.length-1)?"progress-"+r:"progress-"+Math.round(n.parserUtils.parseDuration(r))}null==o.trackingEvents[t]&&(o.trackingEvents[t]=[]),o.trackingEvents[t].push(i)}})}),this.parserUtils.childrenByName(e,"MediaFiles").forEach(function(e){n.parserUtils.childrenByName(e,"MediaFile").forEach(function(e){var t=new d;t.id=e.getAttribute("id"),t.fileURL=n.parserUtils.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.apiFramework=e.getAttribute("apiFramework"),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0);var i=e.getAttribute("scalable");i&&"string"==typeof i&&("true"===(i=i.toLowerCase())?t.scalable=!0:"false"===i&&(t.scalable=!1));var r=e.getAttribute("maintainAspectRatio");r&&"string"==typeof r&&("true"===(r=r.toLowerCase())?t.maintainAspectRatio=!0:"false"===r&&(t.maintainAspectRatio=!1)),o.mediaFiles.push(t)})});var u=this.parserUtils.childByName(e,"Icons");return u&&this.parserUtils.childrenByName(u,"Icon").forEach(function(e){var t=new c;t.program=e.getAttribute("program"),t.height=parseInt(e.getAttribute("height")||0),t.width=parseInt(e.getAttribute("width")||0),t.xPosition=n.parseXPosition(e.getAttribute("xPosition")),t.yPosition=n.parseYPosition(e.getAttribute("yPosition")),t.apiFramework=e.getAttribute("apiFramework"),t.offset=n.parserUtils.parseDuration(e.getAttribute("offset")),t.duration=n.parserUtils.parseDuration(e.getAttribute("duration")),n.parserUtils.childrenByName(e,"HTMLResource").forEach(function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=n.parserUtils.parseNodeText(e)}),n.parserUtils.childrenByName(e,"IFrameResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=n.parserUtils.parseNodeText(e)}),n.parserUtils.childrenByName(e,"StaticResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=n.parserUtils.parseNodeText(e)});var i=n.parserUtils.childByName(e,"IconClicks");i&&(t.iconClickThroughURLTemplate=n.parserUtils.parseNodeText(n.parserUtils.childByName(i,"IconClickThrough")),n.parserUtils.childrenByName(i,"IconClickTracking").forEach(function(e){t.iconClickTrackingURLTemplates.push(n.parserUtils.parseNodeText(e))})),t.iconViewTrackingURLTemplate=n.parserUtils.parseNodeText(n.parserUtils.childByName(e,"IconViewTracking")),o.icons.push(t)}),o}},{key:"parseXPosition",value:function(e){return-1!==["left","right"].indexOf(e)?e:parseInt(e||0)}},{key:"parseYPosition",value:function(e){return-1!==["top","bottom"].indexOf(e)?e:parseInt(e||0)}}]),te),k=(r(ee,o),ee),S=(g(J,[{key:"parse",value:function(e,t){var r=this,n=new k(t);return this.parserUtils.childrenByName(e,"TrackingEvents").forEach(function(e){var t=void 0,i=void 0;r.parserUtils.childrenByName(e,"Tracking").forEach(function(e){t=e.getAttribute("event"),i=r.parserUtils.parseNodeText(e),t&&i&&(null==n.trackingEvents[t]&&(n.trackingEvents[t]=[]),n.trackingEvents[t].push(i))})}),this.parserUtils.childrenByName(e,"NonLinear").forEach(function(e){var t=new h;t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=r.parserUtils.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=r.parserUtils.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=r.parserUtils.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),r.parserUtils.childrenByName(e,"HTMLResource").forEach(function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=r.parserUtils.parseNodeText(e)}),r.parserUtils.childrenByName(e,"IFrameResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=r.parserUtils.parseNodeText(e)}),r.parserUtils.childrenByName(e,"StaticResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=r.parserUtils.parseNodeText(e)});var i=r.parserUtils.childByName(e,"AdParameters");i&&(t.adParameters=r.parserUtils.parseNodeText(i)),t.nonlinearClickThroughURLTemplate=r.parserUtils.parseNodeText(r.parserUtils.childByName(e,"NonLinearClickThrough")),r.parserUtils.childrenByName(e,"NonLinearClickTracking").forEach(function(e){t.nonlinearClickTrackingURLTemplates.push(r.parserUtils.parseNodeText(e))}),n.variations.push(t)}),n}}]),J),C=(g(Z,[{key:"parse",value:function(e){var t=e.childNodes;for(var i in t){var r=t[i];if(-1!==["Wrapper","InLine"].indexOf(r.nodeName)){if(this.parserUtils.copyNodeAttribute("id",e,r),this.parserUtils.copyNodeAttribute("sequence",e,r),"Wrapper"===r.nodeName)return this.parseWrapper(r);if("InLine"===r.nodeName)return this.parseInLine(r)}}}},{key:"parseInLine",value:function(e){var s=this,t=e.childNodes,l=new n;for(var i in l.id=e.getAttribute("id")||null,l.sequence=e.getAttribute("sequence")||null,t){var r=t[i];switch(r.nodeName){case"Error":l.errorURLTemplates.push(this.parserUtils.parseNodeText(r));break;case"Impression":l.impressionURLTemplates.push(this.parserUtils.parseNodeText(r));break;case"Creatives":this.parserUtils.childrenByName(r,"Creative").forEach(function(e){var t={id:e.getAttribute("id")||null,adId:s.parseCreativeAdIdAttribute(e),sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null};for(var i in e.childNodes){var r=e.childNodes[i];switch(r.nodeName){case"Linear":var n=s.creativeLinearParser.parse(r,t);n&&l.creatives.push(n);break;case"NonLinearAds":var o=s.creativeNonLinearParser.parse(r,t);o&&l.creatives.push(o);break;case"CompanionAds":var a=s.creativeCompanionParser.parse(r,t);a&&l.creatives.push(a)}}});break;case"Extensions":this.parseExtensions(l.extensions,this.parserUtils.childrenByName(r,"Extension"));break;case"AdSystem":l.system={value:this.parserUtils.parseNodeText(r),version:r.getAttribute("version")||null};break;case"AdTitle":l.title=this.parserUtils.parseNodeText(r);break;case"Description":l.description=this.parserUtils.parseNodeText(r);break;case"Advertiser":l.advertiser=this.parserUtils.parseNodeText(r);break;case"Pricing":l.pricing={value:this.parserUtils.parseNodeText(r),model:r.getAttribute("model")||null,currency:r.getAttribute("currency")||null};break;case"Survey":l.survey=this.parserUtils.parseNodeText(r)}}return l}},{key:"parseWrapper",value:function(e){var r=this.parseInLine(e),t=this.parserUtils.childByName(e,"VASTAdTagURI");if(t?r.nextWrapperURL=this.parserUtils.parseNodeText(t):(t=this.parserUtils.childByName(e,"VASTAdTagURL"))&&(r.nextWrapperURL=this.parserUtils.parseNodeText(this.parserUtils.childByName(t,"URL"))),r.creatives.forEach(function(i){if(-1!==["linear","nonlinear"].indexOf(i.type)){if(i.trackingEvents){r.trackingEvents||(r.trackingEvents={}),r.trackingEvents[i.type]||(r.trackingEvents[i.type]={});var e=function(t){var e=i.trackingEvents[t];r.trackingEvents[i.type][t]||(r.trackingEvents[i.type][t]=[]),e.forEach(function(e){r.trackingEvents[i.type][t].push(e)})};for(var t in i.trackingEvents)e(t)}i.videoClickTrackingURLTemplates&&(r.videoClickTrackingURLTemplates||(r.videoClickTrackingURLTemplates=[]),i.videoClickTrackingURLTemplates.forEach(function(e){r.videoClickTrackingURLTemplates.push(e)})),i.videoClickThroughURLTemplate&&(r.videoClickThroughURLTemplate=i.videoClickThroughURLTemplate),i.videoCustomClickURLTemplates&&(r.videoCustomClickURLTemplates||(r.videoCustomClickURLTemplates=[]),i.videoCustomClickURLTemplates.forEach(function(e){r.videoCustomClickURLTemplates.push(e)}))}}),r.nextWrapperURL)return r}},{key:"parseExtensions",value:function(f,e){var p=this;e.forEach(function(e){var t=new v,i=e.attributes,r=e.childNodes;if(e.attributes)for(var n in i){var o=i[n];o.nodeName&&o.nodeValue&&(t.attributes[o.nodeName]=o.nodeValue)}for(var a in r){var s=r[a],l=p.parserUtils.parseNodeText(s);if("#comment"!==s.nodeName&&""!==l){var u=new m;if(u.name=s.nodeName,u.value=l,s.attributes){var c=s.attributes;for(var d in c){var h=c[d];u.attributes[h.nodeName]=h.nodeValue}}t.children.push(u)}}f.push(t)})}},{key:"parseCreativeAdIdAttribute",value:function(e){return e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null}}]),Z),I=(g($,[{key:"xdr",value:function(){var e=void 0;return window.XDomainRequest&&(e=new XDomainRequest),e}},{key:"supported",value:function(){return!!this.xdr()}},{key:"get",value:function(e,t,i){var r="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0;if(!r)return i(new Error("FlashURLHandler: Microsoft.XMLDOM format not supported"));r.async=!1;var n=this.xdr();n.open("GET",e),n.timeout=t.timeout||0,n.withCredentials=t.withCredentials||!1,n.send(),n.onprogress=function(){},n.onload=function(){r.loadXML(n.responseText),i(null,r)}}}]),$),D=e("url"),R=e("fs"),x=e("http"),P=e("https"),O=e("xmldom").DOMParser,N=(g(Q,[{key:"get",value:function(e,i,r){var t,n="https:"===(e=D.parse(e)).protocol?P:x;if("file:"===e.protocol)R.readFile(e.pathname,"utf8",function(e,t){if(e)return r(e);var i=(new O).parseFromString(t);r(null,i)});else{var o=void 0,a="",s=n.get(e.href,function(e){e.on("data",function(e){var t=void 0;a+=e,clearTimeout(t),t=setTimeout(l,i.timeout||12e4)}),e.on("end",function(){clearTimeout(o);var e=(new O).parseFromString(a);r(null,e)})});s.on("error",function(e){clearTimeout(o),r(e)});var l=(t=s,function(){return t.abort()});o=setTimeout(l,i.timeout||12e4)}}}]),Q),L=(g(K,[{key:"xhr",value:function(){try{var e=new window.XMLHttpRequest;return"withCredentials"in e?e:null}catch(e){return console.log("Error in XHRURLHandler support check:",e),null}}},{key:"supported",value:function(){return!!this.xhr()}},{key:"get",value:function(e,t,i){if("https:"===window.location.protocol&&0===e.indexOf("http://"))return i(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{var r=this.xhr();r.open("GET",e),r.timeout=t.timeout||0,r.withCredentials=t.withCredentials||!1,r.overrideMimeType&&r.overrideMimeType("text/xml"),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?i(null,r.responseXML):i(new Error("XHRURLHandler: "+r.statusText)))},r.send()}catch(e){i(new Error("XHRURLHandler: Unexpected error"))}}}]),K),U=(g(Y,[{key:"get",value:function(e,t,i){return i||("function"==typeof t&&(i=t),t={}),t.urlhandler&&t.urlhandler.supported()?t.urlhandler.get(e,t,i):"undefined"==typeof window||null===window?this.node.get(e,t,i):this.xhr.supported()?this.xhr.get(e,t,i):this.flash.supported()?this.flash.get(e,t,i):i(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}}]),Y),M={ERRORCODE:900,extensions:[]},V=(p=y.EventEmitter,r(G,p),g(G,[{key:"addURLTemplateFilter",value:function(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}},{key:"removeURLTemplateFilter",value:function(){this.URLTemplateFilters.pop()}},{key:"countURLTemplateFilters",value:function(){return this.URLTemplateFilters.length}},{key:"clearURLTemplateFilters",value:function(){this.URLTemplateFilters=[]}},{key:"trackVastError",value:function(e,t){for(var i=arguments.length,r=Array(2<i?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];this.emit("VAST-error",Object.assign.apply(Object,[M,t].concat(r))),this.util.track(e,t)}},{key:"getErrorURLTemplates",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:"fetchVAST",value:function(n){var o=this;return new Promise(function(i,r){o.URLTemplateFilters.forEach(function(e){n=e(n)}),o.parentURLs.push(n),o.emit("VAST-resolving",{url:n}),o.urlHandler.get(n,o.fetchingOptions,function(e,t){o.emit("VAST-resolved",{url:n}),e?r(e):i(t)})})}},{key:"initParsingStatus",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.rootURL="",this.remainingAds=[],this.parentURLs=[],this.errorURLTemplates=[],this.rootErrorURLTemplates=[],this.maxWrapperDepth=e.wrapperLimit||10,this.fetchingOptions={timeout:e.timeout,withCredentials:e.withCredentials},this.urlHandler=e.urlhandler||new U}},{key:"getRemainingAds",value:function(r){var n=this;return new Promise(function(i,t){if(0===n.remainingAds.length)return t(new Error("No more ads are available for the given VAST"));var e=r?n.util.flatten(n.remainingAds):n.remainingAds.shift();n.errorURLTemplates=[],n.parentURLs=[],n.resolveAds(e,{wrapperDepth:0,originalUrl:n.rootURL}).then(function(e){var t=n.buildVASTResponse(e);i(t)}).catch(function(e){return t(e)})})}},{key:"getAndParseVAST",value:function(r){var n=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(o),this.rootURL=r,new Promise(function(i,t){n.fetchVAST(r).then(function(e){o.originalUrl=r,o.isRootVAST=!0,n.parse(e,o).then(function(e){var t=n.buildVASTResponse(e);i(t)}).catch(function(e){return t(e)})}).catch(function(e){return t(e)})})}},{key:"parseVAST",value:function(e){var r=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(n),new Promise(function(i,t){n.isRootVAST=!0,r.parse(e,n).then(function(e){var t=r.buildVASTResponse(e);i(t)}).catch(function(e){return t(e)})})}},{key:"buildVASTResponse",value:function(e){var t=new a;return t.ads=e,t.errorURLTemplates=this.getErrorURLTemplates(),this.completeWrapperResolving(t),t}},{key:"parse",value:function(c,e){var d=this,t=e.resolveAll,h=void 0===t||t,i=e.wrapperSequence,f=void 0===i?null:i,r=e.originalUrl,p=void 0===r?null:r,n=e.wrapperDepth,v=void 0===n?0:n,o=e.isRootVAST,m=void 0!==o&&o;return new Promise(function(t,i){if(!c||!c.documentElement||"VAST"!==c.documentElement.nodeName)return i(new Error("Invalid VAST XMLDocument"));var e=[],r=c.documentElement.childNodes;for(var n in r){var o=r[n];if("Error"===o.nodeName){var a=d.parserUtils.parseNodeText(o);m?d.rootErrorURLTemplates.push(a):d.errorURLTemplates.push(a)}if("Ad"===o.nodeName){var s=d.adParser.parse(o);s?e.push(s):d.trackVastError(d.getErrorURLTemplates(),{ERRORCODE:101})}}var l=e.length,u=e[l-1];1===l&&null!=f&&u&&!u.sequence&&(u.sequence=f),!1===h&&(d.remainingAds=d.parserUtils.splitVAST(e),e=d.remainingAds.shift()),d.resolveAds(e,{resolveAll:h,wrapperDepth:v,originalUrl:p}).then(function(e){return t(e)}).catch(function(e){return i(e)})})}},{key:"resolveAds",value:function(){var r=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],o=e.wrapperDepth,a=e.originalUrl;return new Promise(function(e,t){var i=[];n.forEach(function(e){var t=r.resolveWrappers(e,o,a);i.push(t)}),e(Promise.all(i).then(function(e){return r.util.flatten(e)}))}).then(function(e){if(!e&&0<r.remainingAds.length){var t=r.remainingAds.shift();return r.resolveAds(t,{wrapperDepth:o,originalUrl:a})}return e})}},{key:"resolveWrappers",value:function(n,o,a){var s=this;return new Promise(function(t,i){if(o++,!n.nextWrapperURL)return delete n.nextWrapperURL,t(n);if(o>=s.maxWrapperDepth||-1!==s.parentURLs.indexOf(n.nextWrapperURL))return n.errorCode=302,delete n.nextWrapperURL,t(n);n.nextWrapperURL=s.parserUtils.resolveVastAdTagURI(n.nextWrapperURL,a);var r=n.sequence;a=n.nextWrapperURL,s.fetchVAST(n.nextWrapperURL).then(function(e){s.parse(e,{originalUrl:a,wrapperSequence:r,wrapperDepth:o}).then(function(e){if(delete n.nextWrapperURL,0===e.length)return n.creatives=[],t(n);e.forEach(function(e){e&&s.mergeWrapperAdData(e,n)}),t(e)}).catch(function(e){n.errorCode=301,n.errorMessage=e.message,t(n)})}).catch(function(e){return i(e)})})}},{key:"completeWrapperResolving",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;0<=t;t--){var i=e.ads[t];!i.errorCode&&0!==i.creatives.length||(this.trackVastError(i.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:i.errorCode||303},{ERRORMESSAGE:i.errorMessage||""},{extensions:i.extensions},{system:i.system}),e.ads.splice(t,1))}}},{key:"mergeWrapperAdData",value:function(e,r){e.errorURLTemplates=r.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=r.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=r.extensions.concat(e.extensions),e.creatives.forEach(function(e){if(r.trackingEvents&&r.trackingEvents[e.type])for(var t in r.trackingEvents[e.type]){var i=r.trackingEvents[e.type][t];e.trackingEvents[t]||(e.trackingEvents[t]=[]),e.trackingEvents[t]=e.trackingEvents[t].concat(i)}}),r.videoClickTrackingURLTemplates&&r.videoClickTrackingURLTemplates.length&&e.creatives.forEach(function(e){"linear"===e.type&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(r.videoClickTrackingURLTemplates))}),r.videoCustomClickURLTemplates&&r.videoCustomClickURLTemplates.length&&e.creatives.forEach(function(e){"linear"===e.type&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(r.videoCustomClickURLTemplates))}),r.videoClickThroughURLTemplate&&e.creatives.forEach(function(e){"linear"===e.type&&null==e.videoClickThroughURLTemplate&&(e.videoClickThroughURLTemplate=r.videoClickThroughURLTemplate)})}}]),G),j=null,B={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},F=(g(X,[{key:"initStorage",value:function(){if(j)return j;try{j="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){j=null}return j&&!this.isStorageDisabled(j)||(j=B).clear(),j}},{key:"isStorageDisabled",value:function(e){var t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),X),W=(g(z,[{key:"getParser",value:function(){return this.vastParser}},{key:"hasRemainingAds",value:function(){return 0<this.vastParser.remainingAds.length}},{key:"getNextAds",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:"get",value:function(r){var n=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=Date.now();return(o=Object.assign(this.defaultOptions,o)).hasOwnProperty("resolveAll")||(o.resolveAll=!1),this.totalCallsTimeout<a?(this.totalCalls=1,this.totalCallsTimeout=a+36e5):this.totalCalls++,new Promise(function(t,i){if(n.cappingFreeLunch>=n.totalCalls)return i(new Error("VAST call canceled – FreeLunch capping not reached yet "+n.totalCalls+"/"+n.cappingFreeLunch));var e=a-n.lastSuccessfulAd;if(e<0)n.lastSuccessfulAd=0;else if(e<n.cappingMinimumTimeInterval)return i(new Error("VAST call canceled – ("+n.cappingMinimumTimeInterval+")ms minimum interval reached"));n.vastParser.getAndParseVAST(r,o).then(function(e){return t(e)}).catch(function(e){return i(e)})})}},{key:"lastSuccessfulAd",get:function(){return this.storage.getItem("vast-client-last-successful-ad")},set:function(e){this.storage.setItem("vast-client-last-successful-ad",e)}},{key:"totalCalls",get:function(){return this.storage.getItem("vast-client-total-calls")},set:function(e){this.storage.setItem("vast-client-total-calls",e)}},{key:"totalCallsTimeout",get:function(){return this.storage.getItem("vast-client-total-calls-timeout")},set:function(e){this.storage.setItem("vast-client-total-calls-timeout",e)}}]),z),q=(f=y.EventEmitter,r(H,f),g(H,[{key:"setDuration",value:function(e){this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}}},{key:"setProgress",value:function(e){var t=this,i=this.skipDelay||this.skipDelayDefault;if(-1===i||this.skippable||(e<i?this.emit("skip-countdown",i-e):(this.skippable=!0,this.emit("skip-countdown",0))),this.linear&&0<this.assetDuration){var r=[];if(0<e){var n=Math.round(e/this.assetDuration*100);for(var o in r.push("start"),r.push("progress-"+n+"%"),r.push("progress-"+Math.round(e)),this.quartiles)this.isQuartileReached(o,this.quartiles[o],e)&&(r.push(o),this._alreadyTriggeredQuartiles[o]=!0)}r.forEach(function(e){t.track(e,!0)}),e<this.progress&&this.track("rewind")}this.progress=e}},{key:"isQuartileReached",value:function(e,t,i){var r=!1;return t<=i&&!this._alreadyTriggeredQuartiles[e]&&(r=!0),r}},{key:"setMuted",value:function(e){this.muted!==e&&this.track(e?"mute":"unmute"),this.muted=e}},{key:"setPaused",value:function(e){this.paused!==e&&this.track(e?"pause":"resume"),this.paused=e}},{key:"setFullscreen",value:function(e){this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen"),this.fullscreen=e}},{key:"setExpand",value:function(e){this.expanded!==e&&this.track(e?"expand":"collapse"),this.expanded=e}},{key:"setSkipDelay",value:function(e){"number"==typeof e&&(this.skipDelay=e)}},{key:"trackImpression",value:function(){this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView"))}},{key:"errorWithCode",value:function(e){this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:e})}},{key:"complete",value:function(){this.track("complete")}},{key:"close",value:function(){this.track(this.linear?"closeLinear":"close")}},{key:"skip",value:function(){this.track("skip"),this.trackingEvents=[]}},{key:"click",value:function(){if(this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates),this.clickThroughURLTemplate){var e=this.linear?{CONTENTPLAYHEAD:this.progressFormatted()}:{},t=this.util.resolveURLTemplates([this.clickThroughURLTemplate],e)[0];this.emit("clickthrough",t)}}},{key:"track",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close");var i=this.trackingEvents[e],r=-1<this.emitAlwaysEvents.indexOf(e);i?(this.emit(e,""),this.trackURLs(i)):r&&this.emit(e,""),t&&(delete this.trackingEvents[e],r&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}},{key:"trackURLs",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(t.ASSETURI=this.creative.mediaFiles[0].fileURL),t.CONTENTPLAYHEAD=this.progressFormatted()),this.util.track(e,t)}},{key:"progressFormatted",value:function(){var e=parseInt(this.progress),t=e/3600;t.length<2&&(t="0"+t);var i=e/60%60;i.length<2&&(i="0"+i);var r=e%60;return r.length<2&&(r="0"+i),t+":"+i+":"+r+"."+parseInt(100*(this.progress-e))}}]),H);function H(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;s(this,H);var n=l(this,(H.__proto__||Object.getPrototypeOf(H)).call(this));for(var o in n.ad=t,n.creative=i,n.variation=r,n.util=new b,n.muted=!1,n.impressed=!1,n.skippable=!1,n.skipDelayDefault=-1,n.trackingEvents={},n.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],n._alreadyTriggeredQuartiles={},n.creative.trackingEvents){var a=n.creative.trackingEvents[o];n.trackingEvents[o]=a.slice(0)}return n.creative instanceof A?(n.setDuration(n.creative.duration),n.skipDelay=n.creative.skipDelay,n.linear=!0,n.clickThroughURLTemplate=n.creative.videoClickThroughURLTemplate,n.clickTrackingURLTemplates=n.creative.videoClickTrackingURLTemplates):(n.skipDelay=-1,n.linear=!1,n.variation&&(n.variation instanceof h?(n.clickThroughURLTemplate=n.variation.nonlinearClickThroughURLTemplate,n.clickTrackingURLTemplates=n.variation.nonlinearClickTrackingURLTemplates):n.variation instanceof u&&(n.clickThroughURLTemplate=n.variation.companionClickThroughURLTemplate,n.clickTrackingURLTemplates=n.variation.companionClickTrackingURLTemplates))),e&&n.on("start",function(){e.lastSuccessfulAd=Date.now()}),n}function z(e,t,i){s(this,z),this.cappingFreeLunch=e||0,this.cappingMinimumTimeInterval=t||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new V,this.util=new b,this.storage=i||new F,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}function X(){s(this,X),this.storage=this.initStorage()}function G(){s(this,G);var e=l(this,(G.__proto__||Object.getPrototypeOf(G)).call(this));return e.remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parserUtils=new w,e.adParser=new C,e.util=new b,e}function Y(){s(this,Y),this.flash=new I,this.node=new N,this.xhr=new L}function K(){s(this,K)}function Q(){s(this,Q)}function $(){s(this,$)}function Z(){s(this,Z),this.creativeCompanionParser=new E,this.creativeNonLinearParser=new S,this.creativeLinearParser=new T,this.parserUtils=new w}function J(){s(this,J),this.parserUtils=new w}function ee(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};s(this,ee);var t=l(this,(ee.__proto__||Object.getPrototypeOf(ee)).call(this,e));return t.type="nonlinear",t.variations=[],t}function te(){s(this,te),this.parserUtils=new w}function ie(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};s(this,ie);var t=l(this,(ie.__proto__||Object.getPrototypeOf(ie)).call(this,e));return t.type="linear",t.duration=0,t.skipDelay=null,t.mediaFiles=[],t.videoClickThroughURLTemplate=null,t.videoClickTrackingURLTemplates=[],t.videoCustomClickURLTemplates=[],t.adParameters=null,t.icons=[],t}function re(){s(this,re),this.parserUtils=new w}function ne(){s(this,ne),this.util=new b}function oe(){s(this,oe)}function ae(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};s(this,ae);var t=l(this,(ae.__proto__||Object.getPrototypeOf(ae)).call(this,e));return t.type="companion",t.variations=[],t}function se(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i.VASTClient=W,i.VASTParser=V,i.VASTTracker=q},{events:4,fs:3,http:6,https:28,url:37,xmldom:46}],41:[function(e,t,i){"use strict";var r=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("tiny-emitter"),a=e("./vpaid-methods"),s=e("./video-tracker"),l=e("./util/is-supported");function u(){this._destroyed=!0,this._videoSlot.src="",this._slot.innerHTML="",this._ui=null}var c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,o),r(d,[{key:"set",value:function(e,t){this.previousAttributes[e]=this._attributes[e],this._attributes[e]=t}},{key:"handshakeVersion",value:function(){return"2.0"}},{key:"appendStylesheet",value:function(e){var t=document.getElementsByTagName("head")[0],i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=this.baseUrl+e,i.media="all",t.appendChild(i)}},{key:"initAd",value:function(e,t,i,r,n,o){var a=this;this._attributes.width=e,this._attributes.height=t,this._attributes.viewMode=i,this._attributes.desiredBitrate=r,this._slot=o.slot||this.emit("AdError","Video slot is invalid"),this._videoSlot=o.videoSlot||this.emit("AdError","Slot is invalid"),this.useBestVideo().then(function(){a.emit("AdLoaded")}).catch(function(e){a.emit("AdLog",e),a.emit("AdLoaded")}),this.videoTracker=new s(this._videoSlot,this)}},{key:"useBestVideo",value:function(){var r=this;return new Promise(function(e,t){var i=r.opts.videos.filter(function(e){return l(e.type)});i[0]?r.setVideoSource(i[0].url,i[0].type).then(e).catch(t):t(new Error("no supported video found"))})}},{key:"setVideoSource",value:function(r,n){var t=this;return new Promise(function(e,i){void 0===t._videoSlot.onloadeddata?e():t._videoSlot.onloadeddata=e,t._videoSlot.onerror=function(e){var t=void 0;switch(e.target.error.code){case e.target.error.MEDIA_ERR_ABORTED:t="You aborted the video playback.";break;case e.target.error.MEDIA_ERR_NETWORK:t="A network error caused the video download to fail part-way.";break;case e.target.error.MEDIA_ERR_DECODE:t="The video playback was aborted due to a corruption problem or because the video used features your browser did not support.";break;case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:t="The video could not be loaded, either because the server or network failed or because the format is not supported.";break;default:t="An unknown error occurred."}i(new Error(t+" Type: "+n+", source: "+r))},t._videoSlot.src=r,t._videoSlot.type=n})}},{key:"startAd",value:function(){var e=this;void 0===this._videoSlot.onloadeddata?this.emit("AdStarted"):this._videoSlot.onloadeddata=function(){e.emit("AdStarted")},this._videoSlot.load()}},{key:"stopAd",value:function(){this._destroyed||(u.call(this),this.emit("AdStopped"))}},{key:"skipAd",value:function(){if(!this._destroyed){if(!this._attributes.adSkippableState)return!1;u.call(this),this.emit("AdSkipped"),this.emit("AdStopped")}}},{key:"resizeAd",value:function(e,t,i){this._attributes.width=e,this._attributes.height=t,this._attributes.viewMode=i,this.emit("AdSizeChange")}},{key:"pauseAd",value:function(){this._videoSlot.pause(),this.emit("AdPaused")}},{key:"clickThru",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.emit("AdClickThru",t.url,t.id,t.playerHandles)}},{key:"resumeAd",value:function(){this._videoSlot.play(),this.emit("AdPlaying")}},{key:"expandAd",value:function(){this.hasEngaged=!0,this.set("expanded",!0),this.emit("AdExpandedChange")}},{key:"collapseAd",value:function(){this.set("expanded",!1),this.emit("AdExpandedChange")}},{key:"subscribe",value:function(e,t,i){this.on(t,e,i)}},{key:"unsubscribe",value:function(e,t){this.off(t,e)}},{key:"getAdLinear",value:function(){return this._attributes.linear}},{key:"getAdWidth",value:function(){return this._attributes.width}},{key:"getAdHeight",value:function(){return this._attributes.height}},{key:"getAdExpanded",value:function(){return this._attributes.expanded}},{key:"getAdSkippableState",value:function(){return this._attributes.adSkippableState}},{key:"getAdRemainingTime",value:function(){return this.hasEngaged?-2:this._videoSlot.duration-this._videoSlot.currentTime}},{key:"getAdDuration",value:function(){return this.hasEngaged?-2:this._videoSlot.duration}},{key:"getAdVolume",value:function(){return this._attributes.volume}},{key:"getAdCompanions",value:function(){return this._attributes.companions}},{key:"getAdIcons",value:function(){return this._attributes.icons}},{key:"setAdVolume",value:function(e){if(this.previousAttributes.volume!==e){if(e<0||1<e)return this.emit("AdError","volume is not valid");this.set("volume",e),this._videoSlot.volume=e,this.emit("AdVolumeChange")}}},{key:"emitVpaidMethodInvocations",value:function(){var o=this;a.forEach(function(r){var n=o[r];o[r]=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return o.emit.apply(o,[r+"()"].concat(t)),n.apply(o,t)}},this)}}]),d);function d(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));return t.baseUrl="",t.emitVpaidMethodInvocations(),t._ui={},t.quartileIndexEmitted=-1,t.hasEngaged=!1,t._attributes={companions:"",desiredBitrate:256,duration:30,remainingTime:-1,expanded:!1,icons:!1,linear:!0,adSkippableState:!1,viewMode:"normal",width:0,height:0,volume:1},t.previousAttributes=Object.assign({},t._attributes),t.opts=e,t.opts.videos=t.opts.videos||[],t}t.exports=c},{"./util/is-supported":42,"./video-tracker":43,"./vpaid-methods":45,"tiny-emitter":36}],42:[function(e,t,i){"use strict";var r=void 0;t.exports=function(e){return!!(r=r||document.createElement("video")).canPlayType(e).replace(/no/,"")}},{}],43:[function(e,t,i){"use strict";var r=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("./vpaid-life-cycle"),a=[{value:0,name:o[0]},{value:.25,name:o[1]},{value:.5,name:o[2]},{value:.75,name:o[3]}];var s=(r(l,[{key:"emit",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=this.prefix+t[0];return this.emitter.emit.apply(this.emitter,[r].concat(t.splice(1)))}},{key:"addEventListeners",value:function(){this.events={handleTimeupdate:function(){var e=this.quartileIndexEmitted+1,t=a[e];t&&this.el.currentTime/this.el.duration>t.value&&(this.quartileIndexEmitted=e,this.emit(t.name))}.bind(this),handleEnded:function(){this.emit(o[4]),this.removeEventListeners()}.bind(this)},this.el.addEventListener("timeupdate",this.events.handleTimeupdate),this.el.addEventListener("ended",this.events.handleEnded)}},{key:"removeEventListeners",value:function(){this.el.removeEventListener("timeupdate",this.events.handleTimeupdate),this.el.removeEventListener("ended",this.events.handleEnded)}}]),l);function l(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"AdVideo";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.el=e,this.emitter=t,this.prefix=i,this.quartileIndexEmitted=-1,this.addEventListeners()}t.exports=s},{"./vpaid-life-cycle":44}],44:[function(e,t,i){"use strict";t.exports=["Start","FirstQuartile","Midpoint","ThirdQuartile","Complete"]},{}],45:[function(e,t,i){"use strict";t.exports=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdadSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons","setAdVolume"]},{}],46:[function(e,t,i){function r(e){this.options=e||{locator:{}}}function u(){this.cdata=!1}function c(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function d(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function n(e,t,i){return"string"==typeof e?e.substr(t,i):e.length>=t+i||t?new java.lang.String(e,t,i)+"":e}function h(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var i=this.options,r=new f,n=i.domBuilder||new u,o=i.errorHandler,a=i.locator,s=i.xmlns||{},l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return a&&n.setDocumentLocator(a),r.errorHandler=function(r,e,n){if(!r){if(e instanceof u)return e;r=e}var o={},a=r instanceof Function;function t(t){var i=r[t];!i&&a&&(i=2==r.length?function(e){r(t,e)}:r),o[t]=i?function(e){i("[xmldom "+t+"]\t"+e+d(n))}:function(){}}return n=n||{},t("warning"),t("error"),t("fatalError"),o}(o,n,a),r.domBuilder=i.domBuilder||n,/\/x?html?$/.test(t)&&(l.nbsp=" ",l.copy="©",s[""]="http://www.w3.org/1999/xhtml"),s.xml=s.xml||"http://www.w3.org/XML/1998/namespace",e?r.parse(e,s,l):r.errorHandler.error("invalid doc source"),n.doc},u.prototype={startDocument:function(){this.doc=(new o).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,i,r){var n=this.doc,o=n.createElementNS(e,i||t),a=r.length;h(this,o),this.currentElement=o,this.locator&&c(this.locator,o);for(var s=0;s<a;s++){e=r.getURI(s);var l=r.getValue(s),u=(i=r.getQName(s),n.createAttributeNS(e,i));this.locator&&c(r.getLocator(s),u),u.value=u.nodeValue=l,o.setAttributeNode(u)}},endElement:function(e,t,i){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var i=this.doc.createProcessingInstruction(e,t);this.locator&&c(this.locator,i),h(this,i)},ignorableWhitespace:function(e,t,i){},characters:function(e,t,i){if(e=n.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&c(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,i){e=n.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&c(this.locator,r),h(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,i){var r=this.doc.implementation;if(r&&r.createDocumentType){var n=r.createDocumentType(e,t,i);this.locator&&c(this.locator,n),h(this,n)}},warning:function(e){console.warn("[xmldom warning]\t"+e,d(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,d(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,d(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){u.prototype[e]=function(){return null}});var f=e("./sax").XMLReader,o=i.DOMImplementation=e("./dom").DOMImplementation;i.XMLSerializer=e("./dom").XMLSerializer,i.DOMParser=r},{"./dom":47,"./sax":48}],47:[function(e,t,i){function o(e,t){for(var i in e)t[i]=e[i]}function r(e,t){var i=e.prototype;if(Object.create){var r=Object.create(t.prototype);i.__proto__=r}if(!(i instanceof t)){function n(){}n.prototype=t.prototype,o(i,n=new n),e.prototype=i=n}i.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),i.constructor=e)}var y="http://www.w3.org/1999/xhtml",n={},g=n.ELEMENT_NODE=1,_=n.ATTRIBUTE_NODE=2,b=n.TEXT_NODE=3,w=n.CDATA_SECTION_NODE=4,E=n.ENTITY_REFERENCE_NODE=5,a=n.ENTITY_NODE=6,A=n.PROCESSING_INSTRUCTION_NODE=7,T=n.COMMENT_NODE=8,k=n.DOCUMENT_NODE=9,S=n.DOCUMENT_TYPE_NODE=10,C=n.DOCUMENT_FRAGMENT_NODE=11,s=n.NOTATION_NODE=12,l={},u={},c=(l.INDEX_SIZE_ERR=(u[1]="Index size error",1),l.DOMSTRING_SIZE_ERR=(u[2]="DOMString size error",2),l.HIERARCHY_REQUEST_ERR=(u[3]="Hierarchy request error",3)),d=(l.WRONG_DOCUMENT_ERR=(u[4]="Wrong document",4),l.INVALID_CHARACTER_ERR=(u[5]="Invalid character",5),l.NO_DATA_ALLOWED_ERR=(u[6]="No data allowed",6),l.NO_MODIFICATION_ALLOWED_ERR=(u[7]="No modification allowed",7),l.NOT_FOUND_ERR=(u[8]="Not found",8)),h=(l.NOT_SUPPORTED_ERR=(u[9]="Not supported",9),l.INUSE_ATTRIBUTE_ERR=(u[10]="Attribute in use",10));l.INVALID_STATE_ERR=(u[11]="Invalid state",11),l.SYNTAX_ERR=(u[12]="Syntax error",12),l.INVALID_MODIFICATION_ERR=(u[13]="Invalid modification",13),l.NAMESPACE_ERR=(u[14]="Invalid namespace",14),l.INVALID_ACCESS_ERR=(u[15]="Invalid access",15);function f(e,t){if(t instanceof Error)var i=t;else i=this,Error.call(this,u[e]),this.message=u[e],Error.captureStackTrace&&Error.captureStackTrace(this,f);return i.code=e,t&&(this.message=this.message+": "+t),i}function p(){}function v(e,t){this._node=e,this._refresh=t,m(this)}function m(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var i=e._refresh(e._node);re(e,"length",i.length),o(i,e),e._inc=t}}function I(){}function D(e,t){for(var i=e.length;i--;)if(e[i]===t)return i}function R(e,t,i,r){if(r?t[D(t,r)]=i:t[t.length++]=i,e){var n=(i.ownerElement=e).ownerDocument;n&&(r&&M(n,e,r),a=e,s=i,(o=n)&&o._inc++,"http://www.w3.org/2000/xmlns/"==s.namespaceURI&&(a._nsMap[s.prefix?s.localName:""]=s.value))}var o,a,s}function x(e,t,i){var r=D(t,i);if(!(0<=r))throw f(d,new Error(e.tagName+"@"+i));for(var n=t.length-1;r<n;)t[r]=t[++r];if(t.length=n,e){var o=e.ownerDocument;o&&(M(o,e,i),i.ownerElement=null)}}function P(e){if(this._features={},e)for(var t in e)this._features=e[t]}function O(){}function N(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function L(e,t){if(t(e))return 1;if(e=e.firstChild)do{if(L(e,t))return 1}while(e=e.nextSibling)}function U(){}function M(e,t,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==i.namespaceURI&&delete t._nsMap[i.prefix?i.localName:""]}function V(e,t,i){if(e&&e._inc){e._inc++;var r=t.childNodes;if(i)r[r.length++]=i;else{for(var n=t.firstChild,o=0;n;)n=(r[o++]=n).nextSibling;r.length=o}}}function j(e,t){var i=t.previousSibling,r=t.nextSibling;return i?i.nextSibling=r:e.firstChild=r,r?r.previousSibling=i:e.lastChild=i,V(e.ownerDocument,e),t}function B(e,t,i){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===C){var n=t.firstChild;if(null==n)return t;var o=t.lastChild}else n=o=t;var a=i?i.previousSibling:e.lastChild;for(n.previousSibling=a,o.nextSibling=i,a?a.nextSibling=n:e.firstChild=n,null==i?e.lastChild=o:i.previousSibling=o;n.parentNode=e,n!==o&&(n=n.nextSibling););return V(e.ownerDocument||e,e),t.nodeType==C&&(t.firstChild=t.lastChild=null),t}function F(){this._nsMap={}}function W(){}function q(){}function H(){}function z(){}function X(){}function G(){}function Y(){}function K(){}function Q(){}function $(){}function Z(){}function J(){}function ee(e,t){var i=[],r=9==this.nodeType?this.documentElement:this,n=r.prefix,o=r.namespaceURI;if(o&&null==n&&null==(n=r.lookupPrefix(o)))var a=[{namespace:o,prefix:null}];return ie(this,i,e,t,a),i.join("")}function te(e,t,i){var r=e.prefix||"",n=e.namespaceURI;if((r||n)&&("xml"!==r||"http://www.w3.org/XML/1998/namespace"!==n)&&"http://www.w3.org/2000/xmlns/"!=n){for(var o=i.length;o--;){var a=i[o];if(a.prefix==r)return a.namespace!=n}return 1}}function ie(e,t,i,r,n){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case g:n=n||[];var o=e.attributes,a=o.length,s=e.firstChild,l=e.tagName;i=y===e.namespaceURI||i,t.push("<",l);for(var u=0;u<a;u++){"xmlns"==(c=o.item(u)).prefix?n.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&n.push({prefix:"",namespace:c.value})}for(u=0;u<a;u++){var c;if(te(c=o.item(u),0,n)){var d=c.prefix||"",h=c.namespaceURI,f=d?" xmlns:"+d:" xmlns";t.push(f,'="',h,'"'),n.push({prefix:d,namespace:h})}ie(c,t,i,r,n)}if(te(e,0,n)){d=e.prefix||"",h=e.namespaceURI,f=d?" xmlns:"+d:" xmlns";t.push(f,'="',h,'"'),n.push({prefix:d,namespace:h})}if(s||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(">"),i&&/^script$/i.test(l))for(;s;)s.data?t.push(s.data):ie(s,t,i,r,n),s=s.nextSibling;else for(;s;)ie(s,t,i,r,n),s=s.nextSibling;t.push("</",l,">")}else t.push("/>");return;case k:case C:for(s=e.firstChild;s;)ie(s,t,i,r,n),s=s.nextSibling;return;case _:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,N),'"');case b:return t.push(e.data.replace(/[<&]/g,N));case w:return t.push("<![CDATA[",e.data,"]]>");case T:return t.push("\x3c!--",e.data,"--\x3e");case S:var p=e.publicId,v=e.systemId;if(t.push("<!DOCTYPE ",e.name),p)t.push(' PUBLIC "',p),v&&"."!=v&&t.push('" "',v),t.push('">');else if(v&&"."!=v)t.push(' SYSTEM "',v,'">');else{var m=e.internalSubset;m&&t.push(" [",m,"]"),t.push(">")}return;case A:return t.push("<?",e.target," ",e.data,"?>");case E:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function re(e,t,i){e[t]=i}f.prototype=Error.prototype,o(l,f),p.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var i=[],r=0;r<this.length;r++)ie(this[r],i,e,t);return i.join("")}},v.prototype.item=function(e){return m(this),this[e]},r(v,p),I.prototype={length:0,item:p.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var i=this[t];if(i.nodeName==e)return i}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new f(h);var i=this.getNamedItem(e.nodeName);return R(this._ownerElement,this,e,i),i},setNamedItemNS:function(e){var t,i=e.ownerElement;if(i&&i!=this._ownerElement)throw new f(h);return t=this.getNamedItemNS(e.namespaceURI,e.localName),R(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return x(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var i=this.getNamedItemNS(e,t);return x(this._ownerElement,this,i),i},getNamedItemNS:function(e,t){for(var i=this.length;i--;){var r=this[i];if(r.localName==t&&r.namespaceURI==e)return r}return null}},P.prototype={hasFeature:function(e,t){var i=this._features[e.toLowerCase()];return!(!i||t&&!(t in i))},createDocument:function(e,t,i){var r=new U;if(r.implementation=this,r.childNodes=new p,(r.doctype=i)&&r.appendChild(i),t){var n=r.createElementNS(e,t);r.appendChild(n)}return r},createDocumentType:function(e,t,i){var r=new G;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=i,r}},O.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return B(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return j(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,i,r){var n=new i.constructor;for(var o in i){var a=i[o];"object"!=typeof a&&a!=n[o]&&(n[o]=a)}i.childNodes&&(n.childNodes=new p);n.ownerDocument=t;switch(n.nodeType){case g:var s=i.attributes,l=n.attributes=new I,u=s.length;l._ownerElement=n;for(var c=0;c<u;c++)n.setAttributeNode(e(t,s.item(c),!0));break;case _:r=!0}if(r)for(var d=i.firstChild;d;)n.appendChild(e(t,d,r)),d=d.nextSibling;return n}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==b&&e.nodeType==b?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var i=t._nsMap;if(i)for(var r in i)if(i[r]==e)return r;t=t.nodeType==_?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var i=t._nsMap;if(i&&e in i)return i[e];t=t.nodeType==_?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},o(n,O),o(n,O.prototype),U.prototype={nodeName:"#document",nodeType:k,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType!=C)return null==this.documentElement&&e.nodeType==g&&(this.documentElement=e),B(this,e,t),e.ownerDocument=this,e;for(var i=e.firstChild;i;){var r=i.nextSibling;this.insertBefore(i,t),i=r}return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),j(this,e)},importNode:function(e,t){return function e(t,i,r){var n;switch(i.nodeType){case g:(n=i.cloneNode(!1)).ownerDocument=t;case C:break;case _:r=!0}n=n||i.cloneNode(!1);n.ownerDocument=t;n.parentNode=null;if(r)for(var o=i.firstChild;o;)n.appendChild(e(t,o,r)),o=o.nextSibling;return n}(this,e,t)},getElementById:function(t){var i=null;return L(this.documentElement,function(e){if(e.nodeType==g&&e.getAttribute("id")==t)return i=e,!0}),i},createElement:function(e){var t=new F;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new p,(t.attributes=new I)._ownerElement=t},createDocumentFragment:function(){var e=new $;return e.ownerDocument=this,e.childNodes=new p,e},createTextNode:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new z;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new X;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var i=new Z;return i.ownerDocument=this,i.tagName=i.target=e,i.nodeValue=i.data=t,i},createAttribute:function(e){var t=new W;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new Q;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var i=new F,r=t.split(":"),n=i.attributes=new I;return i.childNodes=new p,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=e,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,n._ownerElement=i},createAttributeNS:function(e,t){var i=new W,r=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=e,i.specified=!0,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,i}},r(U,O),U.prototype.getElementsByTagName=(F.prototype={nodeType:g,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var i=this.ownerDocument.createAttribute(e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===C?this.insertBefore(e,null):function(e,t){var i=t.parentNode;if(i){var r=e.lastChild;i.removeChild(t);r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,V(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);i&&this.removeAttributeNode(i)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);return i&&i.value||""},setAttributeNS:function(e,t,i){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+i,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(r){return new v(this,function(t){var i=[];return L(t,function(e){e===t||e.nodeType!=g||"*"!==r&&e.tagName!=r||i.push(e)}),i})},getElementsByTagNameNS:function(r,n){return new v(this,function(t){var i=[];return L(t,function(e){e===t||e.nodeType!==g||"*"!==r&&e.namespaceURI!==r||"*"!==n&&e.localName!=n||i.push(e)}),i})}}).getElementsByTagName,U.prototype.getElementsByTagNameNS=F.prototype.getElementsByTagNameNS,r(F,O),W.prototype.nodeType=_,r(W,O),q.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(u[c])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,i){i=this.data.substring(0,e)+i+this.data.substring(e+t),this.nodeValue=this.data=i,this.length=i.length}},r(q,O),H.prototype={nodeName:"#text",nodeType:b,splitText:function(e){var t=this.data,i=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(i);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(H,q),z.prototype={nodeName:"#comment",nodeType:T},r(z,q),X.prototype={nodeName:"#cdata-section",nodeType:w},r(X,q),G.prototype.nodeType=S,r(G,O),Y.prototype.nodeType=s,r(Y,O),K.prototype.nodeType=a,r(K,O),Q.prototype.nodeType=E,r(Q,O),$.prototype.nodeName="#document-fragment",$.prototype.nodeType=C,r($,O),Z.prototype.nodeType=A,r(Z,O),J.prototype.serializeToString=function(e,t,i){return ee.call(e,t,i)},O.prototype.toString=ee;try{if(Object.defineProperty){Object.defineProperty(v.prototype,"length",{get:function(){return m(this),this.$$length}}),Object.defineProperty(O.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case g:case C:var i=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&i.push(e(t)),t=t.nextSibling;return i.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case g:case C:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),re=function(e,t,i){e["$$"+t]=i}}}catch(e){}i.DOMImplementation=P,i.XMLSerializer=J},{}],48:[function(e,t,i){var r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=new RegExp("^"+r.source+n.source+"*(?::"+r.source+n.source+"*)?$"),d=0,h=1,f=2,p=3,v=4,m=5,y=6,g=7;function a(){}function R(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function x(e,t,i,r,n,o){for(var a,s=++t,l=d;;){var u=e.charAt(s);switch(u){case"=":if(l===h)a=e.slice(t,s),l=p;else{if(l!==f)throw new Error("attribute equal must after attrName");l=p}break;case"'":case'"':if(l===p||l===h){if(l===h&&(o.warning('attribute value must after "="'),a=e.slice(t,s)),t=s+1,!(0<(s=e.indexOf(u,t))))throw new Error("attribute value no end '"+u+"' match");c=e.slice(t,s).replace(/&#?\w+;/g,n),i.add(a,c,t-1),l=m}else{if(l!=v)throw new Error('attribute value must after "="');c=e.slice(t,s).replace(/&#?\w+;/g,n),i.add(a,c,t),o.warning('attribute "'+a+'" missed start quot('+u+")!!"),t=s+1,l=m}break;case"/":switch(l){case d:i.setTagName(e.slice(t,s));case m:case y:case g:l=g,i.closed=!0;case v:case h:case f:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),l==d&&i.setTagName(e.slice(t,s)),s;case">":switch(l){case d:i.setTagName(e.slice(t,s));case m:case y:case g:break;case v:case h:"/"===(c=e.slice(t,s)).slice(-1)&&(i.closed=!0,c=c.slice(0,-1));case f:l===f&&(c=a),l==v?(o.warning('attribute "'+c+'" missed quot(")!!'),i.add(a,c.replace(/&#?\w+;/g,n),t)):("http://www.w3.org/1999/xhtml"===r[""]&&c.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),i.add(c,c,t));break;case p:throw new Error("attribute value missed!!")}return s;case"":u=" ";default:if(u<=" ")switch(l){case d:i.setTagName(e.slice(t,s)),l=y;break;case h:a=e.slice(t,s),l=f;break;case v:var c=e.slice(t,s).replace(/&#?\w+;/g,n);o.warning('attribute "'+c+'" missed quot(")!!'),i.add(a,c,t);case m:l=y}else switch(l){case f:i.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&a.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),i.add(a,a,t),t=s,l=h;break;case m:o.warning('attribute space is required"'+a+'"!!');case y:l=h,t=s;break;case p:l=v,t=s;break;case g:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function P(e,t,i){for(var r=e.tagName,n=null,o=e.length;o--;){var a=e[o],s=a.qName,l=a.value;if(0<(h=s.indexOf(":")))var u=a.prefix=s.slice(0,h),c=s.slice(h+1),d="xmlns"===u&&c;else u=null,d="xmlns"===(c=s)&&"";a.localName=c,!1!==d&&(null==n&&(n={},_(i,i={})),i[d]=n[d]=l,a.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,l))}for(o=e.length;o--;){(u=(a=e[o]).prefix)&&("xml"===u&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(a.uri=i[u||""]))}var h;c=0<(h=r.indexOf(":"))?(u=e.prefix=r.slice(0,h),e.localName=r.slice(h+1)):(u=null,e.localName=r);var f=e.uri=i[u||""];if(t.startElement(f,c,r,e),!e.closed)return e.currentNSMap=i,e.localNSMap=n,1;if(t.endElement(f,c,r),n)for(u in n)t.endPrefixMapping(u)}function O(e,t,i,r,n){if(/^(?:script|textarea)$/i.test(i)){var o=e.indexOf("</"+i+">",t),a=e.substring(t+1,o);if(/[&<]/.test(a))return/^script$/i.test(i)||(a=a.replace(/&#?\w+;/g,r)),n.characters(a,0,a.length),o}return t+1}function N(e,t,i,r){var n=r[i];return null==n&&((n=e.lastIndexOf("</"+i+">"))<t&&(n=e.lastIndexOf("</"+i)),r[i]=n),n<t}function _(e,t){for(var i in e)t[i]=e[i]}function L(e,t,i,r){switch(e.charAt(t+2)){case"-":return"-"!==e.charAt(t+3)?-1:t<(n=e.indexOf("--\x3e",t+4))?(i.comment(e,t+4,n-t-4),n+3):(r.error("Unclosed comment"),-1);default:if("CDATA["==e.substr(t+3,6)){var n=e.indexOf("]]>",t+9);return i.startCDATA(),i.characters(e,t+9,n-t-9),i.endCDATA(),n+3}var o=function(e,t){var i,r=[],n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;n.lastIndex=t,n.exec(e);for(;i=n.exec(e);)if(r.push(i),i[1])return r}(e,t),a=o.length;if(1<a&&/!doctype/i.test(o[0][0])){var s=o[1][0],l=3<a&&/^public$/i.test(o[2][0])&&o[3][0],u=4<a&&o[4][0],c=o[a-1];return i.startDTD(s,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2")),i.endDTD(),c.index+c[0].length}}return-1}function U(e,t,i){var r=e.indexOf("?>",t);if(r){var n=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(n){n[0].length;return i.processingInstruction(n[1],n[2]),r+2}return-1}return-1}function M(e){}function s(e,t){return e.__proto__=t,e}a.prototype={parse:function(e,t,i){var r=this.domBuilder;r.startDocument(),_(t,t={}),function(i,e,r,n,o){function a(e){var t=e.slice(1,-1);return t in r?r[t]:"#"===t.charAt(0)?function(e){if(65535<e){var t=55296+((e-=65536)>>10),i=56320+(1023&e);return String.fromCharCode(t,i)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function t(e){if(p<e){var t=i.substring(p,e).replace(/&#?\w+;/g,a);d&&s(p),n.characters(t,0,e-p),p=e}}function s(e,t){for(;u<=e&&(t=c.exec(i));)l=t.index,u=l+t[0].length,d.lineNumber++;d.columnNumber=e-l+1}var l=0,u=0,c=/.*(?:\r\n?|\n)|.*$/g,d=n.locator,h=[{currentNSMap:e}],f={},p=0;for(;;){try{var v=i.indexOf("<",p);if(v<0){if(!i.substr(p).match(/^\s*$/)){var m=n.doc,y=m.createTextNode(i.substr(p));m.appendChild(y),n.currentElement=y}return}switch(p<v&&t(v),i.charAt(v+1)){case"/":var g=i.indexOf(">",v+3),_=i.substring(v+2,g),b=h.pop();g<0?(_=i.substring(v+2).replace(/[\s<].*/,""),o.error("end tag name: "+_+" is not complete:"+b.tagName),g=v+1+_.length):_.match(/\s</)&&(_=_.replace(/[\s<].*/,""),o.error("end tag name: "+_+" maybe not complete"),g=v+1+_.length);var w=b.localNSMap,E=b.tagName==_;if(E||b.tagName&&b.tagName.toLowerCase()==_.toLowerCase()){if(n.endElement(b.uri,b.localName,_),w)for(var A in w)n.endPrefixMapping(A);E||o.fatalError("end tag name: "+_+" is not match the current start tagName:"+b.tagName)}else h.push(b);g++;break;case"?":d&&s(v),g=U(i,v,n);break;case"!":d&&s(v),g=L(i,v,n,o);break;default:d&&s(v);var T=new M,k=h[h.length-1].currentNSMap,S=(g=x(i,v,T,k,a,o),T.length);if(!T.closed&&N(i,g,T.tagName,f)&&(T.closed=!0,r.nbsp||o.warning("unclosed xml attribute")),d&&S){for(var C=R(d,{}),I=0;I<S;I++){var D=T[I];s(D.offset),D.locator=R(d,{})}n.locator=C,P(T,n,k)&&h.push(T),n.locator=d}else P(T,n,k)&&h.push(T);"http://www.w3.org/1999/xhtml"!==T.uri||T.closed?g++:g=O(i,g,T.tagName,a,n)}}catch(e){o.error("element parse error: "+e),g=-1}p<g?p=g:t(Math.max(v,p)+1)}}(e,t,i,r,this.errorHandler),r.endDocument()}},M.prototype={setTagName:function(e){if(!o.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,i){if(!o.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:i}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},s({},s.prototype)instanceof s||(s=function(e,t){function i(){}for(t in i.prototype=t,i=new i,e)i[t]=e[t];return i}),i.XMLReader=a},{}],49:[function(e,t,i){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var r in i)n.call(i,r)&&(e[r]=i[r])}return e};var n=Object.prototype.hasOwnProperty},{}],50:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("./util/IEPolyfill");var n=r(e("vpaid-ad/lib/linear")),d=r(e("./ad/adObject")),c=r(e("./ad/modes")),h=r(e("./util/HTMLElement")),a=r(e("./util/URLUtil")),o=r(e("./util/VideoUtil")),f=r(e("./util/OverrideVastClient")),p=e("vast-client"),s=r(e("./ad/provisionTrackingEvents")),v=r(e("./ad/Viewability")),l=r(e("./ad/vpaidEvents")),u=r(e("./ad/vastEvents")),m=r(e("./util/createVastWrapperAd")),y=r(e("./ad/TV")),g=r(e("./ad/Extensions")),_=r(e("./util/Dependencies"));function r(e){return e&&e.__esModule?e:{default:e}}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function T(e,t,i){return(T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=e("../version.json"),I=function(){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,k(t).apply(this,arguments))}var e,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,n.default),e=t,(i=[{key:"initAd",value:function(e,t,i,r,n,o){var a,s=this;console.log("RML ".concat(C.version," (").concat(C.shasum,")")),this._vastClient=new p.VASTClient,this._vastParser=new p.VASTParser,this._mode=c.default.MODE_UNKNOWN,this._script=h.default.getScript("rml"),this._slot=o.slot,this._videoSlot=o.videoSlot,this._overrideVastClient=new f.default,this._ui={},_.default.setHost(this._script);var l=h.default.getAdDataInfo(this._script);if(l.adData||this._destroyWithError("The 'adData' parameter is not implemented. There is no VAST URL."),a=0<l.adData.split(/\?|%3F/i)[0].indexOf("videohub.tv")?decodeURIComponent(l.adData):l.adData,Object.prototype.hasOwnProperty.call(l,"dspWinPrice")&&(d.default.macros.dspWinPrice=l.dspWinPrice),"debug"===sessionStorage.getItem("rmlMode")&&(d.default.debugMode=!0,this.winOrigin=window.location.origin?window.location.origin:document.referrer,this.winOrigin&&"null"!==this.winOrigin&&(window.parent.addEventListener("message",this._onValidatorPostMsg,!1),window.parent.postMessage({event:"rmlLoaded",id:"ravi-rules",source:"rml",name:"loaded"},this.winOrigin))),this._addTVObj(),window.getTremorVPAIDAd=function(){return s},this._previousEvents=[],d.default.macros.width=e,d.default.macros.height=t,d.default.macros.viewMode=i,d.default.macros.desiredBitrate=r,d.default.creativeData=n,d.default.environmentVars=o,d.default.playerTime=this._videoSlot.currentTime,d.default.macros.mlVersion="rml_"+C.version,(d.default.delegate=this)._overrideVastClient.parseAdURIs(this._vastParser.parserUtils).combineCompanions(this._vastParser.adParser).parseExtensions(this._vastParser.adParser).addMacrosToTracking(this._vastClient.util,d.default.macros),void 0!==n.AdParameters&&this._tremorAdParams(n.AdParameters)){var u=(0,m.default)(a,n.AdParameters);1<=u.getElementsByTagName("parsererror").length&&console.warn("The VAST wrapper XML has a parser error."),this._vastParser.parseVAST(u,{timeout:5e3,withCredentials:!0}).then(this._onVastResponse.bind(this)).catch(function(e){return s._destroyWithError(e.message)})}else this._destroyWithError("Ad Params were not passed by the player, hence the ad will not play.")}},{key:"_destroyWithError",value:function(e){console.error(e),this._dispatchDebugModeEvent(l.default.AD_ERROR,"adEvent"),this.emit(l.default.AD_ERROR),this._removeAll()}},{key:"_addTVObj",value:function(){this._handleIASViewableEvent=this._handleIASViewableEvent.bind(this),window.TV=new y.default,window.TV.on("iasViewable",this._handleIASViewableEvent)}},{key:"_tremorAdParams",value:function(e){return 0<e.indexOf("</Impression>")&&0<e.indexOf("</TrackingEvents>")&&0<e.indexOf("</Extensions>")&&0<e.indexOf("Acudeo")}},{key:"_onVastResponse",value:function(e){if(null!=e){var t=e.ads.filter(function(e){return!e.sequence});0===e.ads.length?this._destroyWithError("No ad is detected."):0===t.length?this._destroyWithError("AdPod ads are not supported."):1<t.length?this._destroyWithError("Multiple ads which are not part of an AdPod are present."):this._parseAd(e.ads[0])}}},{key:"_parseAd",value:function(e){var t=this,i=e.extensions;this.creativeDurationFromVAST=0,e.creatives.forEach(function(e){switch(e.type){case"linear":t.creativeDurationFromVAST=e.duration}}),void 0!==i&&0<i.length&&void 0!==i[0].Extensions&&void 0!==i[0].Extensions.Extension?this._handleExtensions(i[0].Extensions.Extension,function(){t._initCreative(e)}):this._initCreative(e)}},{key:"_initCreative",value:function(t){var i=this;t.creatives.forEach(function(e){switch(e.type){case"linear":i._linearAd(e),i._setupTracker(t,e);break;case"companion":console.warn("Creative companions are not yet supported.");break;case"nonlinear":console.warn("NonLinear Creatives are not yet supported.");break;default:i._destroyWithError("Unrecognized format: ".concat(e.type))}})}},{key:"_handleExtensions",value:function(e,t){var i,r,n,o,a,s,l=new g.default(d.default);if(0<e.length)for(var u=0;u<e.length;u++)i=l.handleExtendedProperties(e[u]),s=s||i.survey,r=r||l.handleBehaviorData(e[u]),n=n||l.handleAcudeoTracking(e[u]),o=o||l.handleViewability(e[u]),a=a||l.handleSkipAd(e[u]),l.handleDomainValidation(e[u]),l.handleRmlLogic(e[u]);else i=l.handleExtendedProperties(e),s=s||i.survey,r=l.handleBehaviorData(e),n=l.handleAcudeoTracking(e),o=l.handleViewability(e),a=l.handleSkipAd(e),l.handleDomainValidation(e),l.handleRmlLogic(e);o=l.getViewability(),s&&(this._survey=s),r&&(this._adChoices=r),a&&(this._skipAd=a),n&&(this._acudeoTracking=n,this._acudeoTracking&&this._acudeoTracking.get({type:"viewablecompletion"})&&(d.default.viewableCompletionPercent=this._acudeoTracking.viewableCompletionValue,100===d.default.viewableCompletionPercent&&(d.default.viewableCompletionPercent=98)),this._acudeoTracking&&this._acudeoTracking.get({type:"timebasecompletion"})&&(d.default.timeBaseCompletionValue=this._acudeoTracking.timeBaseCompletionValue,!isNaN(this.creativeDurationFromVAST)&&d.default.timeBaseCompletionValue>=this.creativeDurationFromVAST&&(d.default.timeBaseCompletionValue=this.creativeDurationFromVAST-1))),this._viewability=o||new v.default(null);var c={width:d.default.macros.width,height:d.default.macros.height,duration:this.creativeDurationFromVAST};this._handleIASViewableEvent=this._handleIASViewableEvent.bind(this),this._viewability.on("iasViewable",this._handleIASViewableEvent),this._handleMOATViewableEvent=this._handleMOATViewableEvent.bind(this),this._viewability.on("moatViewable",this._handleMOATViewableEvent),this._viewability.initializeViewability(this._videoSlot,this._slot,c,t)}},{key:"_setupTracker",value:function(e,t){var i=this;this._vastTracker=new p.VASTTracker(this._vastClient,e,t),this._mode===c.default.MODE_VIDEO&&(Object.keys(u.default).forEach(function(e){var t=u.default[e];i._vastTracker.on(t,function(){return i._onVastEvent(t)})}),this._vastTracker.on("clickthrough",function(e){d.default.macros.adPlaying?(i.pauseAd(),window.open(e,"_blank")):d.default.isInOutstreamEnv&&d.default.adCompleteFired?window.open(e,"_blank"):i.resumeAd()}),this._vastTracker.on("start",this._handleAdStart.bind(this)),this._overrideVastClient.onComplete(this._vastTracker,this._handleComplete.bind(this))),this._setupVideoSlot(),s.default.init(this._videoSlot,this._vastTracker,this._mode)}},{key:"_cleanUp",value:function(){this._adRemainingInterval&&clearInterval(this._adRemainingInterval),this._adChoices&&(this._adChoices.clearAdChoicesIcon(),this._adChoices=void 0),this._skipAd&&(this._skipAd.clearSkipAdIcon(),this._skipAd=void 0),this._removeAll()}},{key:"_handleAdComplete",value:function(){var e=this;console.log("=============================handle ONCOMPLETE=======================",d.default.macros.currentTime),d.default.adCompleteFired||(d.default.adCompleteFired=!0,this._vastTracker.track("complete",!0)),this._mode===c.default.MODE_VIDEO&&(d.default.macros.adPlaying=!1,this._survey?this._handleSurvey(!0):d.default.isInOutstreamEnv||(this._cleanUp(),this._adStopFired||(this._adStopFired=!0,console.log("Firing VPAID event AD_STOPPED to the player!!"),setTimeout(function(){return e.emit(l.default.AD_STOPPED)},249))))}},{key:"_onDurationChange",value:function(){this._handleAdDurationChange(this._videoSlot.duration)}},{key:"_onTimeUpdate",value:function(e){this._timeUpdateCalled=!0,this._durationSet||this._setDurationForTimeUpdate(this._videoSlot.duration),this._mode===c.default.MODE_VIDEO&&this._vastTracker.setProgress(this._videoSlot.currentTime),this._onAdProgress(e)}},{key:"_onVolumeChange",value:function(){0===this._videoSlot.volume&&0!==d.default.macros.volume?this._vastTracker.setMuted(!0):0<this._videoSlot.volume&&0===d.default.macros.volume&&(this._vastTracker.track("unmute"),this._vastTracker.setMuted(!1)),d.default.macros.volume=this._videoSlot.volume}},{key:"_setupVideoSlot",value:function(){this._mode===c.default.MODE_VIDEO&&(this.durationChangeListener=this._onDurationChange.bind(this),this._videoSlot.addEventListener("durationchange",this.durationChangeListener)),this.timeUpdateListener=this._onTimeUpdate.bind(this),this._videoSlot.addEventListener("timeupdate",this.timeUpdateListener),!0===this._videoSlot.muted?d.default.macros.volume=0:d.default.macros.volume=this._videoSlot.volume,this.volumeChangeListener=this._onVolumeChange.bind(this),this._videoSlot.addEventListener("volumechange",this.volumeChangeListener)}},{key:"_linearAd",value:function(e){this._mediaFilePlayable=this._getPlayableMediaFile(e.mediaFiles),this._mediaFilePlayable||this._destroyWithError("Nothing is playable in Creative Linear."),d.default.videoClickThroughURI=e.videoClickThroughURLTemplate,d.default.videoClickThroughId=this._overrideVastClient.getClickThroughId(),"application/javascript"===this._mediaFilePlayable.mimeType?this._createEmbeddedVpaid(e):this._createSimpleVideo()}},{key:"_getPlayableMediaFile",value:function(e){var t=this;return this._mediaFilesPlayable=e.filter(function(e){return"application/javascript"===e.mimeType}),this._mediaFilesPlayable.length<=0&&(this._mediaFilesPlayable=e.filter(function(e){return t._videoSlot.canPlayType(e.mimeType)}),0<this._mediaFilesPlayable.length&&(this._mediaFilesPlayable=o.default.filterByWidthAndBitrate(this._mediaFilesPlayable,d.default.macros.width,d.default.macros.desiredBitrate))),0<this._mediaFilesPlayable.length?this._mediaFilesPlayable[0]:void 0}},{key:"_receivePostMsg",value:function(e,t){var i,n=this;void 0===e.data.type||"TVCustomEvent"!==e.data.type||void 0===e.data.creativeObj?e.data.id===this._postMsgId&&void 0!==this._iframe&&(this._iframe.contentWindow?void 0===(i=this._iframe.contentWindow.getVPAIDAd)?this._destroyWithError("The ad did not implement getVPAIDAd."):(this._embeddedVPAID=i(),Object.keys(l.default).forEach(function(e){var r=l.default[e];n._embeddedVPAID.subscribe(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n._onSubscribe(r,t)},r)}),d.default.environmentVars.slot=this._ui.vpaidEmbeddedThirdParty,d.default.creativeData={},null!==t.adParameters&&void 0!==t.adParameters?d.default.creativeData.AdParameters=t.adParameters:d.default.creativeData.AdParameters=void 0,this._embeddedVPAID.initAd(d.default.macros.width,d.default.macros.height,d.default.macros.viewMode,d.default.desiredBitrate,d.default.creativeData,d.default.environmentVars)):this._destroyWithError("The iframe is no longer in the DOM tree.")):this._handleTremorCustomEvent(e.data.creativeObj)}},{key:"_onVastEvent",value:function(e){var t;switch(e){case u.default.AD_STARTED:t=l.default.AD_STARTED;break;case u.default.AD_CREATIVE_VIEW:t=l.default.AD_IMPRESSION;break;case u.default.AD_VIDEO_FIRST_QUARTILE:t=l.default.AD_VIDEO_FIRST_QUARTILE;break;case u.default.AD_VIDEO_MIDPOINT:t=l.default.AD_VIDEO_MIDPOINT;break;case u.default.AD_VIDEO_THIRD_QUARTILE:t=l.default.AD_VIDEO_THIRD_QUARTILE;break;case u.default.AD_PLAYING:d.default.macros.adPlaying=!0,t=l.default.AD_PLAYING;break;case u.default.AD_PAUSED:d.default.macros.adPlaying=!1,t=l.default.AD_PAUSED;break;case u.default.AD_REWIND:break;case u.default.AD_SKIPPED:d.default.adSkipped=!0,t=l.default.AD_SKIPPED;break;case u.default.AD_CLOSE:case u.default.AD_CLOSE_LINEAR:t=l.default.AD_USER_CLOSE,this._vastTracker.track("close");break;case u.default.AD_VIDEO_COMPLETE:t=l.default.AD_VIDEO_COMPLETE,d.default.adComplete=!0;break;default:t=e}void 0!==t&&(console.log("---------------------------- Firing VPAID event "+t+" to the player!!"),t===l.default.AD_STARTED?(d.default.adStartedFired||(this.emit(t),this.emit(l.default.AD_VIDEO_START),this._dispatchDebugModeEvent(t,"adEvent"),this._dispatchDebugModeEvent(l.default.AD_VIDEO_START,"adEvent")),this._vastTracker.trackImpression(),this._previousEvents.push(t),this._previousEvents.push(l.default.AD_VIDEO_START)):(this._dispatchDebugModeEvent(t,"adEvent"),t!==l.default.AD_SKIPPED&&this.emit(t),this._previousEvents.push(t))),void 0!==this._viewability&&(this._viewability.iasEnabled?this._handleForIASViewability(t):this._viewability.moatEnabled&&this._handleForMOATViewability(t))}},{key:"_onSubscribe",value:function(e,t){var i=this;switch(e){case l.default.AD_STARTED:this._handleAdStart(),this._vastTracker.track("start");break;case l.default.AD_VIDEO_FIRST_QUARTILE:this._vastTracker.track("firstQuartile");break;case l.default.AD_VIDEO_MIDPOINT:this._vastTracker.track("midpoint");break;case l.default.AD_VIDEO_THIRD_QUARTILE:this._vastTracker.track("thirdQuartile");break;case l.default.AD_VIDEO_COMPLETE:this._vastTracker.track("complete",!0),d.default.adComplete=!0,d.default.adCompleteFired=!0;break;case l.default.AD_USER_ACCEPT_INVITATION:this._vastTracker.track("acceptInvitation");break;case l.default.AD_USER_MINIMIZE:this._vastTracker.track("collapse");break;case l.default.AD_USER_CLOSE:this._vastTracker.track("close");break;case l.default.AD_SIZE_CHANGE:break;case l.default.AD_PAUSED:d.default.macros.adPlaying=!1,clearInterval(this._adRemainingInterval);break;case l.default.AD_PLAYING:d.default.macros.adPlaying=!0,this._timeUpdateCalled||this._setIntervalAdTime(),void 0!==this._adChoices&&this._adChoices.adChoiceExpanded&&this._adChoices.minimizeAdChoicesIcon();break;case l.default.AD_REMAINING_TIME_CHANGE:break;case l.default.AD_SKIPPABLE_STATE_CHANGE:d.default.skippableState=this._embeddedVPAID.getAdSkippableState();break;case l.default.AD_CLICK_THRU:this._vastTracker.click();break;case l.default.AD_DURATION_CHANGE:console.log("TBD - ad duration change",this._embeddedVPAID.getAdDuration()),0<this._embeddedVPAID.getAdDuration()&&(d.default.macros.adDuration=this._embeddedVPAID.getAdDuration(),this._vastTracker.setDuration(d.default.macros.adDuration));break;case l.default.AD_SKIPPED:d.default.adSkipped=!0}this._adStopFired||(e!==l.default.AD_REMAINING_TIME_CHANGE&&console.log("====================== Firing vpaidEvent: "+e+" ======================",t),e!==l.default.AD_STOPPED?e===l.default.AD_STARTED||e===l.default.AD_VIDEO_START?d.default.adStartedFired||(this._dispatchDebugModeEvent(e,"adEvent"),this.emit.apply(this,[e].concat(w(t)))):(this._dispatchDebugModeEvent(e,"adEvent"),e!==l.default.AD_SKIPPED&&this.emit.apply(this,[e].concat(w(t)))):(this._cleanUpViewability(),this._survey?(console.log("Survey present. We will wait for the survey event to dispatch AdStopped"),this._handleSurvey(!0)):setTimeout(function(){i._cleanUp(),d.default.macros.adPlaying=!1,i._adStopFired=!0,i._destroyed=!0,i._dispatchDebugModeEvent(l.default.AD_STOPPED,"adEvent"),i.emit(l.default.AD_STOPPED)},249)),this._previousEvents.push(e),e===l.default.AD_IMPRESSION&&this._vastTracker.trackImpression()),void 0!==this._viewability&&(this._viewability.iasEnabled?this._handleForIASViewability(e):this._viewability.moatEnabled&&this._handleForMOATViewability(e))}},{key:"_createEmbeddedVpaid",value:function(e){var t=this;this._mode=c.default.MODE_EMBEDDED_VPAID,this._slot.style.position="absolute",this._slot.style.left=this._slot.style.top=0,this._slot.style.width=d.default.macros.width+"px",this._slot.style.height=d.default.macros.height+"px",this._ui.vpaidEmbedded=h.default.createAndAppend(this._slot,"div","vpaidEmbedded"),this._iframe=h.default.createIframe(this._ui.vpaidEmbedded,"about:blank","<!DOCTYPE html><head></head><body></body></html>"),this._iframe.id=this._iframe.name="trmr-rml",this._onVpaidIframeLoadBound=function(){return t._onVpaidIframeLoad(e)},this._iframe.addEventListener("load",this._onVpaidIframeLoadBound,!1),this._ui.vpaidEmbedded.appendChild(this._iframe)}},{key:"_onVpaidIframeLoad",value:function(t){var e,i=this;this._postMsgId="vpaid_".concat(Date.now()),this._SOURCE_NAME="trmr-rml",this._ui.vpaidEmbeddedThirdParty=h.default.createAndAppend(this._iframe.contentDocument.body,"div","rml-content"),this._ui.vpaidEmbeddedThirdParty.style.width=d.default.macros.width+"px",this._ui.vpaidEmbeddedThirdParty.style.height=d.default.macros.height+"px",this._receivePostMsgBound=function(e){return i._receivePostMsg(e,t)},this._iframe.contentWindow.addEventListener("message",this._receivePostMsgBound,!1),e=h.default.createScript(this._mediaFilePlayable.fileURL,function(){var e=document.createElement("script");e.type="text/javascript",e.innerHTML='postMessage({"event": "ready","id": "'.concat(i._postMsgId,'","source": "').concat(i._SOURCE_NAME,'", "name": "Culprit"}, "*");'),i._iframe.contentDocument.body.appendChild(e)}),this._iframe.contentDocument.body.appendChild(e),this._bodyTextRemoved||(this._bodyTextRemoved=!0,h.default.emptyIframeTextContent(this._iframe))}},{key:"_createSimpleVideo",value:function(){this._mode=c.default.MODE_VIDEO,this._resizeVastVideoSlot(d.default.macros.width,d.default.macros.height),this._dispatchDebugModeEvent(l.default.AD_LOADED,"adEvent"),this._slot.style.width="100%",this._slot.style.height="100%",this.emit(l.default.AD_LOADED),this._previousEvents.push(l.default.AD_LOADED)}},{key:"_handleTremorCustomEvent",value:function(e){if(e){var t=e.params.kind+"_"+e.params.context;e.params.action&&(t+="_"+e.params.action),this._fireCustomTrackingPixels(t,null,e.params),this._dispatchDebugModeEvent(t,"adEvent")}}},{key:"_handleAdDurationChange",value:function(e){0<e&&(d.default.macros.adDuration=e)}},{key:"_setDurationForTimeUpdate",value:function(e){0<e&&(d.default.macros.adDuration=e,this._vastTracker.setDuration(d.default.macros.adDuration),this._durationSet=!0)}},{key:"_handleAdStart",value:function(){var e=this;this._adStarted=!0,void 0!==this._embeddedVPAID&&0<this._embeddedVPAID.getAdDuration()&&(d.default.macros.adDuration=this._embeddedVPAID.getAdDuration(),setTimeout(function(){e._timeUpdateCalled||e._setIntervalAdTime()},500)),this._setDurationForTimeUpdate(d.default.macros.adDuration),void 0===this._viewability||this._viewability.thirdPartyEnabled||this._manageViewableImpression()}},{key:"_setIntervalAdTime",value:function(){this._adRemainingInterval=setInterval(this._checkAdRemainingTime.bind(this),500)}},{key:"_checkAdRemainingTime",value:function(){if(0<d.default.macros.adDuration){var e=Math.max(0,this._embeddedVPAID.getAdRemainingTime()),t={target:{currentTime:d.default.macros.adDuration-e}};this._onTimeUpdate(t)}else console.warn("ERROR: The ad duration is not provided by the VPAID Ad.")}},{key:"_canPlayPromise",value:function(){var t=this;try{var e=this._videoSlot.play();this._videoSlot.pause(),this._playPromiseTimeout(),console.log("playPromise ",e),void 0!==e?e.then(function(){console.log("The playback will work fine."),t._handleStartAd(!0)}).catch(function(e){console.log("The playback was interrupted.",e),t._fireCustomTrackingPixels("browserpausedad"),t._handleStartAd(!0)}):this._handleStartAd(!0)}catch(e){this._destroyWithError("An error occured while attempting to resolve the play-promise.")}}},{key:"_playPromiseTimeout",value:function(){var e=this;this._playPromiseTimer=setTimeout(function(){console.log("The playback promise timed out."),e._handleStartAd(!0)},500)}},{key:"_handleStartAd",value:function(e){this._handleStartAdRan||(clearTimeout(this._playPromiseTimer),this._handleStartAdRan=!0,e?(d.default.macros.adPlaying=!0,d.default.viewableImpressionFired=!1,d.default.macros.adDuration=0,d.default.macros.isViewabilityAvailable="0",d.default.macros.averageViewable=0,d.default.macros.percentOfTotalViewable=0,d.default.macros.pageViewable=!0,this._viewableTimeoutSet=!1,this._expectedPercent=0,this._viewablePercents=[],this._viewableInterpolated=[],this._viewableDict={},this._engagementEventFired=!1,this._adStarted=!1,this._handlePageVisibility(),void 0===this._viewability||this._viewability.thirdPartyEnabled||(d.default.macros.isViewabilityAvailable=this._viewability.viewabilityAvailable),this._survey&&"VizuSurvey"===this._survey._name?(console.log("Firing AdStarted to the player for survey"),this.emit(l.default.AD_STARTED),this.emit(l.default.AD_VIDEO_START),this._dispatchDebugModeEvent(l.default.AD_STARTED,"adEvent"),this._dispatchDebugModeEvent(l.default.AD_VIDEO_START,"adEvent"),d.default.adStartedFired=!0,this._handleSurvey(!1)):(console.log("Calling play ad!!! NO Survey..."),this._playAd())):(console.log("Loading the play button"),document.body.style.margin="0",document.body.style.height="".concat(d.default.macros.height,"px"),document.body.style.width="".concat(d.default.macros.width,"px"),this._playButton=h.default.createAndAppend(this._slot,"img","play-button"),this._playButton.style.height="".concat(d.default.macros.height,"px"),this._playButton.style.width="".concat(d.default.macros.width,"px"),this._playButton.style.position="absolute",this._playButton.style.cursor="pointer",this._playButton.setAttribute("src","http://localhost/raviraj/images/wefun.png"),this._handlePlayButtonClickBound=this._handlePlayButtonClick.bind(this),this._playButton.addEventListener("click",this._handlePlayButtonClickBound,!1)))}},{key:"_handlePlayButtonClick",value:function(){console.log("XXXXXXXXXXXXXX _onPlayButtonClick XXXXXXXXXXXXXXXXXXXXXXX"),this._playButton&&this._slot.removeChild(this._playButton),console.log("_onPlayButtonClick calling handleStartAd"),this._handleStartAd(!0)}},{key:"startAd",value:function(){this._canPlayPromise()}},{key:"_playAd",value:function(){console.log("start the ad."),this._embeddedVPAID?(this._embeddedVPAID.startAd(),this._displayAdChoices(),this._displaySkipAd()):(this._onvideoLoadedDataBound=this._onvideoLoadedData.bind(this),this._videoSlot.addEventListener("loadeddata",this._onvideoLoadedDataBound),this._onVideoErrorBound=this._onVideoError.bind(this),this._videoSlot.addEventListener("error",this._onVideoErrorBound),this._videoSlot.setAttribute("src",this._mediaFilePlayable.fileURL),this._videoSlot.load())}},{key:"_onvideoLoadedData",value:function(){console.log("The video file exists. Playing the ad."),this._videoSlot.play(),this._clickThruLayer(),this._displayAdChoices(),this._displaySkipAd()}},{key:"_onVideoError",value:function(){this._destroyWithError("The MediaFile does not exist. Returning to content.")}},{key:"_displayAdChoices",value:function(){void 0!==this._adChoices&&"yes"===this._adChoices._used.toLowerCase()&&(this._adChoices.on("adChoicesEvent",this._onAdChoicesEvent.bind(this)),this._adChoices.displayIcon(this._slot))}},{key:"_displaySkipAd",value:function(){void 0!==this._skipAd&&"true"===this._skipAd._enabled.toLowerCase()&&(this._skipAd.on("skipAdEvent",this._onSkipAdEvent.bind(this)),this._skipAd.displaySkipAdIcon(this._slot))}},{key:"_handleStart",value:function(){this._playAd()}},{key:"_handleComplete",value:function(){var e=this;this._cleanUpViewability(),d.default.adSkipped?setTimeout(function(){e._removeAll(),d.default.macros.adPlaying=!1,e._adStopFired=!0,e._dispatchDebugModeEvent(l.default.AD_STOPPED,"adEvent"),e.emit(l.default.AD_STOPPED)},300):this._handleAdComplete()}},{key:"_cleanUpViewability",value:function(){this._viewability&&this._viewability._removeIntersectionObserver()}},{key:"_clickThruLayer",value:function(){document.body.style.margin="0",document.body.style.height="".concat(d.default.macros.height,"px"),document.body.style.width="".concat(d.default.macros.width,"px"),this._clickThroughDiv=h.default.createAndAppend(this._slot,"div"),this._clickThroughDiv.className="click-thru-layer",this._clickThroughDiv.textContent=" ",this._clickThroughDiv.style.height="".concat(d.default.macros.height,"px"),this._clickThroughDiv.style.width="".concat(d.default.macros.width,"px"),this._clickThroughDiv.style.position="absolute",this._clickThroughDiv.style.cursor="pointer",this._onClickThroughDivClickBound=this._onClickThroughDivClick.bind(this),this._clickThroughDiv.addEventListener("click",this._onClickThroughDivClickBound,!1)}},{key:"_onClickThroughDivClick",value:function(){var e={url:d.default.videoClickThroughURI,trackID:d.default.videoClickThroughId,playerHandles:!1};this._vastTracker.click(),this.emit(l.default.AD_CLICK_THRU,e.url,e.trackID,e.playerHandles)}},{key:"_handlePageVisibility",value:function(){void 0!==document.hidden?(d.default.macros.hidden="hidden",this._visibilityChangeEvent="visibilitychange"):void 0!==document.msHidden?(d.default.macros.hidden="msHidden",this._visibilityChangeEvent="msvisibilitychange"):void 0!==document.webkitHidden&&(d.default.macros.hidden="webkitHidden",this._visibilityChangeEvent="webkitvisibilitychange"),void 0===d.default.macros.hidden?this._destroyWithError("Viewability is not supported."):document.addEventListener(this._visibilityChangeEvent,this._handleVisibilityChange,!1)}},{key:"_handleVisibilityChange",value:function(){document[d.default.macros.hidden]?d.default.macros.pageViewable=!1:d.default.macros.pageViewable=!0}},{key:"_calculateViewables",value:function(e,t,i){var r=100*i.playerViewability,n=0;if(!1===d.default.macros.pageViewable&&(r=0,this._viewability.thirdPartyEnabled||(d.default.macros.isViewabilityAvailable="0")),-1<t){if(t<=e&&void 0===this._viewableDict[t]){if(this._viewableDict[t]=r,this._viewablePercents.push(r),0<t&&1<this._viewablePercents.length)for(var o=1,a=this._viewablePercents.length;o<a;o++)void 0===this._viewableInterpolated[o-1]&&this._viewableInterpolated.push((this._viewablePercents[o]+this._viewablePercents[o-1])/2);0<this._viewableInterpolated.length&&(n=this._viewableInterpolated.reduce(function(e,t){return e+t}),d.default.macros.averageViewable=Math.round(n/this._viewableInterpolated.length*100)/100,d.default.macros.percentOfTotalViewable=97<=t?d.default.macros.averageViewable:Math.round(d.default.macros.averageViewable*(t/100)),this._onAdViewable()),this._dispatchDebugModeEvent(i.playerViewability,"viewabilityInfo"),this._dispatchDebugModeEvent(d.default.macros.percentOfTotalViewable,"percentViewableInfo"),this._expectedPercent+=5,e>this._expectedPercent&&this._calculateViewables(e,this._expectedPercent,i)}}else this._viewablePercents.push(r)}},{key:"_onAdViewable",value:function(){void 0!==this._acudeoTracking&&(!d.default.view25Fired&&25<=d.default.macros.percentOfTotalViewable&&(d.default.view25Fired=!0,this._fireCustomTrackingPixels("viewable","25")),!d.default.view50Fired&&50<=d.default.macros.percentOfTotalViewable&&(d.default.view50Fired=!0,this._fireCustomTrackingPixels("viewable","50")),!d.default.view75Fired&&75<=d.default.macros.percentOfTotalViewable&&(d.default.view75Fired=!0,this._fireCustomTrackingPixels("viewable","75")),!d.default.viewCompletionFired&&d.default.macros.percentOfTotalViewable>=d.default.viewableCompletionPercent&&(d.default.viewCompletionFired=!0,this._fireCustomTrackingPixels("viewablecompletion"),this._dispatchDebugModeEvent("viewablecompletion","adEvent")))}},{key:"_fireCustomTrackingPixels",value:function(e,t,i){var r,n=1<arguments.length&&void 0!==t?t:null,o=2<arguments.length&&void 0!==i?i:{};console.log("Dispatching the tracking pixel/s for ",e,n),r=null!==n?this._acudeoTracking.get({type:e,value:n}):this._acudeoTracking.get({type:e}),o.engagementEvent&&void 0!==r&&(this._engagementEventFired?r=a.default.appendToTremorUrls(r,"Ee=0"):(r=(r=a.default.appendToTremorUrls(r,"Ee=1")).concat(this._acudeoTracking.get({type:"Engagement_Third_Party"})),this._engagementEventFired=!0)),Object.keys(d.default).forEach(function(e){return o[e]=d.default[e]}),this._vastClient.util.track(r,o),console.log("Dispatch the pixels for "+r+"!!!!!!!")}},{key:"_onAdChoicesEvent",value:function(e){"adChoiceIconExpanded"===e&&!0===d.default.macros.adPlaying?(console.log("Calling pause Ad"),this.pauseAd()):"adChoiceSlateClosed"===e&&!1===d.default.macros.adPlaying&&(console.log("Calling resume Ad"),this._adChoices.adWasPlaying&&this.resumeAd())}},{key:"_onSkipAdEvent",value:function(e){if("SkipClicked"===e){var t=[];Object.keys(d.default).forEach(function(e){return t[e]=d.default[e]}),void 0!==this._skipAd._skipPixel&&(console.log("Dispatch the pixels for skipAd Clicked",this._skipAd._skipPixel),this._vastClient.util.track([this._skipAd._skipPixel],t)),this.skipAd()}}},{key:"_onSurveyEvent",value:function(e){var t=this;console.log("on Survey Event ",e),this._survey.removeAllListeners("surveyEvent"),d.default.adComplete&&d.default.adCompleteFired?(this._survey=null,this._cleanUp(),setTimeout(function(){d.default.macros.adPlaying=!1,t._adStopFired=!0,t._destroyed=!0,t._dispatchDebugModeEvent(l.default.AD_STOPPED,"adEvent"),t.emit(l.default.AD_STOPPED)},249)):d.default.adSkipped?(this._survey=null,this._removeAll(),this._adStopFired||setTimeout(function(){d.default.macros.adPlaying=!1,t._adStopFired=!0,t.emit(l.default.AD_STOPPED)},249)):this._playAd()}},{key:"_handleSurvey",value:function(e){var t={width:d.default.macros.width,height:d.default.macros.height,adComplete:e,videoSlot:this._slot,extendedProperties:d.default.extendedProperties};this._survey.on("surveyEvent",this._onSurveyEvent.bind(this)),this._survey.render(t)}},{key:"_onAdProgress",value:function(e){var t,i=0;void 0===this._viewability||this._viewability.thirdPartyEnabled||!1===d.default.viewableImpressionFired&&!0===this._adStarted&&this._manageViewableImpression(),i=0<this._videoSlot.currentTime?this._videoSlot.currentTime:e.target.currentTime,d.default.macros.currentTime=i,void 0!==d.default.macros.adDuration&&0<d.default.macros.adDuration&&!0===d.default.macros.adPlaying&&(t=Math.ceil(100*i/d.default.macros.adDuration),this._dispatchDebugModeEvent(d.default.macros.adDuration,"adDuration"),this._dispatchDebugModeEvent(d.default.macros.currentTime,"adProgress"),void 0!==this._viewability&&!isNaN(t)&&this._expectedPercent<=100&&(100<=this._expectedPercent&&(this._expectedPercent=97),this._calculateViewables(t,this._expectedPercent,this._viewability)),this._handleCustomTimeBaseCompletionEvent())}},{key:"_handleCustomTimeBaseCompletionEvent",value:function(){d.default.timeBaseCompletionValue&&!d.default.timeBaseCompletionFired&&d.default.macros.currentTime>=d.default.timeBaseCompletionValue&&(d.default.timeBaseCompletionFired=!0,this._fireCustomTrackingPixels("timebasecompletion"))}},{key:"stopAd",value:function(){this._destroyed||(this._embeddedVPAID?this._embeddedVPAID.stopAd():(d.default.macros.adPlaying=!1,this._vastTracker.complete()))}},{key:"pauseAd",value:function(){this._embeddedVPAID?this._embeddedVPAID.pauseAd():(this._videoSlot.pause(),d.default.macros.adPlaying=!1,this.emit(l.default.AD_PAUSED))}},{key:"resumeAd",value:function(){this._embeddedVPAID?this._embeddedVPAID.resumeAd():(this._videoSlot.play(),d.default.macros.adPlaying=!0,this.emit(l.default.AD_PLAYING)),void 0!==this._adChoices&&this._adChoices.adChoiceExpanded&&this._adChoices.minimizeAdChoicesIcon()}},{key:"expandAd",value:function(){this._embeddedVPAID&&this._embeddedVPAID.expandAd(),T(k(t.prototype),"expandAd",this).call(this)}},{key:"collapseAd",value:function(){this._embeddedVPAID&&this._embeddedVPAID.collapseAd(),T(k(t.prototype),"collapseAd",this).call(this)}},{key:"skipAd",value:function(){var e=this;this._embeddedVPAID?this._embeddedVPAID.skipAd():(d.default.adSkipped=!0,this.stopAd()),this._vastTracker.skip(),s.default.removeListeners(),this._destroyed||(setTimeout(function(){e._adStopFired=!0,e.emit(l.default.AD_SKIPPED),e.emit(l.default.AD_STOPPED)},300),d.default.skippableState||this._skipAd._enabled||console.error("This VPAID unit is not skippable. You have forced a skip illegally."))}},{key:"_removeAll",value:function(){this._destroyed=!0,this._videoSlot.removeEventListener("durationchange",this.durationChangeListener),this._videoSlot.removeEventListener("timeupdate",this.timeUpdateListener),this._videoSlot.removeEventListener("volumechange",this.volumeChangeListener),this._videoSlot.removeEventListener("loadeddata",this._onvideoLoadedDataBound),this._videoSlot.removeEventListener("error",this._onVideoErrorBound),document.removeEventListener(this._visibilityChangeEvent,this._handleVisibilityChange),this._iframe&&(this._iframe.removeEventListener("load",this._onVpaidIframeLoadBound),this._iframe.contentWindow.removeEventListener("message",this._receivePostMsgBound)),this._playButton&&this._playButton.removeEventListener("click",this._handlePlayButtonClickBound),this._clickThroughDiv&&this._clickThroughDiv.removeEventListener("click",this._onClickThroughDivClickBound),this._videoSlot.setAttribute("currentTime",d.default.playerTime),this._mode===c.default.MODE_VIDEO&&(-1!==document.body.innerHTML.indexOf(this._slot.innerHTML)&&(this._slot.innerHTML=""),this._vastTracker&&this._vastTracker.removeAllListeners(),this._vastTracker=null),window.TV.removeListener("iasViewable",this._handleIASViewableEvent),this._viewability.removeListener("moatViewable",this._handleMOATViewableEvent),this._ui=null}},{key:"resizeAd",value:function(e,t,i){this._mode===c.default.MODE_EMBEDDED_VPAID?this._embeddedVPAID.resizeAd(e,t,i):this._resizeVastVideoSlot(e,t),this._handleAdSizeChange(e,t,i),this.emit(l.default.AD_SIZE_CHANGE)}},{key:"_resizeVastVideoSlot",value:function(e,t){this._videoSlot.setAttribute("width",e),this._videoSlot.setAttribute("height",t),this._videoSlot.style&&(this._videoSlot.style.width="".concat(e,"px"),this._videoSlot.style.height="".concat(t,"px"))}},{key:"_handleAdSizeChange",value:function(e,t,i){this._mode===c.default.MODE_EMBEDDED_VPAID&&(this._slot.style.width=e+"px",this._slot.style.height=t+"px",this._ui.vpaidEmbeddedThirdParty.style.width=e+"px",this._ui.vpaidEmbeddedThirdParty.style.height=t+"px"),this._survey&&this._survey.displayed&&this._survey.resizeSurvey(e,t,i),d.default.macros.width=e,d.default.macros.height=t,d.default.macros.viewMode=i,this._adChoices&&this._adChoices.onAdSizeChanged(d.default),this._skipAd&&this._skipAd.onAdSizeChanged(d.default)}},{key:"getAdVolume",value:function(){return this._embeddedVPAID?this._embeddedVPAID.getAdVolume():T(k(t.prototype),"getAdVolume",this).call(this)}},{key:"setAdVolume",value:function(e){return this._embeddedVPAID?this._embeddedVPAID.setAdVolume(e):T(k(t.prototype),"setAdVolume",this).call(this,e)}},{key:"getAdDuration",value:function(){return this._embeddedVPAID?this._embeddedVPAID.getAdDuration():d.default.macros.adDuration}},{key:"getAdIcons",value:function(){return this._embeddedVPAID?this._embeddedVPAID.getAdIcons():T(k(t.prototype),"getAdIcons",this).call(this)}},{key:"getAdLinear",value:function(){return this._embeddedVPAID?this._embeddedVPAID.getAdLinear():T(k(t.prototype),"getAdLinear",this).call(this)}},{key:"getAdRemainingTime",value:function(){return this._embeddedVPAID?this._embeddedVPAID.getAdRemainingTime():this._videoSlot.duration-this._videoSlot.currentTime}},{key:"getAdCompanions",value:function(){return this._embeddedVPAID?this._embeddedVPAID.getAdCompanions():T(k(t.prototype),"getAdCompanions",this).call(this)}},{key:"getPlayer",value:function(){return this._videoSlot}},{key:"getSlot",value:function(){return this._slot}},{key:"getPreviousEvents",value:function(){return this._previousEvents}},{key:"_handleForIASViewability",value:function(e){if(void 0!==this._viewability.cmInstance){var t={volume:d.default.macros.volume,ad_duration:d.default.macros.adDuration};this._viewability.cmInstance.sendEvent(e,t)}}},{key:"_handleForMOATViewability",value:function(e){if(void 0!==this._viewability.moatApiReference){var t={type:e,adVolume:d.default.macros.volume};this._viewability.moatApiReference.dispatchEvent(t)}}},{key:"_manageViewableImpression",value:function(){var e=this;!0===d.default.macros.adPlaying&&.5<=this._viewability.playerViewability&&!1===d.default.viewableImpressionFired?!1===this._viewableTimeoutSet&&(console.log("Start the timeout for viewableImpression."),this._viewableImpressionTimeout=setTimeout(function(){e._dispatchViewableImpression()},2e3),this._viewableTimeoutSet=!0):void 0!==this._viewableImpressionTimeout&&(console.log("Clear the timeout for viewableImpression."),clearTimeout(this._viewableImpressionTimeout),this._viewableImpressionTimeout=void 0,this._viewableTimeoutSet=!1)}},{key:"_dispatchViewableImpression",value:function(){console.log(this._acudeoTracking?"Dispatch the VIEWABLE IMPRESSION!!!":"No Acudeo tracking"),this._acudeoTracking&&!1===d.default.viewableImpressionFired&&(this._fireCustomTrackingPixels("viewableimpression"),d.default.viewableImpressionFired=!0,this._dispatchDebugModeEvent("viewableimpression","adEvent"))}},{key:"_handleIASViewableEvent",value:function(e){console.log("_handleIASViewableEvent EVENT:: ",e,d.default.macros.currentTime),this._viewability&&this._viewability.iasEnabled&&("Measurable"===e?d.default.macros.isViewabilityAvailable="1":("IAS_2_SECONDS"===this._viewability.viewableImpressionType&&"InView"===e||"IAS_5_SECONDS"===this._viewability.viewableImpressionType&&"InView5"===e||"IAS_15_SECONDS"===this._viewability.viewableImpressionType&&"InView15"===e)&&(d.default.macros.isViewabilityAvailable="1",this._dispatchViewableImpression()))}},{key:"_handleMOATViewableEvent",value:function(e){console.log("_handleMOATViewableEvent EVENT:: ",e,d.default.macros.currentTime),this._viewability&&this._viewability.moatEnabled&&("MOAT_IAB"===this._viewability.viewableImpressionType?"MRC_measurable"===e?d.default.macros.isViewabilityAvailable="1":"MRC_viewable"===e&&(d.default.macros.isViewabilityAvailable="1",this._dispatchViewableImpression()):"MOAT_GROUP_M"===this._viewability.viewableImpressionType&&("GM_measurable"===e?d.default.macros.isViewabilityAvailable="1":"GM_viewable"===e&&(d.default.macros.isViewabilityAvailable="1",this._dispatchViewableImpression())))}},{key:"executeDVClientCallback",value:function(e){console.log("executeClientCallback EVENT:: ",e,d.default.macros.currentTime),"IABMeasuredImpression"===e?d.default.macros.isViewabilityAvailable="1":"IABViewableImpression"===e?(d.default.macros.isViewabilityAvailable="1",d.default.delegate._dispatchViewableImpression()):"CustomViewabilityViewable"===e&&console.log("TBD - CustomViewabilityViewable")}},{key:"_onValidatorPostMsg",value:function(e){"adMode=ravirules"===e.data&&window&&(window.removeEventListener("message",this._onValidatorPostMsg),window.parent&&window.parent.removeEventListener("message",this._onValidatorPostMsg))}},{key:"_dispatchDebugModeEvent",value:function(e,t){if(d.default.debugMode&&!this._adStopFired&&this.winOrigin&&"null"!==this.winOrigin){var i={type:e,info:t};window.parent.postMessage(i,this.winOrigin)}}},{key:"emitVpaidMethodInvocations",value:function(){T(k(t.prototype),"hasOwnProperty",this).call(this,"emitVpaidMethodInvocations")&&T(k(t.prototype),"emitVpaidMethodInvocations",this).call(this)}}])&&E(e.prototype,i),r&&E(e,r),t}();i.default=I},{"../version.json":77,"./ad/Extensions":53,"./ad/TV":55,"./ad/Viewability":56,"./ad/adObject":57,"./ad/modes":58,"./ad/provisionTrackingEvents":59,"./ad/vastEvents":62,"./ad/vpaidEvents":63,"./util/Dependencies":65,"./util/HTMLElement":66,"./util/IEPolyfill":67,"./util/OverrideVastClient":69,"./util/URLUtil":70,"./util/VideoUtil":71,"./util/createVastWrapperAd":72,"vast-client":40,"vpaid-ad/lib/linear":41}],51:[function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=function(){function s(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var i,r,n,o=e;if(this._out=[],this._full=[],o instanceof Array)(i=o.filter(function(e){return Object.prototype.hasOwnProperty.call(e,"Acudeo")})[0])&&(r=i.Acudeo.Tracking.Event);else if(Object.prototype.hasOwnProperty.call(o,"Acudeo")){var a=o.Acudeo.Tracking.Event;r=Array.isArray(a)?[a]:[[a]]}this._out.length<=0&&0<r.length&&r.forEach(function(e){e.forEach(function(e){n=e.textContent||e["#cdata-section"].textContent,t._full.push(e),t._out.push(n)})})}var e,t,i;return e=s,(t=[{key:"get",value:function(r){var e,n,o,a,s;return r?(o=[],a=Object.keys(r),this._full.forEach(function(i){s=0,Object.keys(i).forEach(function(t){n=t.toLowerCase(),a.forEach(function(e){s+=i[t]==r[e]&&n==e.toLowerCase()?1:0}),s===a.length&&(e=i.textContent||i["#cdata-section"].textContent,s=0,o.push(e))})}),o):this._out}},{key:"viewableCompletionValue",get:function(){var e,t,i=this;return void 0===this._viewableCompletionValue&&(this._viewableCompletionValue=100,0<(e=this._full.filter(function(e){return"viewablecompletion"===(e.type||e.Type)})).length?e.forEach(function(e){(t=Number(e.value||e.Value))<i._viewableCompletionValue&&(i._viewableCompletionValue=t)}):this._viewableCompletionValue=null),this._viewableCompletionValue}},{key:"timeBaseCompletionValue",get:function(){var e,t,i=this;return void 0===this._timeBaseCompletionValue&&(this._timeBaseCompletionValue=30,0<(e=this._full.filter(function(e){return"timebasecompletion"===(e.type||e.Type)})).length?e.forEach(function(e){(t=Number(e.value||e.Value))<i._timeBaseCompletionValue&&(i._timeBaseCompletionValue=t)}):this._timeBaseCompletionValue=null),this._timeBaseCompletionValue}}])&&r(e.prototype,t),i&&r(e,i),s}();i.default=n},{}],52:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=n(e("../util/getTextContent")),r=e("events"),a=n(e("../util/Dependencies"));function n(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h="adChoiceIconExpanded",f="adChoiceSlateClosed",p=function(){function n(e,t){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),console.log("AdChoices Icon"),(i=u(this,c(n).call(this)))._playerAttributes=t,i._advertiser=(0,o.default)(e.Advertiser),i._campaignId=(0,o.default)(e.CampaignID),i._used=(0,o.default)(e.Used),i._sources=[];for(var r=0;r<e.Source.length;r++)i._sources.push((0,o.default)(e.Source[r]));return i._optout=(0,o.default)(e.Optout),i._iconClick=(0,o.default)(e.IconClick),i._iconPosition=(0,o.default)(e.IconPosition),i.TIMER=2e3,i._adChoiceExpanded=!1,i._adWasPlaying=!1,i}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,r.EventEmitter),e=n,(t=[{key:"displayIcon",value:function(e){var t=this;this._videoSlot=e,this._adChoicesTimeout=setTimeout(function(){t._addIcon()},this.TIMER)}},{key:"_addIcon",value:function(){console.log("Add icon"),this._adChoicesDiv=document.createElement("div"),this._adChoicesDiv.className="ad-choices",this._videoSlot.appendChild(this._adChoicesDiv),this._adChoiceIconScript=document.createElement("script"),this._adChoiceIconScript.src=this._createAdChoiceIconUrl(),this._onAdChoicesLoadedBound=this._onAdChoicesLoaded.bind(this),this._adChoiceIconScript.addEventListener("load",this._onAdChoicesLoadedBound),this._adChoicesDiv.appendChild(this._adChoiceIconScript)}},{key:"_onAdChoicesLoaded",value:function(){var e=this._adChoiceIconScript.ownerDocument.defaultView;console.log("onAdChoicesLoaded"),this._adChoiceIconScript.removeEventListener("load",this._onAdChoicesLoadedBound),this._adChoicesIcon=new e.AdChoicesIcon,this._onAdChoiceEventBound=this._onAdChoiceEvent.bind(this),this._adChoicesIcon.addEventListener(h,this._onAdChoiceEventBound),this._adChoicesIcon.addEventListener(f,this._onAdChoiceEventBound)}},{key:"_createAdChoiceIconUrl",value:function(){var e=a.default.file.adchoicesicon;e=e+"?iconPosition="+this._iconPosition+"&optOut="+encodeURIComponent(this._optout)+"&iconClick="+encodeURIComponent(this._iconClick)+"&playerWidth="+this._playerAttributes.macros.width+"&playerHeight="+this._playerAttributes.macros.height+"&sources=";for(var t=0;t<this._sources.length;t++)t===this._sources.length-1?e+=this._sources[t]:e+=this._sources[t]+",";return e+="&country=us"}},{key:"_onAdChoiceEvent",value:function(e){"adChoiceIconExpanded"===e.type?(this._adWasPlaying=this._playerAttributes.macros.adPlaying,this._adChoiceExpanded=!0):this._adChoiceExpanded=!1,this.emit("adChoicesEvent",e.type)}},{key:"clearAdChoicesIcon",value:function(){this._adChoicesTimeout&&(clearTimeout(this._adChoicesTimeout),this._adChoicesTimeout=null),this._adChoicesIcon&&(this._adChoicesIcon.removeEventListener(h,this._onAdChoiceEventBound),this._adChoicesIcon.removeEventListener(f,this._onAdChoiceEventBound),this._adChoicesIcon.destroy(),this._videoSlot.removeChild(this._adChoicesDiv),this._adChoicesDiv=null,this._adChoicesIcon=null)}},{key:"minimizeAdChoicesIcon",value:function(){if(this._adChoicesIcon&&this._adChoiceExpanded)try{this._adChoicesIcon.minimize()}catch(e){console.warn("There was an adChoices minimization issue.")}}},{key:"onAdSizeChanged",value:function(e){this._adChoicesIcon&&this._adChoicesIcon.setSize(e.macros.width,e.macros.height)}},{key:"adChoiceExpanded",get:function(){return this._adChoiceExpanded}},{key:"adWasPlaying",get:function(){return this._adWasPlaying}}])&&l(e.prototype,t),i&&l(e,i),n}();i.default=p},{"../util/Dependencies":65,"../util/getTextContent":73,events:4}],53:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(e("../util/getTextContent")),o=r(e("./survey/Survey")),a=r(e("./survey/VizuSurvey")),s=r(e("./AdChoices")),l=r(e("./SkipAd")),u=r(e("./Viewability")),c=r(e("./AcudeoTracking"));function r(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.adObject=e,this.viewabilityExtension=null,this.viewabilityInitialized=!1,this.viewability=null}var e,i,r;return e=t,(i=[{key:"handleExtendedProperties",value:function(e){var t={};if(void 0!==e.ExtendedProperties)if(0<e.ExtendedProperties.Property.length){this.adObject.extendedProperties={};for(var i=0;i<e.ExtendedProperties.Property.length;i++)this.adObject.extendedProperties[e.ExtendedProperties.Property[i].Name]=(0,n.default)(e.ExtendedProperties.Property[i]),this.adObject.macros[e.ExtendedProperties.Property[i].Name]=(0,n.default)(e.ExtendedProperties.Property[i]),"VizuSurvey"===e.ExtendedProperties.Property[i].Name&&(t.survey=new a.default(this.adObject.extendedProperties.VizuSurvey));!this.viewabilityInitialized&&this.viewabilityExtension&&this.handleViewability(this.viewabilityExtension)}else void 0!==e.ExtendedProperties.Property&&("VizuSurvey"===e.ExtendedProperties.Property.Name?t.survey=new a.default((0,n.default)(e.ExtendedProperties.Property)):"DynamicLogicSurvey"===e.ExtendedProperties.Property.Name&&(t.survey=new o.default((0,n.default)(e.ExtendedProperties.Property))));return t}},{key:"handleRmlLogic",value:function(e){e.RMLLogic&&e.RMLLogic.PlayerName&&-1<(0,n.default)(e.RMLLogic.PlayerName).indexOf("nativead")&&(this.adObject.isInOutstreamEnv=!0)}},{key:"handleBehaviorData",value:function(e){if(e.BehaviorData)return new s.default(e.BehaviorData,this.adObject)}},{key:"handleAcudeoTracking",value:function(e){if(e.Acudeo&&e.Acudeo.Tracking)return new c.default(e)}},{key:"handleSkipAd",value:function(e){if(e.SkipAd)return new l.default(e.SkipAd,this.adObject)}},{key:"handleViewability",value:function(e){if(e.Viewability){if(this.adObject.extendedProperties&&!this.viewabilityInitialized)return this.viewabilityInitialized=!0,this.viewabilityExtension=null,this.viewability=new u.default(e.Viewability,this.adObject.extendedProperties),this.viewability;this.viewabilityExtension=e,this.viewabilityInitialized=!1}}},{key:"getViewability",value:function(){return this.viewability}},{key:"handleDomainValidation",value:function(e){e.DomainValidation&&console.log("TBD - domain validation")}}])&&d(e.prototype,i),r&&d(e,r),t}();i.default=h},{"../util/getTextContent":73,"./AcudeoTracking":51,"./AdChoices":52,"./SkipAd":54,"./Viewability":56,"./survey/Survey":60,"./survey/VizuSurvey":61}],54:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(e("../util/getTextContent")),o=e("events"),a=r(e("../util/Dependencies"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h="SkipClicked",f=function(){function r(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),console.log("Skip Ad Data"),(i=u(this,c(r).call(this)))._playerAttributes=t,i._skipAdDelay=(0,n.default)(e.SkipAdDuration)?1e3*(0,n.default)(e.SkipAdDuration):5e3,i._enabled=e.Enabled,i._skipPixel=(0,n.default)(e.Event),i}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,o.EventEmitter),e=r,(t=[{key:"displaySkipAdIcon",value:function(e){this._videoSlot=e,this._addSkipAdIcon()}},{key:"_addSkipAdIcon",value:function(){console.log("Add Skip Ad icon"),this._skipAdDiv=document.createElement("div"),this._skipAdDiv.className="skip-ad",this._videoSlot.appendChild(this._skipAdDiv),this._skipAdScript=document.createElement("script"),this._skipAdScript.src=this._createSkipAdIconUrl(),this._onSkipAdLoadedBound=this._onSkipAdLoaded.bind(this),this._skipAdScript.addEventListener("load",this._onSkipAdLoadedBound),this._skipAdDiv.appendChild(this._skipAdScript)}},{key:"_onSkipAdLoaded",value:function(){var e=this._skipAdScript.ownerDocument.defaultView;console.log("onSkipAdLoaded"),this._skipAdScript.removeEventListener("load",this._onSkipAdLoadedBound),this._skipAdIcon=new e.SkipAdIcon,this._onSkipAdClickedBound=this._onSkipAdClicked.bind(this),this._skipAdIcon.addEventListener(h,this._onSkipAdClickedBound)}},{key:"_createSkipAdIconUrl",value:function(){var e=a.default.file.selectviewicon;return e=e+"?playerWidth="+this._playerAttributes.macros.width+"&playerHeight="+this._playerAttributes.macros.height+"&skipAdDelay="+this._skipAdDelay}},{key:"_onSkipAdClicked",value:function(e){this.emit("skipAdEvent",e.type)}},{key:"clearSkipAdIcon",value:function(){void 0!==this._skipAdTimeout&&(clearTimeout(this._skipAdTimeout),this._skipAdTimeout=void 0),void 0!==this._skipAdIcon&&(this._skipAdIcon.removeEventListener(h,this._onSkipAdClickedBound),this._skipAdIcon.destroy(),this._videoSlot.removeChild(this._skipAdDiv),this._skipAdDiv=null,this._skipAdIcon=null)}},{key:"onAdSizeChanged",value:function(e){void 0!==this._skipAdIcon&&this._skipAdIcon.setSize(e.macros.width,e.macros.height)}}])&&l(e.prototype,t),i&&l(e,i),r}();i.default=f},{"../util/Dependencies":65,"../util/getTextContent":73,events:4}],55:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("events");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,s(e).apply(this,arguments))}var t,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(e,n.EventEmitter),t=e,(i=[{key:"onIASViewableEvent",value:function(e){this.emit("iasViewable",e)}}])&&o(t.prototype,i),r&&o(t,r),e}();i.default=u},{events:4}],56:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(e("../util/getTextContent")),l=r(e("../vendor/__IASVANS_3.3.0")),u=r(e("../vendor/MoatAnalytics")),o=r(e("../util/IntersectionObserverPolyfill")),a=e("events");function r(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(){function r(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t=d(this,h(r).call(this)),console.log("Viewability"),t._openVVEnabled=!1,t._adtricityEnabled=!1,t._iasEnabled=!1,t._moatEnabled=!1,t._extendedProps=i,t._playerViewability=0,t._viewabilityAvailable="0",null!==e&&(t._providerName=e.Provider.Name,t._enabled=e.Provider.Enable||e.Provider.enable,void 0!==e.Provider.Property&&"tagurl"===e.Provider.Property.Name&&(t._tagUrl=(0,n.default)(e.Provider.Property)),void 0!==e.Provider.Type&&(t._viewableImpressionType=e.Provider.Type),"true"===t._enabled.toLowerCase()&&("doubleverify"===t._providerName?t._openVVEnabled=!0:t._providerName)),t}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,a.EventEmitter),e=r,(t=[{key:"initializeViewability",value:function(e,t,i,r){if(this._initTremorViewability(e,t,r),this.thirdPartyEnabled)if(!0===this._iasEnabled&&void 0!==this._extendedProps){console.log("================== IAS ENABLED ===================");var n=e;this._cmInstance=new l.default;var o={anId:"10381",partner:"TremorVideo",advId:this._extendedProps.level1,campId:this._extendedProps.level2,placementId:this._extendedProps.level3,pubId:this._extendedProps.level4,siteId:this._extendedProps.slicer1,chanId:this._extendedProps.slicer2};this._cmInstance.initCM(o,n)}else if(this._openVVEnabled&&this._tagUrl){console.log("================== DV ENABLED ===================");var a=document.createElement("script");0<this._tagUrl.indexOf("?")?this._tagUrl+="&DVP_GVACB=getTremorVPAIDAd":this._tagUrl+="?DVP_GVACB=getTremorVPAIDAd",a.src=this._tagUrl,document.body.appendChild(a)}else if(this._moatEnabled&&void 0!==this._extendedProps){console.log("================== MOAT ENABLED ===================");var s={level1:this._extendedProps.level1,level2:this._extendedProps.level2,level3:this._extendedProps.level3,level4:this._extendedProps.level4,slicer1:this._extendedProps.slicer1,zMoatSite:this._extendedProps.rtbSiteId,zMoatPub:this._extendedProps.rtbPubId,zMoatExchange:this._extendedProps.rtbExchangeId};this._moatApiReference=(0,u.default)(t,s,i.duration,"tremorvideojsintegration660564236102",null,this._onMOATViewableEvent.bind(this))}}},{key:"_initTremorViewability",value:function(e,t,i){var r;if(this._viewabilityAvailable="1",1===e.nodeType)r=e;else{if(1!==t.nodeType)return console.warn("Could not find a suitable Element to observe for viewability!!!");r=t}"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?this._initIntersectionObserver(r,i):this.polyfill=new o.default(r,this,i)}},{key:"_initIntersectionObserver",value:function(e,t){var i=this;this._observer=new IntersectionObserver(function(e){i._playerViewability=e[0].intersectionRatio,i._ran||(i._ran=!0,t()),console.log("JS code entry.intersectionRatio = "+i._playerViewability)},{threshold:[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.2,.3,.4,.5,.6,.7,.8,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1]}),this._observer.observe(e)}},{key:"_onMOATViewableEvent",value:function(e){console.log("moat event emitted"),this.emit("moatViewable",e)}},{key:"_removeIntersectionObserver",value:function(){this.polyfill?this.polyfill.disconnect():this._observer.disconnect()}},{key:"thirdPartyEnabled",get:function(){return this._openVVEnabled||this._adtricityEnabled||this._iasEnabled||this._moatEnabled}},{key:"viewabilityAvailable",get:function(){return this._viewabilityAvailable}},{key:"playerViewability",get:function(){return Math.round(100*this._playerViewability)/100}},{key:"cmInstance",get:function(){return this._cmInstance}},{key:"moatApiReference",get:function(){return this._moatApiReference}},{key:"viewableImpressionType",get:function(){return this._viewableImpressionType}},{key:"iasEnabled",get:function(){return this._iasEnabled}},{key:"moatEnabled",get:function(){return this._moatEnabled}}])&&c(e.prototype,t),i&&c(e,i),r}();i.default=p},{"../util/IntersectionObserverPolyfill":68,"../util/getTextContent":73,"../vendor/MoatAnalytics":74,"../vendor/__IASVANS_3.3.0":75,events:4}],57:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=Object.seal({macros:{width:null,height:null,viewMode:null,adPlaying:null,currentTime:0,adDuration:null,isViewabilityAvailable:null,averageViewable:null,percentOfTotalViewable:null,pageViewable:null,mlVersion:null,hidden:null,volume:null,engagementOccured:null,cachebuster:null,dspWinPrice:void 0},playerTime:0,delegate:null,debugMode:!1,viewableImpressionFired:null,viewableCompletionPercent:100,skippableState:!1,loadingProtocol:null,extendedProperties:null,videoClickThroughURI:null,videoClickThroughId:null,desiredBitrate:null,creativeData:null,environmentVars:null,adComplete:!1,adSkipped:!1,adStartedFired:!1,adCompleteFired:!1,view25Fired:!1,view50Fired:!1,view75Fired:!1,viewCompletionFired:!1,timeBaseCompletionValue:30,timeBaseCompletionFired:!1,isInOutstreamEnv:!1});i.default=r},{}],58:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={MODE_UNKNOWN:-1,MODE_EMBEDDED_VPAID:1,MODE_VIDEO:2}},{}],59:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,n=(r=e("./modes"))&&r.__esModule?r:{default:r};var o,a,s,l=!1,u=!1;function c(){l?u||a.setPaused(!1):l=!0,u=!0}function d(){l&&!o.ended&&u&&a.setPaused(!0),u=!1}function h(){l=u=!0}function f(){s===n.default.MODE_VIDEO&&a.complete(),p()}function p(){o.removeEventListener("ended",f),o.removeEventListener("pause",d),o.removeEventListener("play",c),o.removeEventListener("playing",h)}var v={init:function(e,t,i){a=t,s=i,(o=e).addEventListener("ended",f),o.addEventListener("pause",d),o.addEventListener("play",c),o.addEventListener("playing",h)},removeListeners:p};i.default=v},{"./modes":58}],60:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("events");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(){function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a(this,s(i).call(this)))._name=e.name,t._surveyUrl=e.url,console.log("name "+t._name),t}var e,t,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(i,n.EventEmitter),e=i,(t=[{key:"render",value:function(e){console.log("Render Survey"),this._videoObj=e}},{key:"resizeSurvey",value:function(e,t,i){console.log("Resize Survey"),this.resizeAd(e,t,i)}},{key:"_surveyError",value:function(){console.log("_surveyError")}},{key:"_surveyLoadTimeout",value:function(){console.log("_surveyLoadTimeout")}},{key:"exists",get:function(){return!0}}])&&o(e.prototype,t),r&&o(e,r),i}();i.default=u},{events:4}],61:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(e("./Survey")),o=r(e("../../util/HTMLElement"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e,t,i){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t={name:"VizuSurvey",url:e};return l(this,c(r).call(this,t))}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,n.default),e=r,(t=[{key:"render",value:function(e){console.log("Render Vizu Survey"),this._videoObj=e,this._videoSlot=e.videoSlot,this._extendedProperties=e.extendedProperties,this._videoObj.width<300||this._videoObj.height<300?this.emit("surveyEvent","SurveyDone"):(this._vizuSurveyDiv=document.createElement("div"),this._vizuSurveyDiv.className="vizusurvey",this._videoSlot.appendChild(this._vizuSurveyDiv),this._vizuSurveyIframe=o.default.createIframe(this._vizuSurveyDiv,"about:blank"),this._vizuSurveyIframe.onload=this._onSurveyIframeLoad.bind(this),this._vizuSurveyIframe.id="vizu-survey",this._vizuSurveyDiv.appendChild(this._vizuSurveyIframe))}},{key:"_onSurveyIframeLoad",value:function(){this._surveyScript=o.default.createScript(this._surveyUrl,this._onSurveyScriptLoad.bind(this),this._onSurveyScriptError.bind(this)),this._vizuSurveyIframe.contentWindow.document.body.appendChild(this._surveyScript)}},{key:"_onSurveyScriptLoad",value:function(){console.log("_onSurveyScriptLoad"),this._surveyScript.onload=null,this._surveyScript.onerror=null,this._vizuSurveyIframe.contentWindow.getVPAIDAd?(this._vizuSurvey=this._vizuSurveyIframe.contentWindow.getVPAIDAd(),this._vizuSurvey.subscribe(this._onVizuSurveyLoaded,"AdLoaded",this),this._vizuSurvey.subscribe(this._onVizuSurveyStarted,"AdStarted",this),this._vizuSurvey.subscribe(this._onVizuSurveyStopped,"AdStopped",this),console.log("calling initAd"),this._vizuSurvey.initAd(this._videoObj.width,this._videoObj.height,"normal",-1,{},{slot:this._videoSlot})):this._onSurveyScriptError()}},{key:"_onSurveyScriptError",value:function(){this._surveyScript.onload=null,this._surveyScript.onerror=null,this._vizuSurveyCleanup(),this.emit("surveyEvent","SurveyDone")}},{key:"resizeSurvey",value:function(e,t,i){console.log("Resize Vizu Survey"),u(c(r.prototype),"resizeSurvey",this).call(this._vizuSurvey,e,t,i)}},{key:"_onVizuSurveyLoaded",value:function(){console.log("_onVizuSurveyLoaded"),this._vizuSurvey.startAd()}},{key:"_onVizuSurveyStarted",value:function(){console.log("_onVizuSurveyStarted"),this.displayed=!0}},{key:"_onVizuSurveyStopped",value:function(){console.log("_onVizuSurveyStopped"),this.displayed=!1,this._vizuSurveyCleanup(),this.emit("surveyEvent","SurveyDone")}},{key:"_vizuSurveyCleanup",value:function(){this._vizuSurvey&&(this._vizuSurvey.unsubscribe("AdLoaded"),this._vizuSurvey.unsubscribe("AdStarted"),this._vizuSurvey.unsubscribe("AdStopped")),this._videoSlot.removeChild(this._vizuSurveyDiv),this._vizuSurveyIframe=null,this._vizuSurveyDiv=null,this._vizuSurvey=null}}])&&s(e.prototype,t),i&&s(e,i),r}();i.default=h},{"../../util/HTMLElement":66,"./Survey":60}],62:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=Object.freeze({AD_CREATIVE_VIEW:"creativeView",AD_STARTED:"start",AD_VIDEO_FIRST_QUARTILE:"firstQuartile",AD_VIDEO_MIDPOINT:"midpoint",AD_VIDEO_THIRD_QUARTILE:"thirdQuartile",AD_VIDEO_COMPLETE:"complete",AD_PAUSED:"pause",AD_PLAYING:"resume",AD_REWIND:"rewind",AD_SKIPPED:"skip",AD_CLOSE:"close",AD_CLOSE_LINEAR:"closeLinear"});i.default=r},{}],63:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=Object.freeze({AD_LOADED:"AdLoaded",AD_STARTED:"AdStarted",AD_STOPPED:"AdStopped",AD_SKIPPED:"AdSkipped",AD_SKIPPABLE_STATE_CHANGE:"AdSkippableStateChange",AD_SIZE_CHANGE:"AdSizeChange",AD_LINEAR_CHANGE:"AdLinearChange",AD_DURATION_CHANGE:"AdDurationChange",AD_EXPANDED_CHANGE:"AdExpandedChange",AD_REMAINING_TIME_CHANGE:"AdRemainingTimeChange",AD_VOLUME_CHANGE:"AdVolumeChange",AD_IMPRESSION:"AdImpression",AD_VIDEO_START:"AdVideoStart",AD_VIDEO_FIRST_QUARTILE:"AdVideoFirstQuartile",AD_VIDEO_MIDPOINT:"AdVideoMidpoint",AD_VIDEO_THIRD_QUARTILE:"AdVideoThirdQuartile",AD_VIDEO_COMPLETE:"AdVideoComplete",AD_CLICK_THRU:"AdClickThru",AD_INTERACTION:"AdInteraction",AD_USER_ACCEPT_INVITATION:"AdUserAcceptInvitation",AD_USER_MINIMIZE:"AdUserMinimize",AD_USER_CLOSE:"AdUserClose",AD_PAUSED:"AdPaused",AD_PLAYING:"AdPlaying",AD_LOG:"AdLog",AD_ERROR:"AdError"});i.default=r},{}],64:[function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=function(){function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var t={};return 0<e.childNodes.length&&this._parseNode(e,t),t}var e,t,r;return e=i,(t=[{key:"_isArray",value:function(e){return"[object Array]"===Object.prototype.toString.apply(e)}},{key:"_parseNode",value:function(e,t){if("#text"!==e.nodeName||""!==e.nodeValue.trim()){var i={};i.textContent=e.textContent.trim();var r=t[e.nodeName];if(r?this._isArray(r)?t[e.nodeName].push(i):t[e.nodeName]=[r,i]:("#cdata-section"!==e.nodeName&&"#text"!==e.nodeName&&delete i.textContent,t[e.nodeName]=i),e.attributes)for(var n=e.attributes.length,o=0;o<n;o++){var a=e.attributes[o];i[a.nodeName]=a.nodeValue}var s=e.childNodes.length;if(0<s)for(var l=0;l<s;l++)this._parseNode(e.childNodes[l],i)}}}])&&n(e.prototype,t),r&&n(e,r),i}();i.default=r},{}],65:[function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o="//objects-secure.videohub.tv/net/js/",a="//objects-stage.videohub.tv/net/js/",s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,r;return t=e,r=[{key:"setHost",value:function(e){this._host=-1<e.indexOf(a)?a:o}},{key:"file",get:function(){return{adchoicesicon:this._host+"adchoicesicon.min.js",selectviewicon:this._host+"selectviewicon.min.js",ioPolyfill:this._host+"io-polyfill-0.5.1.js"}}}],(i=null)&&n(t.prototype,i),r&&n(t,r),e}();"object"===(void 0===t?"undefined":r(t))&&t.exports&&(t.exports=s)},{}],66:[function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,r;return t=e,r=[{key:"createAndAppend",value:function(e,t,i){var r=1<arguments.length&&void 0!==t?t:"div",n=2<arguments.length&&void 0!==i?i:null,o=document.createElement(r);return n&&(o.className=n),e.appendChild(o),o}},{key:"getScript",value:function(t){var e,i=document.getElementsByTagName("script"),r=[].slice.call(i).filter(function(e){return-1<e.src.indexOf(t)})[0];if(!r)throw e="Our script cannot be found.",console.error(e),new Error(e);return r.src}},{key:"getAdDataInfo",value:function(e){var t,i=e.indexOf("?"),r={};if(i<0)throw t="Your URL is missing an 'adData' query parameter.",console.error(t),new Error(t);return e.substr(i+"?".length).split("&").forEach(function(e){var t=e.split("=");r[t[0]]=t[1]}),r}},{key:"createScript",value:function(e,t,i){var r=1<arguments.length&&void 0!==t?t:null,n=2<arguments.length&&void 0!==i?i:null,o=document.createElement("script");return o.src=e,o.type="text/javascript",r&&(o.onload=r,o.onerror=n),o}},{key:"createIframe",value:function(e,t,i){var r=1<arguments.length&&void 0!==t?t:"about:blank",n=2<arguments.length&&void 0!==i?i:null,o=document.createElement("iframe");return o.marginWidth=o.marginHeight=o.frameBorder="0",o.width=o.height="100%",o.style.position="absolute",o.style.left=o.style.top="0",o.style.margin=o.style.padding="0px",o.style.border="none",o.setAttribute("SCROLLING","NO"),o.src=r,n&&(o.srcdoc=n),e.innerHTML="",o}},{key:"emptyIframeTextContent",value:function(e){var t=e.contentWindow&&e.contentWindow.document;t&&(t.body.firstChild.nodeValue="")}},{key:"createVideo",value:function(e,t,i){var r=2<arguments.length&&void 0!==i?i:null,n=document.createElement("video");return n.width=e,n.height=t,r&&(n.onload=r),n}}],(i=null)&&n(t.prototype,i),r&&n(t,r),e}();i.default=r},{}],67:[function(e,t,i){"use strict";window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))},{}],68:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=r(e("../util/HTMLElement")),a=r(e("../util/Dependencies"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function n(e,t,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._target=e,this._context=t,this._callback=i,this._postMsgId="viewability_".concat(Date.now()),this._target.className+=" rml-".concat(this._postMsgId),this._script=o.default.createScript(a.default.file.ioPolyfill,function(){r._postMsgScript=document.createElement("script"),r._postMsgScript.type="text/javascript",r._postMsgScript.innerHTML='\n        var observer = new IntersectionObserver(\n          function (entries) {\n            postMessage(\n              {\n                id: "'.concat(r._postMsgId,'",\n                intersectionRatio: entries[0].intersectionRatio\n              },\n              "*"\n            );\n          },\n          {\n            threshold: [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1]\n          }\n        );\n\n        observer.observe(document.querySelector(".rml-').concat(r._postMsgId,'"));\n      '),r._target.appendChild(r._postMsgScript)}),this._scriptLoadFn=this._onScriptLoad.bind(this),this._script.addEventListener("load",this._scriptLoadFn),this._scriptErrorFn=this._onScriptError.bind(this),this._script.addEventListener("error",this._scriptErrorFn),this._postMessageFn=this._onPostMessage.bind(this),this._target.ownerDocument.defaultView.addEventListener("message",this._postMessageFn),this._target.appendChild(this._script)}var e,t,i;return e=n,(t=[{key:"_onScriptLoad",value:function(){this._script.removeEventListener("load",this._scriptLoadFn),this._script.removeEventListener("error",this._scriptErrorFn)}},{key:"_onScriptError",value:function(){this._script.removeEventListener("load",this._scriptLoadFn),this._script.removeEventListener("error",this._scriptErrorFn),console.warn("IntersectionObserver polyfill failed to load"),this.disconnect(),this._callback()}},{key:"_onPostMessage",value:function(e){e.data.id===this._postMsgId&&(this._ran||(this._ran=!0,this._callback()),this._context._playerViewability=e.data.intersectionRatio,console.log("JS code entry.intersectionRatio (polyfill) = "+this._context._playerViewability))}},{key:"disconnect",value:function(){this._target.ownerDocument.defaultView.removeEventListener("message",this._postMessageFn),this._postMsgScript&&(this._postMsgScript.innerHTML+="observer.disconnect();",this._target.removeChild(this._postMsgScript)),this._target.removeChild(this._script)}}])&&s(e.prototype,t),i&&s(e,i),n}();i.default=n},{"../util/Dependencies":65,"../util/HTMLElement":66}],69:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,n=(r=e("./ConvertXML"))&&r.__esModule?r:{default:r};function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,r;return t=e,(i=[{key:"parseExtensions",value:function(e){return e.__proto__.parseExtensions=function(e,t){var i=new n.default(t[0].parentNode);e.push(i)},this}},{key:"onComplete",value:function(e,t){e.__proto__.complete=t}},{key:"parseAdURIs",value:function(i){var r=this,n=i.__proto__.parseNodeText;return i.__proto__.parseNodeText=function(e){var t;if(e)switch(e.nodeName){case"VASTAdTagURI":t=e.textContent.split("?"),e.textContent=decodeURIComponent(t[0])+(t[1]?"?"+t[1]:"");break;case"ClickThrough":r._clickThroughId=e.getAttribute("id")}return n.call(i,e)},this}},{key:"combineCompanions",value:function(t){var i,r=this,n=t.__proto__.parse;return t.__proto__.parse=function(e){return i&&(e=r._combineNodes("CompanionAds",e,i)),i=e,n.call(t,e)},this}},{key:"getClickThroughId",value:function(){return this._clickThroughId}},{key:"_combineNodes",value:function(t,i,e){var r,n=e.getElementsByTagName(t)[0],o=i.getElementsByTagName(t)[0];return"TrackingEvents"===t&&o&&"companion"===o.parentNode.nodeName.toLowerCase()||n&&(o&&0<n.childElementCount?Array.prototype.slice.call(n.childNodes).forEach(function(e){1===e.nodeType&&i.getElementsByTagName(t)[0].appendChild(e)}):(r=this._findCommonParent(i.parentNode,n.parentNode))?r.appendChild(n):console.warn("There is no common parent for the ".concat(t," node."))),i}},{key:"_findCommonParent",value:function(e,t){var i=t.nodeName,r=e.getElementsByTagName(i)[0];return r||("Wrapper"===i?e.getElementsByTagName("InLine")[0]:void this._findCommonParent(e,t.parentNode))}},{key:"addMacrosToTracking",value:function(n,o){var a=this,s=n.__proto__.track;return n.__proto__.track=function(e,t){o.cachebuster=Date.now(),Object.keys(o).forEach(function(e){o[e]&&(t[e]=o[e])});var i=e.filter(function(e){return e.toLowerCase().indexOf("js:")<0});if(e.length!==i.length){var r=e.filter(function(e){return-1<e.toLowerCase().indexOf("js:")});a.trackJSUrls(r)}return s.call(n,i,t)},this}},{key:"trackJSUrls",value:function(e){e.forEach(function(e){var t=document.createElement("script");t.src=e.slice(3),document.body.appendChild(t)})}}])&&o(t.prototype,i),r&&o(t,r),e}();i.default=a},{"./ConvertXML":64}],70:[function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,r;return t=e,r=[{key:"appendToTremorUrls",value:function(e,t){if(void 0!==e&&0<e.length)for(var i=0;i<e.length;i++)-1<e[i].indexOf("videohub.tv")&&(e[i]+=(0<e[i].indexOf("?")?"&":"?")+t);return e}}],(i=null)&&n(t.prototype,i),r&&n(t,r),e}();i.default=r},{}],71:[function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=function(){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}var e,t,i;return e=a,i=[{key:"filterByDisplayWidth",value:function(e,t){var i,r,n=e.slice();if(1<n.length){for(var o=0;o<n.length-1;o++)isNaN(n[o].width)||isNaN(n[o+1].width)||(i=Math.abs(n[o].width-t),(r=Math.abs(n[o+1].width-t))<i?(n.splice(o,1),o=-1):i<r||n[o].width>n[o+1].width?(n.splice(o+1,1),o=-1):n[o].width<n[o+1].width&&(n.splice(o,1),o=-1));return n}return n}},{key:"filterByWidthAndBitrate",value:function(e,t,i){if(!(1<e.length))return e;var r=e.filter(function(e){return e.width==t});if(0<r.length)return a.filterByBitrate(r,i);if(0<(r=e.filter(function(e){return e.width<t})).length){var n=Math.max.apply(Math,r.map(function(e){return e.width}));return r=r.filter(function(e){return e.width==n}),a.filterByBitrate(r,i)}if(0<(r=e.filter(function(e){return e.width>t})).length){var o=Math.min.apply(Math,r.map(function(e){return e.width}));return r=r.filter(function(e){return e.width==o}),a.filterByBitrate(r,i)}}},{key:"filterByBitrate",value:function(e,t){var i,r;if(1<e.length)for(var n=0;n<e.length-1;n++)if(!isNaN(e[n].bitrate)&&!isNaN(e[n+1].bitrate)){if((i=Math.abs(e[n].bitrate-t))==(r=Math.abs(e[n+1].bitrate-t)))return e.splice(n+1,1),e;r<i?(e.splice(n,1),n=-1):i<r&&(e.splice(n+1,1),n=-1)}return e}},{key:"filterByAspectRatio",value:function(e,t,i){var r,n,o,a,s=e.slice(),l=t/i,u=t*i,c=[],d=!1,h=-1;for(a=0;a<s.length;a++)n=s[a].width/s[a].height,isNaN(n)||(d=!0,Math.abs(l-n)<1e-4&&(o=!0));if(!d)return s;if(o)for(a=s.length-1;0<=a;--a)n=s[a].width/s[a].height,1e-4<Math.abs(l-n)&&s.splice(a,1);for(a=0;a<s.length;a++)r=s[a].width*s[a].height,c[a]=r-u;for(a=0;a<c.length;a++)0<=c[a]&&(!(0<=h)||c[a]<c[h])&&(h=a);if(h<0)for(a=h=0;a<c.length;a++)c[a]<c[h]&&(h=a);for(a=c.length-1;0<=a;--a)c[h]!==c[a]&&s.splice(a,1);return s}}],(t=null)&&r(e.prototype,t),i&&r(e,i),a}();i.default=n},{}],72:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e,t){var i=function(e){if(0<e.indexOf("</Impression>")){var t=e.indexOf("<Impression"),i=e.lastIndexOf("</Impression>");return e.slice(t,i+13)}return""}(t),r=function(e){if(0<e.indexOf("</TrackingEvents>")){var t=e.indexOf("<TrackingEvents"),i=e.indexOf("</TrackingEvents>");return e.slice(t,i+17)}return""}(t),n=function(e){if(0<e.indexOf("</VideoClicks>")){var t=e.indexOf("<VideoClicks"),i=e.indexOf("</VideoClicks>");return e.slice(t,i+14)}return""}(t),o=function(e){if(0<e.indexOf("</Extensions>")){var t=e.indexOf("<Extensions"),i=e.indexOf("</Extensions>");return e.slice(t,i+13)}return""}(t),a=function(e){if(0<e.indexOf("</CompanionAds>")){var t=e.indexOf("<CompanionAds"),i=e.indexOf("</CompanionAds>"),r=e.slice(t,i+15);return"<Creative>\n                                ".concat(r,"\n                            </Creative>")}return""}(t),s='<?xml version="1.0" encoding="UTF-8"?>\n                    <VAST version="2.0">\n                      <Ad id="1">\n                        <Wrapper>\n                          <AdSystem>VAST</AdSystem>\n                          <VASTAdTagURI><![CDATA['.concat(e,"]]></VASTAdTagURI>\n                          ").concat(i,'\n                          <Creatives>\n                            <Creative AdID="1">\n                              <Linear>\n                                ').concat(r,"\n                                ").concat(n,"\n                              </Linear>\n                            </Creative>\n                            ").concat(a,"\n                          </Creatives>\n                          ").concat(o,"\n                        </Wrapper>\n                      </Ad>\n                    </VAST>");return(new DOMParser).parseFromString(s,"text/xml")}},{}],73:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){if(void 0!==e){if(void 0!==e["#cdata-section"])return e["#cdata-section"].textContent;if(void 0!==e["#text"])return e["#text"].textContent}return""}},{}],74:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;function r(e,t,i,r,n,o){var a,s,l=document.createElement("script"),u=[];t={adData:{ids:t,duration:i,url:n},dispatchEvent:function(e){this.sendEvent?(u&&(u.push(e),e=u,u=!1),this.sendEvent(e)):u&&u.push(e)},clientCallback:o},i="_moatApi"+Math.floor(1e8*Math.random());try{s=(a=e.ownerDocument).defaultView||a.parentWindow}catch(e){a=document,s=window}return s[i]=t,l.type="text/javascript",e&&e.insertBefore(l,e.childNodes[0]||null),l.src="https://z.moatads.com/"+r+"/moatvideo.js#"+i,t}i.default=r},{}],75:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;function r(a){var t,n,i,o,e,r,s,l,u={now:function(){return(new Date).getTime()},sendMonitoringPixel:function(e){try{this.sendUrlRequest(["//pixel.adsafeprotected.com/mon?anId=10173&campId=",encodeURIComponent(p.getPartnerId()),"&pubId=",encodeURIComponent("vans-js_"+e)].join(""))}catch(e){c.report("smp",e)}},sendUrlRequest:function(e,t){var i,r;if(e){i=this.getWindow();try{r=new i.XMLHttpRequest,t&&(r.onreadystatechange=t),r.open("GET",e),r.send()}catch(e){}}},getWindow:function(){return v.getWin()},getDocument:function(){return v.getDoc()},generateUID:function(){var e,t="";try{for(e=0;e<8;e++)t=[t,Math.floor(65536*(1+Math.random())).toString(16).substring(1)].join("")}catch(e){}return t},noop:function(){}},c={report:function(e,t){if(!l[e])try{l[e]=!0,u.sendUrlRequest(["//pixel.adsafeprotected.com/jsdiagnostic?code:vans-js_",encodeURIComponent(p.getPartnerId()),"_",e,"&err:",encodeURIComponent(t.message)].join(""))}catch(e){}}},d=(r=!(l={}),{getVideoId:s=function(){return e=e||u.generateUID()},setNodeInterface:function(e){var t,i,r=s();try{t="IASid"+r,i="blockAd"+r,e.className+=" integral-vid-"+r,e[i]=u.noop,e[t]=E,e.getVersion=function(){return"3.3.0"}}catch(e){c.report("sni",e)}},isEstablished:function(){return r},resetHandshake:function(){r=!1}}),h={init:function(e,t,i){var r=b();f.sendPerfSample(30),e=function(e,t,i){var r=["//pixel.adsafeprotected.com/db2/video/",t,"/",i,"/skeleton.js?videoId=",d.getVideoId()].join("");t=function(e){r=[r,"&adsafe_url=",e.val,"&adsafe_type=",e.key].join("")};try{e.urls.forEach(t),r=[r,"&adsafe_jsinfo=br:",e.br].join("")}catch(e){c.report("bvu",e)}return r}(r,e,t),o=i,u.sendUrlRequest(e,w)}},f=(i=[],{sendEvent:_,flushUnsentEvents:function(){try{i.forEach(g)}catch(e){c.report("fue",e)}},sendPerfSample:function(e){_("PerfCheckpoint",{type:"vans",code:e,timestamp:u.now()})}}),p={initCM:function(e,t){if(!e.partner)throw Error("missing partnerId");v.setWin(t),f.sendPerfSample(20),n=e.partner;try{if(!e.anId)throw Error("missing anId");u.sendMonitoringPixel("cminit"),d.setNodeInterface(t),y("/jsvid",e,t)}catch(e){c.report("icm",e)}},initFW:function(e,t,i){var r;if(!e.partner)throw Error("missing partnerId");v.setWin(t),f.sendPerfSample(20),n=e.partner;try{if(!e.advEntityId||!e.pubEntityId)throw Error("missing client id: advEntityId: "+e.advEntityId+" ,pubEntityId: "+e.pubEntityId);u.sendMonitoringPixel("fwinit"),i&&h.init(e.advEntityId,e.pubEntityId,i),r="/fwjsvid/st/"+e.advEntityId+"/"+e.pubEntityId+"/skeleton.js",d.setNodeInterface(t),y(r,e,t)}catch(e){c.report("ifw",e)}},getPartnerId:function(){return n}},v=(t=window,{getWin:function(){return t},setWin:function(e){(e=e&&e.ownerDocument)&&e.defaultView?t=e.defaultView:e&&e.parentWindow?t=e.parentWindow:c.report("sc",{message:""})},getDoc:function(){return t.document}});function m(e,t){var i,r,n,o=a||"pixel.adsafeprotected.com";try{i=["//",o,e,"?videoId=",d.getVideoId(),(r=t,n="",Object.keys(r).forEach(function(e){"advEntityId"!=e&&"pubEntityId"!=e&&"partner"!=e&&(n+="&"+e+"="+r[e])}),n)].join("")}catch(e){c.report("bsurl",e)}return i}function y(e,t,i){var r,n=u.getDocument();try{r=n.createElement("script"),r.src=m(e,t),i.parentNode.appendChild(r)}catch(e){u.sendMonitoringPixel("inj_err")}}function g(e){if(d.isEstablished())try{u.getWindow().postMessage(JSON.stringify(e),"*")}catch(e){c.report("dm",e)}else try{i.push(e)}catch(e){c.report("cm",e)}}function _(e,t){try{g({messageType:e,id:d.getVideoId(),time:u.now(),partner:p.getPartnerId(),eventData:t})}catch(e){c.report("se",e)}}function b(){function o(e){return void 0!==e}var e=function(){var e="u";try{o(window.opera)&&o(window.opera.buildNumber)?e="o":o(window.mozInnerScreenY)?e="g":o(window.chrome)&&o(window.chrome.csi)?e="c":o(window.msWriteProfilerMark)&&o(window.crypto)?e="e":o(window.attachEvent)||o(window.msCrypto)?e="i":o(window.WebKitPoint)&&(e="w")}catch(e){}return e}(),t=function(){var e,t=function(){var t={g:"",q:""};try{t.q=window.parent.parent.parent.parent.parent.parent.parent.parent.parent.parent.location.href}catch(e){var i,r=(r=e.message).substring(r.lastIndexOf("<")+1,r.lastIndexOf(">"));if((i=o(r))&&(i=!1,o(window.navigator)&&o(window.navigator.userAgent))){var n=window.navigator.userAgent.match(/Firefox\/([\.0-9]+)/);null!==n&&2==n.length&&(n=n[1].split("."),3==parseInt(n[0],10)&&parseInt(n[1],10)<=6&&(3!=n.length||parseInt(n[2],10)<=13)&&(i=!0))}i&&(t.g=r)}return t},i={};try{i.a=encodeURIComponent(top.location.href)}catch(e){}try{i.b=encodeURIComponent(parent.location.href)}catch(e){}if(window!=top){try{i.c=encodeURIComponent(parent.document.referrer)}catch(e){}try{i.e=encodeURIComponent(window.document.referrer)}catch(e){}}try{i.d=encodeURIComponent(window.location.href)}catch(e){}try{var r=t();i.g=encodeURIComponent(r.g),i.q=encodeURIComponent(r.q)}catch(e){}for(e in i=function(e){var t,i,r={};for(i in e)e.hasOwnProperty(i)&&(t=e[i],o(r[t])?r[t]+=i:r[t]=i);for(i in e={},r)r.hasOwnProperty(i)&&(e[t=r[i]]=i);return e}(i=function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];""!==i&&"null"!==i&&"undefined"!==i&&null!==i&&o(i)||delete e[t]}return e}(i)),t=[],i)i.hasOwnProperty(e)&&t.push({key:e,val:i[e]});return t.sort(function(e,t){return e.val.length>t.val.length?1:e.val.length<t.val.length?-1:0}),t}();return{br:e,urls:t}}function w(){if(4==this.readyState)if(f.sendPerfSample(40),200==this.status)try{o("failed"===JSON.parse(this.responseText).action?"block":"safe")}catch(e){c.report("ba",e)}else c.report("blk_url_req_err",{message:this.status})}function E(e){return e==s()&&(r=!0,f.flushUnsentEvents()),r?"jv3":null}return f.sendPerfSample(10),{initFW:p.initFW,initCM:p.initCM,sendEvent:f.sendEvent}}i.default=r},{}],76:[function(e,t,i){"use strict";var r,n=(r=e("./LinearDelegate"))&&r.__esModule?r:{default:r};window.getVPAIDAd=function(){return new n.default}},{"./LinearDelegate":50}],77:[function(e,t,i){t.exports={shasum:"a2a4c83",branch:"HEAD",version:"1.27.0"}},{}]},{},[76]);