(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){window.ConsentString=require("consent-string").ConsentString},{"consent-string":6}],2:[function(require,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports;var freeModule=typeof module=="object"&&module&&module.exports==freeExports&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){root=freeGlobal}var InvalidCharacterError=function(message){this.message=message};InvalidCharacterError.prototype=new Error;InvalidCharacterError.prototype.name="InvalidCharacterError";var error=function(message){throw new InvalidCharacterError(message)};var TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var REGEX_SPACE_CHARACTERS=/[\t\n\f\r ]/g;var decode=function(input){input=String(input).replace(REGEX_SPACE_CHARACTERS,"");var length=input.length;if(length%4==0){input=input.replace(/==?$/,"");length=input.length}if(length%4==1||/[^+a-zA-Z0-9/]/.test(input)){error("Invalid character: the string to be decoded is not correctly encoded.")}var bitCounter=0;var bitStorage;var buffer;var output="";var position=-1;while(++position<length){buffer=TABLE.indexOf(input.charAt(position));bitStorage=bitCounter%4?bitStorage*64+buffer:buffer;if(bitCounter++%4){output+=String.fromCharCode(255&bitStorage>>(-2*bitCounter&6))}}return output};var encode=function(input){input=String(input);if(/[^\0-\xFF]/.test(input)){error("The string to be encoded contains characters outside of the "+"Latin1 range.")}var padding=input.length%3;var output="";var position=-1;var a;var b;var c;var d;var buffer;var length=input.length-padding;while(++position<length){a=input.charCodeAt(position)<<16;b=input.charCodeAt(++position)<<8;c=input.charCodeAt(++position);buffer=a+b+c;output+=TABLE.charAt(buffer>>18&63)+TABLE.charAt(buffer>>12&63)+TABLE.charAt(buffer>>6&63)+TABLE.charAt(buffer&63)}if(padding==2){a=input.charCodeAt(position)<<8;b=input.charCodeAt(++position);buffer=a+b;output+=TABLE.charAt(buffer>>10)+TABLE.charAt(buffer>>4&63)+TABLE.charAt(buffer<<2&63)+"="}else if(padding==1){buffer=input.charCodeAt(position);output+=TABLE.charAt(buffer>>2)+TABLE.charAt(buffer<<4&63)+"=="}return output};var base64={encode:encode,decode:decode,version:"0.1.0"};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(function(){return base64})}else if(freeExports&&!freeExports.nodeType){if(freeModule){freeModule.exports=base64}else{for(var key in base64){base64.hasOwnProperty(key)&&(freeExports[key]=base64[key])}}}else{root.base64=base64}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],3:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _require=require("./encode"),encodeConsentString=_require.encodeConsentString,_getMaxVendorId=_require.getMaxVendorId,encodeVendorIdsToBits=_require.encodeVendorIdsToBits,encodePurposeIdsToBits=_require.encodePurposeIdsToBits;var _require2=require("./decode"),decodeConsentString=_require2.decodeConsentString;var _require3=require("./utils/definitions"),vendorVersionMap=_require3.vendorVersionMap;var consentLanguageRegexp=/^[a-z]{2}$/;var cachedString=void 0;var ConsentString=function(){function ConsentString(){var baseString=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;_classCallCheck(this,ConsentString);this.maxVendorId=0;this.created=new Date;this.lastUpdated=new Date;this.version=1;this.vendorList=null;this.vendorListVersion=null;this.cmpId=null;this.cmpVersion=null;this.consentScreen=null;this.consentLanguage=null;this.allowedPurposeIds=[];this.allowedVendorIds=[];if(baseString){cachedString=baseString;Object.assign(this,decodeConsentString(baseString))}}_createClass(ConsentString,[{key:"getConsentString",value:function getConsentString(){var updateDate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var retr=void 0;if(cachedString&&!updateDate){retr=cachedString}else{if(!this.vendorList){throw new Error("ConsentString - A vendor list is required to encode a consent string")}if(updateDate===true){this.lastUpdated=new Date}retr=encodeConsentString({version:this.getVersion(),vendorList:this.vendorList,allowedPurposeIds:this.allowedPurposeIds,allowedVendorIds:this.allowedVendorIds,created:this.created,lastUpdated:this.lastUpdated,cmpId:this.cmpId,cmpVersion:this.cmpVersion,consentScreen:this.consentScreen,consentLanguage:this.consentLanguage,vendorListVersion:this.vendorListVersion});cachedString=retr}return retr}},{key:"getLastUpdated",value:function getLastUpdated(){return this.lastUpdated}},{key:"setLastUpdated",value:function setLastUpdated(){var date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;cachedString="";if(date){this.lastUpdated=new Date(date)}else{this.lastUpdated=new Date}}},{key:"getCreated",value:function getCreated(){return this.created}},{key:"setCreated",value:function setCreated(){var date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;cachedString="";if(date){this.created=new Date(date)}else{this.created=new Date}}},{key:"getMaxVendorId",value:function getMaxVendorId(){if(!this.maxVendorId){if(this.vendorList){this.maxVendorId=_getMaxVendorId(this.vendorList.vendors)}}return this.maxVendorId}},{key:"getParsedVendorConsents",value:function getParsedVendorConsents(){return encodeVendorIdsToBits(_getMaxVendorId(this.vendorList.vendors),this.allowedVendorIds)}},{key:"getParsedPurposeConsents",value:function getParsedPurposeConsents(){return encodePurposeIdsToBits(this.vendorList.purposes,this.allowedPurposeIds)}},{key:"getMetadataString",value:function getMetadataString(){return encodeConsentString({version:this.getVersion(),created:this.created,lastUpdated:this.lastUpdated,cmpId:this.cmpId,cmpVersion:this.cmpVersion,consentScreen:this.consentScreen,vendorListVersion:this.vendorListVersion})}},{key:"getVersion",value:function getVersion(){return this.version}},{key:"getVendorListVersion",value:function getVendorListVersion(){return this.vendorListVersion}},{key:"setGlobalVendorList",value:function setGlobalVendorList(vendorList){if((typeof vendorList==="undefined"?"undefined":_typeof(vendorList))!=="object"){throw new Error("ConsentString - You must provide an object when setting the global vendor list")}if(!vendorList.vendorListVersion||!Array.isArray(vendorList.purposes)||!Array.isArray(vendorList.vendors)){throw new Error("ConsentString - The provided vendor list does not respect the schema from the IAB EUâ€™s GDPR Consent and Transparency Framework")}if(!this.vendorList||this.vendorListVersion!==vendorList.vendorListVersion){cachedString="";this.vendorList={vendorListVersion:vendorList.vendorListVersion,lastUpdated:vendorList.lastUpdated,purposes:vendorList.purposes,features:vendorList.features,vendors:vendorList.vendors.slice(0).sort(function(firstVendor,secondVendor){return firstVendor.id<secondVendor.id?-1:1})};this.vendorListVersion=vendorList.vendorListVersion}}},{key:"getGlobalVendorList",value:function getGlobalVendorList(){return this.vendorList}},{key:"setCmpId",value:function setCmpId(id){if(id!==this.cmpId){cachedString="";this.cmpId=id}}},{key:"getCmpId",value:function getCmpId(){return this.cmpId}},{key:"setCmpVersion",value:function setCmpVersion(version){if(version!==this.cmpVersion){cachedString="";this.cmpVersion=version}}},{key:"getCmpVersion",value:function getCmpVersion(){return this.cmpVersion}},{key:"setConsentScreen",value:function setConsentScreen(screenId){if(screenId!==this.consentScreen){cachedString="";this.consentScreen=screenId}}},{key:"getConsentScreen",value:function getConsentScreen(){return this.consentScreen}},{key:"setConsentLanguage",value:function setConsentLanguage(language){if(consentLanguageRegexp.test(language)===false){throw new Error("ConsentString - The consent language must be a two-letter ISO639-1 code (en, fr, de, etc.)")}if(language!==this.consentLanguage){cachedString="";this.consentLanguage=language}}},{key:"getConsentLanguage",value:function getConsentLanguage(){return this.consentLanguage}},{key:"setPurposesAllowed",value:function setPurposesAllowed(purposeIds){cachedString="";this.allowedPurposeIds=purposeIds}},{key:"getPurposesAllowed",value:function getPurposesAllowed(){return this.allowedPurposeIds}},{key:"setPurposeAllowed",value:function setPurposeAllowed(purposeId,value){var purposeIndex=this.allowedPurposeIds.indexOf(purposeId);cachedString="";if(value===true){if(purposeIndex===-1){this.allowedPurposeIds.push(purposeId)}}else if(value===false){if(purposeIndex!==-1){this.allowedPurposeIds.splice(purposeIndex,1)}}}},{key:"isPurposeAllowed",value:function isPurposeAllowed(purposeId){return this.allowedPurposeIds.indexOf(purposeId)!==-1}},{key:"setVendorsAllowed",value:function setVendorsAllowed(vendorIds){cachedString="";this.allowedVendorIds=vendorIds}},{key:"getVendorsAllowed",value:function getVendorsAllowed(){return this.allowedVendorIds}},{key:"setVendorAllowed",value:function setVendorAllowed(vendorId,value){var vendorIndex=this.allowedVendorIds.indexOf(vendorId);cachedString="";if(value===true){if(vendorIndex===-1){this.allowedVendorIds.push(vendorId)}}else if(value===false){if(vendorIndex!==-1){this.allowedVendorIds.splice(vendorIndex,1)}}}},{key:"isVendorAllowed",value:function isVendorAllowed(vendorId){return this.allowedVendorIds.indexOf(vendorId)!==-1}}],[{key:"decodeMetadataString",value:function decodeMetadataString(encodedMetadata){var decodedString=decodeConsentString(encodedMetadata);var metadata={};vendorVersionMap[decodedString.version].metadataFields.forEach(function(field){metadata[field]=decodedString[field]});return metadata}}]);return ConsentString}();module.exports={ConsentString:ConsentString}},{"./decode":4,"./encode":5,"./utils/definitions":8}],4:[function(require,module,exports){"use strict";var _require=require("./utils/bits"),decodeBitsToIds=_require.decodeBitsToIds,decodeFromBase64=_require.decodeFromBase64;function decodeConsentString(consentString){var _decodeFromBase=decodeFromBase64(consentString),version=_decodeFromBase.version,cmpId=_decodeFromBase.cmpId,vendorListVersion=_decodeFromBase.vendorListVersion,purposeIdBitString=_decodeFromBase.purposeIdBitString,maxVendorId=_decodeFromBase.maxVendorId,created=_decodeFromBase.created,lastUpdated=_decodeFromBase.lastUpdated,isRange=_decodeFromBase.isRange,defaultConsent=_decodeFromBase.defaultConsent,vendorIdBitString=_decodeFromBase.vendorIdBitString,vendorRangeList=_decodeFromBase.vendorRangeList,cmpVersion=_decodeFromBase.cmpVersion,consentScreen=_decodeFromBase.consentScreen,consentLanguage=_decodeFromBase.consentLanguage;var consentStringData={version:version,cmpId:cmpId,vendorListVersion:vendorListVersion,allowedPurposeIds:decodeBitsToIds(purposeIdBitString),maxVendorId:maxVendorId,created:created,lastUpdated:lastUpdated,cmpVersion:cmpVersion,consentScreen:consentScreen,consentLanguage:consentLanguage};if(isRange){var idMap=vendorRangeList.reduce(function(acc,_ref){var isRange=_ref.isRange,startVendorId=_ref.startVendorId,endVendorId=_ref.endVendorId;var lastVendorId=isRange?endVendorId:startVendorId;for(var i=startVendorId;i<=lastVendorId;i+=1){acc[i]=true}return acc},{});consentStringData.allowedVendorIds=[];for(var i=1;i<=maxVendorId;i+=1){if(defaultConsent&&!idMap[i]||!defaultConsent&&idMap[i]){if(consentStringData.allowedVendorIds.indexOf(i)===-1){consentStringData.allowedVendorIds.push(i)}}}}else{consentStringData.allowedVendorIds=decodeBitsToIds(vendorIdBitString)}return consentStringData}module.exports={decodeConsentString:decodeConsentString}},{"./utils/bits":7}],5:[function(require,module,exports){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _require=require("./utils/bits"),encodeToBase64=_require.encodeToBase64,padRight=_require.padRight;function encodeVendorIdsToBits(maxVendorId){var allowedVendorIds=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var vendorString="";for(var id=1;id<=maxVendorId;id+=1){vendorString+=allowedVendorIds.indexOf(id)!==-1?"1":"0"}return padRight(vendorString,Math.max(0,maxVendorId-vendorString.length))}function encodePurposeIdsToBits(purposes){var allowedPurposeIds=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Set;var maxPurposeId=0;for(var i=0;i<purposes.length;i+=1){maxPurposeId=Math.max(maxPurposeId,purposes[i].id)}for(var _i=0;_i<allowedPurposeIds.length;_i+=1){maxPurposeId=Math.max(maxPurposeId,allowedPurposeIds[_i])}var purposeString="";for(var id=1;id<=maxPurposeId;id+=1){purposeString+=allowedPurposeIds.indexOf(id)!==-1?"1":"0"}return purposeString}function convertVendorsToRanges(vendors,allowedVendorIds){var range=[];var ranges=[];var idsInList=vendors.map(function(vendor){return vendor.id});for(var index=0;index<vendors.length;index+=1){var id=vendors[index].id;if(allowedVendorIds.indexOf(id)!==-1){range.push(id)}if((allowedVendorIds.indexOf(id)===-1||index===vendors.length-1||idsInList.indexOf(id+1)===-1)&&range.length){var startVendorId=range.shift();var endVendorId=range.pop();range=[];ranges.push({isRange:typeof endVendorId==="number",startVendorId:startVendorId,endVendorId:endVendorId})}}return ranges}function getMaxVendorId(vendors){var maxVendorId=0;vendors.forEach(function(vendor){if(vendor.id>maxVendorId){maxVendorId=vendor.id}});return maxVendorId}function encodeConsentString(consentData){var maxVendorId=consentData.maxVendorId;var _consentData$vendorLi=consentData.vendorList,vendorList=_consentData$vendorLi===undefined?{}:_consentData$vendorLi,allowedPurposeIds=consentData.allowedPurposeIds,allowedVendorIds=consentData.allowedVendorIds;var _vendorList$vendors=vendorList.vendors,vendors=_vendorList$vendors===undefined?[]:_vendorList$vendors,_vendorList$purposes=vendorList.purposes,purposes=_vendorList$purposes===undefined?[]:_vendorList$purposes;if(!maxVendorId){maxVendorId=getMaxVendorId(vendors)}var noRangesData=encodeToBase64(_extends({},consentData,{maxVendorId:maxVendorId,purposeIdBitString:encodePurposeIdsToBits(purposes,allowedPurposeIds),isRange:false,vendorIdBitString:encodeVendorIdsToBits(maxVendorId,allowedVendorIds)}));var vendorRangeList=convertVendorsToRanges(vendors,allowedVendorIds);var rangesData=encodeToBase64(_extends({},consentData,{maxVendorId:maxVendorId,purposeIdBitString:encodePurposeIdsToBits(purposes,allowedPurposeIds),isRange:true,defaultConsent:false,numEntries:vendorRangeList.length,vendorRangeList:vendorRangeList}));return noRangesData.length<rangesData.length?noRangesData:rangesData}module.exports={convertVendorsToRanges:convertVendorsToRanges,encodeConsentString:encodeConsentString,getMaxVendorId:getMaxVendorId,encodeVendorIdsToBits:encodeVendorIdsToBits,encodePurposeIdsToBits:encodePurposeIdsToBits}},{"./utils/bits":7}],6:[function(require,module,exports){"use strict";var _require=require("./consent-string"),ConsentString=_require.ConsentString;var _require2=require("./decode"),decodeConsentString=_require2.decodeConsentString;var _require3=require("./encode"),encodeConsentString=_require3.encodeConsentString;module.exports={ConsentString:ConsentString,decodeConsentString:decodeConsentString,encodeConsentString:encodeConsentString}},{"./consent-string":3,"./decode":4,"./encode":5}],7:[function(require,module,exports){"use strict";var base64=require("base-64");var _require=require("./definitions"),versionNumBits=_require.versionNumBits,vendorVersionMap=_require.vendorVersionMap;function repeat(count){var string=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"0";var padString="";for(var i=0;i<count;i+=1){padString+=string}return padString}function padLeft(string,padding){return repeat(Math.max(0,padding))+string}function padRight(string,padding){return string+repeat(Math.max(0,padding))}function encodeIntToBits(number,numBits){var bitString="";if(typeof number==="number"&&!isNaN(number)){bitString=parseInt(number,10).toString(2)}if(numBits>=bitString.length){bitString=padLeft(bitString,numBits-bitString.length)}if(bitString.length>numBits){bitString=bitString.substring(0,numBits)}return bitString}function encodeBoolToBits(value){return encodeIntToBits(value===true?1:0,1)}function encodeDateToBits(date,numBits){if(date instanceof Date){return encodeIntToBits(date.getTime()/100,numBits)}return encodeIntToBits(date,numBits)}function encodeLetterToBits(letter,numBits){return encodeIntToBits(letter.toUpperCase().charCodeAt(0)-65,numBits)}function encodeLanguageToBits(language){var numBits=arguments.length>1&&arguments[1]!==undefined?arguments[1]:12;return encodeLetterToBits(language.slice(0,1),numBits/2)+encodeLetterToBits(language.slice(1),numBits/2)}function decodeBitsToInt(bitString,start,length){return parseInt(bitString.substr(start,length),2)}function decodeBitsToDate(bitString,start,length){return new Date(decodeBitsToInt(bitString,start,length)*100)}function decodeBitsToBool(bitString,start){return parseInt(bitString.substr(start,1),2)===1}function decodeBitsToLetter(bitString){var letterCode=decodeBitsToInt(bitString);return String.fromCharCode(letterCode+65).toLowerCase()}function decodeBitsToLanguage(bitString,start,length){var languageBitString=bitString.substr(start,length);return decodeBitsToLetter(languageBitString.slice(0,length/2))+decodeBitsToLetter(languageBitString.slice(length/2))}function encodeField(_ref){var input=_ref.input,field=_ref.field;var name=field.name,type=field.type,numBits=field.numBits,encoder=field.encoder,validator=field.validator;if(typeof validator==="function"){if(!validator(input)){return""}}if(typeof encoder==="function"){return encoder(input)}var bitCount=typeof numBits==="function"?numBits(input):numBits;var inputValue=input[name];var fieldValue=inputValue===null||inputValue===undefined?"":inputValue;switch(type){case"int":return encodeIntToBits(fieldValue,bitCount);case"bool":return encodeBoolToBits(fieldValue);case"date":return encodeDateToBits(fieldValue,bitCount);case"bits":return padRight(fieldValue,bitCount-fieldValue.length).substring(0,bitCount);case"list":return fieldValue.reduce(function(acc,listValue){return acc+encodeFields({input:listValue,fields:field.fields})},"");case"language":return encodeLanguageToBits(fieldValue,bitCount);default:throw new Error("ConsentString - Unknown field type "+type+" for encoding")}}function encodeFields(_ref2){var input=_ref2.input,fields=_ref2.fields;return fields.reduce(function(acc,field){acc+=encodeField({input:input,field:field});return acc},"")}function decodeField(_ref3){var input=_ref3.input,output=_ref3.output,startPosition=_ref3.startPosition,field=_ref3.field;var type=field.type,numBits=field.numBits,decoder=field.decoder,validator=field.validator,listCount=field.listCount;if(typeof validator==="function"){if(!validator(output)){return{newPosition:startPosition}}}if(typeof decoder==="function"){return decoder(input,output,startPosition)}var bitCount=typeof numBits==="function"?numBits(output):numBits;switch(type){case"int":return{fieldValue:decodeBitsToInt(input,startPosition,bitCount)};case"bool":return{fieldValue:decodeBitsToBool(input,startPosition)};case"date":return{fieldValue:decodeBitsToDate(input,startPosition,bitCount)};case"bits":return{fieldValue:input.substr(startPosition,bitCount)};case"list":return decodeList(input,output,startPosition,field,listCount);case"language":return{fieldValue:decodeBitsToLanguage(input,startPosition,bitCount)};default:throw new Error("ConsentString - Unknown field type "+type+" for decoding")}}function decodeList(input,output,startPosition,field,listCount){var listEntryCount=0;if(typeof listCount==="function"){listEntryCount=listCount(output)}else if(typeof listCount==="number"){listEntryCount=listCount}var newPosition=startPosition;var fieldValue=[];for(var i=0;i<listEntryCount;i+=1){var decodedFields=decodeFields({input:input,fields:field.fields,startPosition:newPosition});newPosition=decodedFields.newPosition;fieldValue.push(decodedFields.decodedObject)}return{fieldValue:fieldValue,newPosition:newPosition}}function decodeFields(_ref4){var input=_ref4.input,fields=_ref4.fields,_ref4$startPosition=_ref4.startPosition,startPosition=_ref4$startPosition===undefined?0:_ref4$startPosition;var position=startPosition;var decodedObject=fields.reduce(function(acc,field){var name=field.name,numBits=field.numBits;var _decodeField=decodeField({input:input,output:acc,startPosition:position,field:field}),fieldValue=_decodeField.fieldValue,newPosition=_decodeField.newPosition;if(fieldValue!==undefined){acc[name]=fieldValue}if(newPosition!==undefined){position=newPosition}else if(typeof numBits==="number"){position+=numBits}return acc},{});return{decodedObject:decodedObject,newPosition:position}}function encodeDataToBits(data,definitionMap){var version=data.version;if(typeof version!=="number"){throw new Error("ConsentString - No version field to encode")}else if(!definitionMap[version]){throw new Error("ConsentString - No definition for version "+version)}else{var fields=definitionMap[version].fields;return encodeFields({input:data,fields:fields})}}function encodeToBase64(data){var definitionMap=arguments.length>1&&arguments[1]!==undefined?arguments[1]:vendorVersionMap;var binaryValue=encodeDataToBits(data,definitionMap);if(binaryValue){var paddedBinaryValue=padRight(binaryValue,7-(binaryValue.length+7)%8);var bytes="";for(var i=0;i<paddedBinaryValue.length;i+=8){bytes+=String.fromCharCode(parseInt(paddedBinaryValue.substr(i,8),2))}return base64.encode(bytes).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}return null}function decodeConsentStringBitValue(bitString){var definitionMap=arguments.length>1&&arguments[1]!==undefined?arguments[1]:vendorVersionMap;var version=decodeBitsToInt(bitString,0,versionNumBits);if(typeof version!=="number"){throw new Error("ConsentString - Unknown version number in the string to decode")}else if(!vendorVersionMap[version]){throw new Error("ConsentString - Unsupported version "+version+" in the string to decode")}var fields=definitionMap[version].fields;var _decodeFields=decodeFields({input:bitString,fields:fields}),decodedObject=_decodeFields.decodedObject;return decodedObject}function decodeFromBase64(consentString,definitionMap){var unsafe=consentString;while(unsafe.length%4!==0){unsafe+="="}unsafe=unsafe.replace(/-/g,"+").replace(/_/g,"/");var bytes=base64.decode(unsafe);var inputBits="";for(var i=0;i<bytes.length;i+=1){var bitString=bytes.charCodeAt(i).toString(2);inputBits+=padLeft(bitString,8-bitString.length)}return decodeConsentStringBitValue(inputBits,definitionMap)}function decodeBitsToIds(bitString){return bitString.split("").reduce(function(acc,bit,index){if(bit==="1"){if(acc.indexOf(index+1)===-1){acc.push(index+1)}}return acc},[])}module.exports={padRight:padRight,padLeft:padLeft,encodeField:encodeField,encodeDataToBits:encodeDataToBits,encodeIntToBits:encodeIntToBits,encodeBoolToBits:encodeBoolToBits,encodeDateToBits:encodeDateToBits,encodeLanguageToBits:encodeLanguageToBits,encodeLetterToBits:encodeLetterToBits,encodeToBase64:encodeToBase64,decodeBitsToIds:decodeBitsToIds,decodeBitsToInt:decodeBitsToInt,decodeBitsToDate:decodeBitsToDate,decodeBitsToBool:decodeBitsToBool,decodeBitsToLanguage:decodeBitsToLanguage,decodeBitsToLetter:decodeBitsToLetter,decodeFromBase64:decodeFromBase64}},{"./definitions":8,"base-64":2}],8:[function(require,module,exports){"use strict";var versionNumBits=6;var vendorVersionMap={1:{version:1,metadataFields:["version","created","lastUpdated","cmpId","cmpVersion","consentScreen","vendorListVersion"],fields:[{name:"version",type:"int",numBits:6},{name:"created",type:"date",numBits:36},{name:"lastUpdated",type:"date",numBits:36},{name:"cmpId",type:"int",numBits:12},{name:"cmpVersion",type:"int",numBits:12},{name:"consentScreen",type:"int",numBits:6},{name:"consentLanguage",type:"language",numBits:12},{name:"vendorListVersion",type:"int",numBits:12},{name:"purposeIdBitString",type:"bits",numBits:24},{name:"maxVendorId",type:"int",numBits:16},{name:"isRange",type:"bool",numBits:1},{name:"vendorIdBitString",type:"bits",numBits:function numBits(decodedObject){return decodedObject.maxVendorId},validator:function validator(decodedObject){return!decodedObject.isRange}},{name:"defaultConsent",type:"bool",numBits:1,validator:function validator(decodedObject){return decodedObject.isRange}},{name:"numEntries",numBits:12,type:"int",validator:function validator(decodedObject){return decodedObject.isRange}},{name:"vendorRangeList",type:"list",listCount:function listCount(decodedObject){return decodedObject.numEntries},validator:function validator(decodedObject){return decodedObject.isRange},fields:[{name:"isRange",type:"bool",numBits:1},{name:"startVendorId",type:"int",numBits:16},{name:"endVendorId",type:"int",numBits:16,validator:function validator(decodedObject){return decodedObject.isRange}}]}]}};module.exports={versionNumBits:versionNumBits,vendorVersionMap:vendorVersionMap}},{}]},{},[1]);